OBJECT Table 36 Sales Header
{
  OBJECT-PROPERTIES
  {
    Date=07/20/18;
    Time=[ 4:10:24 AM];
    Modified=Yes;
    Version List=NAVW19.00,NAVNA9.00.00.43897;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Sell-to Customer Name;
    OnInsert=BEGIN
               InitInsert; // 
               InsertMode := TRUE;

               IF GetFilterCustNo <> '' THEN
                 VALIDATE("Sell-to Customer No.",GetFilterCustNo);

               IF GetFilterContNo <> '' THEN
                 VALIDATE("Sell-to Contact No.",GetFilterContNo);

               "Doc. No. Occurrence" := ArchiveManagement.GetNextOccurrenceNo(DATABASE::"Sales Header","Document Type","No.");

               // 
               "Order Time" := TIME; // DW 6/13
               "Original Order No." := "No.";  //PS01
               SetSlsHdrExt(SlsHdrExt); // DW 12/11
               //T388-begin
               IF ("Requested Delivery Date" = 0D) AND ("Sell-to Customer No." <> '') THEN BEGIN
                 SalesSetup.GET;
                 IF SalesSetup."Use Auto-Best Location" THEN BEGIN
                   ECRFulfillment.SetHeaderRSD(Rec);
                 END;
               END;
               //T388-end
               // 

               // HM
               HistoryFunction(0,'INSERT');
               // HM
             END;

    OnModify=BEGIN
               // HM
               HistoryFunction(0,'MODIFY');
               // HM
             END;

    OnDelete=VAR
               Opp@1000 : Record 5092;
               TempOpportunityEntry@1001 : TEMPORARY Record 5093;
               DOPaymentTransLogEntry@1002 : Record 829;
               ECRAvailability@1000000000 : Codeunit 50054;
             BEGIN
               IF DOPaymentTransLogEntry.FINDFIRST THEN
                 DOPaymentTransLogMgt.ValidateCanDeleteDocument("Payment Method Code","Document Type",FORMAT("Document Type"),"No.");

               IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                 ERROR(
                   Text022,
                   RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);

               IF ("Opportunity No." <> '') AND
                  ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order])
               THEN
                 IF Opp.GET("Opportunity No.") THEN BEGIN
                   IF "Document Type" = "Document Type"::Order THEN BEGIN
                     IF NOT CONFIRM(Text040,TRUE) THEN
                       ERROR(Text044);
                     TempOpportunityEntry.INIT;
                     TempOpportunityEntry.VALIDATE("Opportunity No.",Opp."No.");
                     TempOpportunityEntry."Sales Cycle Code" := Opp."Sales Cycle Code";
                     TempOpportunityEntry."Contact No." := Opp."Contact No.";
                     TempOpportunityEntry."Contact Company No." := Opp."Contact Company No.";
                     TempOpportunityEntry."Salesperson Code" := Opp."Salesperson Code";
                     TempOpportunityEntry."Campaign No." := Opp."Campaign No.";
                     TempOpportunityEntry."Action Taken" := TempOpportunityEntry."Action Taken"::Lost;
                     TempOpportunityEntry.INSERT;
                     TempOpportunityEntry.SETRANGE("Action Taken",TempOpportunityEntry."Action Taken"::Lost);
                     PAGE.RUNMODAL(PAGE::"Close Opportunity",TempOpportunityEntry);
                     IF Opp.GET("Opportunity No.") THEN
                       IF Opp.Status <> Opp.Status::Lost THEN
                         ERROR(Text043);
                   END;
                   Opp."Sales Document Type" := Opp."Sales Document Type"::" ";
                   Opp."Sales Document No." := '';
                   Opp.MODIFY;
                   "Opportunity No." := '';
                 END;

               SalesPost.DeleteHeader(
                 Rec,SalesShptHeader,SalesInvHeader,SalesCrMemoHeader,ReturnRcptHeader,SalesInvHeaderPrepmt,SalesCrMemoHeaderPrepmt);
               VALIDATE("Applies-to ID",'');
               VALIDATE("Incoming Document Entry No.",0);

               ArchiveManagement.StoreSalesDocument(Rec,FALSE); // DW 3/14

               // >> Shipping
               IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice] THEN BEGIN
                 Package.RESET;
                 Package.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                 Package.SETRANGE("Source Type",DATABASE::"Sales Header");
                 Package.SETRANGE("Source Subtype","Document Type");
                 Package.SETRANGE("Source ID","No.");
                 Package.DELETEALL(TRUE);
               END;

               IF "Document Type" IN ["Document Type"::"Credit Memo","Document Type"::"Return Order"] THEN BEGIN
                 ReceiveHeader.RESET;
                 ReceiveHeader.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                 ReceiveHeader.SETRANGE("Source Type",DATABASE::"Sales Header");
                 ReceiveHeader.SETRANGE("Source Subtype","Document Type");
                 ReceiveHeader.SETRANGE("Source ID","No.");
                 ReceiveHeader.DELETEALL(TRUE);
               END;

               DeleteShippingAgentOptionPage;
               // << Shipping

               // >> EDI
               DeleteEDIDiscounts;
               // << EDI

               ApprovalsMgmt.DeleteApprovalEntry(DATABASE::"Sales Header","Document Type","No.");
               SalesLine.RESET;
               SalesLine.LOCKTABLE;

               WhseRequest.SETRANGE("Source Type",DATABASE::"Sales Line");
               WhseRequest.SETRANGE("Source Subtype","Document Type");
               WhseRequest.SETRANGE("Source No.","No.");
               WhseRequest.DELETEALL(TRUE);

               SalesLine.SETRANGE("Document Type","Document Type");
               SalesLine.SETRANGE("Document No.","No.");
               SalesLine.SETRANGE(Type,SalesLine.Type::"Charge (Item)");

               DeleteSalesLines;
               SalesLine.SETRANGE(Type);
               DeleteSalesLines;

               SalesCommentLine.SETRANGE("Document Type","Document Type");
               SalesCommentLine.SETRANGE("No.","No.");
               SalesCommentLine.DELETEALL;

               IF "Tax Area Code" <> '' THEN BEGIN
                 SalesTaxDifference.RESET;
                 SalesTaxDifference.SETRANGE("Document Product Area",SalesTaxDifference."Document Product Area"::Sales);
                 SalesTaxDifference.SETRANGE("Document Type","Document Type");
                 SalesTaxDifference.SETRANGE("Document No.","No.");
                 SalesTaxDifference.DELETEALL;
               END;

               IF SlsHdrExt.GET("Document Type","No.") THEN
                 IF NOT SlsHdrExt.Posted THEN
                   SlsHdrExt.DELETE; // DW 12/11

               IF (SalesShptHeader."No." <> '') OR
                  (SalesInvHeader."No." <> '') OR
                  (SalesCrMemoHeader."No." <> '') OR
                  (ReturnRcptHeader."No." <> '') OR
                  (SalesInvHeaderPrepmt."No." <> '') OR
                  (SalesCrMemoHeaderPrepmt."No." <> '')
               THEN BEGIN
                 COMMIT;

                 IF SalesShptHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text000,TRUE,
                        SalesShptHeader."No.")
                   THEN BEGIN
                     SalesShptHeader.SETRECFILTER;
                     SalesShptHeader.PrintRecords(TRUE);
                   END;

                 IF SalesInvHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text001,TRUE,
                        SalesInvHeader."No.")
                   THEN BEGIN
                     SalesInvHeader.SETRECFILTER;
                     SalesInvHeader.PrintRecords(TRUE);
                   END;

                 IF SalesCrMemoHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text002,TRUE,
                        SalesCrMemoHeader."No.")
                   THEN BEGIN
                     SalesCrMemoHeader.SETRECFILTER;
                     SalesCrMemoHeader.PrintRecords(TRUE);
                   END;

                 IF ReturnRcptHeader."No." <> '' THEN
                   IF CONFIRM(
                        Text023,TRUE,
                        ReturnRcptHeader."No.")
                   THEN BEGIN
                     ReturnRcptHeader.SETRECFILTER;
                     ReturnRcptHeader.PrintRecords(TRUE);
                   END;

                 IF SalesInvHeaderPrepmt."No." <> '' THEN
                   IF CONFIRM(
                        Text055,TRUE,
                        SalesInvHeader."No.")
                   THEN BEGIN
                     SalesInvHeaderPrepmt.SETRECFILTER;
                     SalesInvHeaderPrepmt.PrintRecords(TRUE);
                   END;

                 IF SalesCrMemoHeaderPrepmt."No." <> '' THEN
                   IF CONFIRM(
                        Text054,TRUE,
                        SalesCrMemoHeaderPrepmt."No.")
                   THEN BEGIN
                     SalesCrMemoHeaderPrepmt.SETRECFILTER;
                     SalesCrMemoHeaderPrepmt.PrintRecords(TRUE);
                   END;
               END;

               HistoryFunction(0,'DELETE');
               // HM
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);

               HistoryFunction(0,'RENAME');
               // HM
             END;

    CaptionML=[ENU=Sales Header;
               ESM=Cab. venta;
               FRC=En-tˆte de ventes;
               ENC=Sales Header];
    LookupPageID=Page45;
    DrillDownPageID=Page45;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              ESM=Tipo documento;
                                                              FRC=Type de document;
                                                              ENC=Document Type];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order;
                                                                    ESM=Cotizaci¢n,Pedido,Factura,Nota cr‚dito,Pedido abierto,Devoluci¢n;
                                                                    FRC=Devis,Commande,Facture,Note de cr‚dit,Commande permanente,Retour;
                                                                    ENC=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order }
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                CheckCreditLimitIfLineNotInsertedYet;
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Sell-to Customer No." <> xRec."Sell-to Customer No.") AND
                                                                   (xRec."Sell-to Customer No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Opportunity No." <> '') AND ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) THEN
                                                                    ERROR(
                                                                      Text062,
                                                                      FIELDCAPTION("Sell-to Customer No."),
                                                                      FIELDCAPTION("Opportunity No."),
                                                                      "Opportunity No.",
                                                                      "Document Type");
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Sell-to Customer No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Sell-to Customer No." = '' THEN BEGIN
                                                                      IF SalesLine.FINDFIRST THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Sell-to Customer No."));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      SalesLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                                                                        SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
                                                                        SalesLine.SETFILTER("Shipment No.",'<>%1','');
                                                                      END;

                                                                    IF SalesLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        SalesLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        SalesLine.TESTFIELD("Shipment No.",'');
                                                                    SalesLine.SETRANGE("Shipment No.");
                                                                    SalesLine.SETRANGE("Quantity Shipped");

                                                                    IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                      SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                      IF SalesLine.FIND('-') THEN
                                                                        SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      SalesLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                    END;

                                                                    IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                      SalesLine.SETFILTER("Return Qty. Received",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                        SalesLine.SETRANGE("Sell-to Customer No.",xRec."Sell-to Customer No.");
                                                                        SalesLine.SETFILTER("Return Receipt No.",'<>%1','');
                                                                      END;

                                                                    IF SalesLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        SalesLine.TESTFIELD("Return Qty. Received",0)
                                                                      ELSE
                                                                        SalesLine.TESTFIELD("Return Receipt No.",'');
                                                                    SalesLine.RESET
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Sell-to Customer No." <> "Sell-to Customer No.")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));
                                                                  SalesLine.RESET;
                                                                END;

                                                                GetCust("Sell-to Customer No.");

                                                                // Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE); // DW0418 Allow entry
                                                                GLSetup.GET;
                                                                IF GLSetup."VAT in Use" THEN
                                                                  Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                "Sell-to Customer Template Code" := '';
                                                                "Sell-to Customer Name" := Cust.Name;
                                                                "Sell-to Customer Name 2" := Cust."Name 2";
                                                                "Sell-to Address" := Cust.Address;
                                                                "Sell-to Address 2" := Cust."Address 2";
                                                                "Sell-to City" := Cust.City;
                                                                "Sell-to Post Code" := Cust."Post Code";
                                                                "Sell-to County" := Cust.County;
                                                                "Sell-to Country/Region Code" := Cust."Country/Region Code";
                                                                IF NOT SkipSellToContact THEN
                                                                  "Sell-to Contact" := Cust.Contact;
                                                                "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                "Tax Area Code" := Cust."Tax Area Code";
                                                                "Tax Liable" := Cust."Tax Liable";
                                                                "Tax Exemption No." := Cust."Tax Exemption No.";
                                                                "VAT Registration No." := Cust."VAT Registration No.";
                                                                "VAT Country/Region Code" := Cust."Country/Region Code";
                                                                "Shipping Advice" := Cust."Shipping Advice";
                                                                "Responsibility Center" := UserSetupMgt.GetRespCenter(0,Cust."Responsibility Center");
                                                                "Days to Ship" := Cust."Days to Ship"; // DW0518 MUST PRECEDE Location assignment
                                                                VALIDATE("Location Code",UserSetupMgt.GetLocation(0,Cust."Location Code","Responsibility Center"));

                                                                // DW
                                                                "Shipping Payment Type" := Cust."Shipping Payment Type";
                                                                "Allocation Level" := Cust."Allocation Level";
                                                                // DW
                                                                "Responsibility Center" := UserSetupMgt.GetRespCenter(0,Cust."Responsibility Center");
                                                                VALIDATE("Location Code",UserSetupMgt.GetLocation(0,Cust."Location Code","Responsibility Center"));

                                                                IF "Sell-to Customer No." = xRec."Sell-to Customer No." THEN
                                                                  IF ShippedSalesLinesExist OR ReturnReceiptExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                "Sell-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Sell-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);

                                                                //>> Shipping
                                                                "External Sell-to No." := Cust."External No.";
                                                                //<< Shipping

                                                                IF Cust."Bill-to Customer No." <> '' THEN
                                                                  VALIDATE("Bill-to Customer No.",Cust."Bill-to Customer No.")
                                                                ELSE BEGIN
                                                                  IF "Bill-to Customer No." = "Sell-to Customer No." THEN
                                                                    SkipBillToContact := TRUE;
                                                                  VALIDATE("Bill-to Customer No.","Sell-to Customer No.");
                                                                  SkipBillToContact := FALSE;
                                                                END;
                                                                VALIDATE("Ship-to Code",'');

                                                                GetShippingTime(FIELDNO("Sell-to Customer No."));

                                                                // >> EDI
                                                                CASE Cust."EDI Invoice" OF
                                                                  Cust."EDI Invoice"::Always:
                                                                    BEGIN
                                                                      "EDI Order" := TRUE;
                                                                      "EDI Invoice" := TRUE;
                                                                    END;
                                                                  Cust."EDI Invoice"::Never:
                                                                    "EDI Order" := FALSE;
                                                                END;
                                                                // << EDI

                                                                // >> Shipping
                                                                GetCust("Sell-to Customer No.");
                                                                IF Cust."Default Ship-for Code" <> '' THEN
                                                                  VALIDATE("Ship-for Code",Cust."Default Ship-for Code");
                                                                // << Shipping

                                                                IF (xRec."Sell-to Customer No." <> "Sell-to Customer No.") OR
                                                                   (xRec."Currency Code" <> "Currency Code") OR
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group") OR
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group")
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Sell-to Customer No."));

                                                                //T388-begin
                                                                IF ("Requested Delivery Date" = 0D) AND ("Sell-to Customer No." <> '') THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  IF SalesSetup."Use Auto-Best Location" THEN BEGIN
                                                                    ECRFulfillment.SetHeaderRSD(Rec);
                                                                  END;
                                                                END;
                                                                //T388-end

                                                                IF NOT SkipSellToContact THEN
                                                                  UpdateSellToCont("Sell-to Customer No.");
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              ESM=Venta a-N§ cliente;
                                                              FRC=Nø client (d‚biteur);
                                                              ENC=Sell-to Customer No.] }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              ESM=N§;
                                                              FRC=Nø;
                                                              ENC=No.] }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                BilltoCustomerNoChanged := xRec."Bill-to Customer No." <> "Bill-to Customer No.";
                                                                IF BilltoCustomerNoChanged THEN
                                                                  IF xRec."Bill-to Customer No." = '' THEN
                                                                    InitRecord
                                                                  ELSE BEGIN
                                                                    VALIDATE("Credit Card No.",'');
                                                                    IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                      Confirmed := TRUE
                                                                    ELSE
                                                                      Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Bill-to Customer No."));
                                                                    IF Confirmed THEN BEGIN
                                                                      SalesLine.SETRANGE("Document Type","Document Type");
                                                                      SalesLine.SETRANGE("Document No.","No.");
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        SalesLine.SETFILTER("Quantity Shipped",'<>0')
                                                                      ELSE
                                                                        IF "Document Type" = "Document Type"::Invoice THEN
                                                                          SalesLine.SETFILTER("Shipment No.",'<>%1','');

                                                                      IF SalesLine.FINDFIRST THEN
                                                                        IF "Document Type" = "Document Type"::Order THEN
                                                                          SalesLine.TESTFIELD("Quantity Shipped",0)
                                                                        ELSE
                                                                          SalesLine.TESTFIELD("Shipment No.",'');
                                                                      SalesLine.SETRANGE("Shipment No.");
                                                                      SalesLine.SETRANGE("Quantity Shipped");

                                                                      IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                        SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                        IF SalesLine.FIND('-') THEN
                                                                          SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                        SalesLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                      END;

                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        SalesLine.SETFILTER("Return Qty. Received",'<>0')
                                                                      ELSE
                                                                        IF "Document Type" = "Document Type"::"Credit Memo" THEN
                                                                          SalesLine.SETFILTER("Return Receipt No.",'<>%1','');

                                                                      IF SalesLine.FINDFIRST THEN
                                                                        IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                          SalesLine.TESTFIELD("Return Qty. Received",0)
                                                                        ELSE
                                                                          SalesLine.TESTFIELD("Return Receipt No.",'');
                                                                      SalesLine.RESET
                                                                    END ELSE
                                                                      "Bill-to Customer No." := xRec."Bill-to Customer No.";
                                                                  END;

                                                                GetCust("Bill-to Customer No.");
                                                                // Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE); // DW0418 Allow entry
                                                                Cust.TESTFIELD("Customer Posting Group");
                                                                CheckCrLimit;
                                                                "Bill-to Customer Template Code" := '';
                                                                "Bill-to Name" := Cust.Name;
                                                                "Bill-to Name 2" := Cust."Name 2";
                                                                "Bill-to Address" := Cust.Address;
                                                                "Bill-to Address 2" := Cust."Address 2";
                                                                "Bill-to City" := Cust.City;
                                                                "Bill-to Post Code" := Cust."Post Code";
                                                                "Bill-to County" := Cust.County;
                                                                "Bill-to Country/Region Code" := Cust."Country/Region Code";

                                                                "Delete CC After Invoice" := Cust."Do Not Save Credit Card Nos."; // DWEFT 11/14

                                                                IF NOT SkipBillToContact THEN
                                                                  "Bill-to Contact" := Cust.Contact;
                                                                "Payment Terms Code" := Cust."Payment Terms Code";
                                                                "Prepmt. Payment Terms Code" := Cust."Payment Terms Code";

                                                                IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                  "Payment Method Code" := '';
                                                                  IF PaymentTerms.GET("Payment Terms Code") THEN
                                                                    IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
                                                                      "Payment Method Code" := Cust."Payment Method Code"
                                                                END ELSE
                                                                  "Payment Method Code" := Cust."Payment Method Code";

                                                                GLSetup.GET;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
                                                                  "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                  "VAT Country/Region Code" := Cust."Country/Region Code";
                                                                  "VAT Registration No." := Cust."VAT Registration No.";
                                                                  "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                END;
                                                                "Customer Posting Group" := Cust."Customer Posting Group";
                                                                "Currency Code" := Cust."Currency Code";
                                                                "Customer Price Group" := Cust."Customer Price Group";
                                                                "Prices Including VAT" := Cust."Prices Including VAT";
                                                                "Allow Line Disc." := Cust."Allow Line Disc.";
                                                                "Invoice Disc. Code" := Cust."Invoice Disc. Code";
                                                                "Customer Disc. Group" := Cust."Customer Disc. Group";
                                                                "Language Code" := Cust."Language Code";
                                                                "Salesperson Code" := Cust."Salesperson Code";
                                                                "Combine Shipments" := Cust."Combine Shipments";
                                                                Reserve := Cust.Reserve;
                                                                IF "Document Type" = "Document Type"::Order THEN
                                                                  "Prepayment %" := Cust."Prepayment %";

                                                                IF NOT BilltoCustomerNoChanged THEN BEGIN
                                                                  IF ShippedSalesLinesExist THEN BEGIN
                                                                    TESTFIELD("Customer Disc. Group",xRec."Customer Disc. Group");
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                  END;
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Prepayment %");

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   BilltoCustomerNoChanged
                                                                THEN BEGIN
                                                                  RecreateSalesLines(FIELDCAPTION("Bill-to Customer No."));
                                                                  BilltoCustomerNoChanged := FALSE;
                                                                END;
                                                                IF NOT SkipBillToContact THEN
                                                                  UpdateBillToCont("Bill-to Customer No.");

                                                                "Bill-to IC Partner Code" := Cust."IC Partner Code";
                                                                "Send IC Document" := ("Bill-to IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              ESM=Factura-a N§ cliente;
                                                              FRC=N§ client factur‚;
                                                              ENC=Bill-to Customer No.];
                                                   NotBlank=Yes }
    { 5   ;   ;Bill-to Name        ;Text50        ;CaptionML=[ENU=Name;
                                                              ESM=Fact. a-Nombre;
                                                              FRC=Nom client factur‚;
                                                              ENC=Name] }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;CaptionML=[ENU=Name 2;
                                                              ESM=Fact. a-Nombre 2;
                                                              FRC=Nom client factur‚ 2;
                                                              ENC=Name 2] }
    { 7   ;   ;Bill-to Address     ;Text50        ;CaptionML=[ENU=Address;
                                                              ESM=Fact. a-Direcci¢n;
                                                              FRC=Adresse facturation;
                                                              ENC=Address] }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;CaptionML=[ENU=Address 2;
                                                              ESM=Fact. a-Colonia;
                                                              FRC=Adresse de facturation 2;
                                                              ENC=Address 2] }
    { 9   ;   ;Bill-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              ESM=Fact. a-Municipio/Ciudad;
                                                              FRC=Ville facturation;
                                                              ENC=City] }
    { 10  ;   ;Bill-to Contact     ;Text50        ;CaptionML=[ENU=Contact;
                                                              ESM=Fact. a-Atenci¢n;
                                                              FRC=Contact facturation;
                                                              ENC=Contact] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              ESM=Su/Ntra. ref.;
                                                              FRC=Votre r‚f‚rence;
                                                              ENC=Your Reference] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=VAR
                                                                SellToCustTemplate@1000 : Record 5105;
                                                              BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Purch. Order Line No.",'<>0');
                                                                  IF NOT SalesLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Ship-to Code"));
                                                                  SalesLine.RESET;
                                                                END;

                                                                IF ("Document Type" <> "Document Type"::"Return Order") AND
                                                                   ("Document Type" <> "Document Type"::"Credit Memo")
                                                                THEN
                                                                  IF "Ship-to Code" <> '' THEN BEGIN
                                                                    IF xRec."Ship-to Code" <> '' THEN
                                                                      BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",Cust."Location Code");
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                    END;
                                                                    ShipToAddr.GET("Sell-to Customer No.","Ship-to Code");
                                                                    "Ship-to Name" := ShipToAddr.Name;
                                                                    "Ship-to Name 2" := ShipToAddr."Name 2";
                                                                    "Ship-to Address" := ShipToAddr.Address;
                                                                    "Ship-to Address 2" := ShipToAddr."Address 2";
                                                                    "Ship-to City" := ShipToAddr.City;
                                                                    "Ship-to Post Code" := ShipToAddr."Post Code";
                                                                    "Ship-to County" := ShipToAddr.County;

                                                                    VALIDATE("Ship-to Country/Region Code",ShipToAddr."Country/Region Code");
                                                                    "Ship-to Contact" := ShipToAddr.Contact;
                                                                    "Shipment Method Code" := ShipToAddr."Shipment Method Code";
                                                                    IF ShipToAddr."Location Code" <> '' THEN
                                                                      VALIDATE("Location Code",ShipToAddr."Location Code");

                                                                  // >> Shipping
                                                                  // "Shipping Agent Code" := ShipToAddr."Shipping Agent Code";
                                                                  IF ShipToAddr."Shipping Agent Code" <> '' THEN BEGIN
                                                                    VALIDATE("Shipping Agent Code",ShipToAddr."Shipping Agent Code");
                                                                    IF ShipToAddr."E-Ship Agent Service" <> '' THEN
                                                                      VALIDATE("E-Ship Agent Service",ShipToAddr."E-Ship Agent Service");
                                                                  END;
                                                                  "Shipping Payment Type" := ShipToAddr."Shipping Payment Type";
                                                                  "Shipping Insurance" := ShipToAddr."Shipping Insurance";
                                                                  IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                    VALIDATE("Third Party Ship. Account No.",'')
                                                                  ELSE
                                                                    IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                         "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                         "Sell-to Customer No.","Ship-to Code")
                                                                    THEN
                                                                      VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.");
                                                                  IF NOT "Free Freight" THEN BEGIN
                                                                    "Free Freight" := ShipToAddr."Free Freight";
                                                                    "No Free Freight Lines on Order" := ShipToAddr."No Free Freight Lines on Order";
                                                                  END;
                                                                  "Residential Delivery" := ShipToAddr."Residential Delivery";
                                                                  "Blind Shipment" := ShipToAddr."Blind Shipment";
                                                                  "Double Blind Shipment" := ShipToAddr."Double Blind Shipment";
                                                                  VALIDATE("Double Blind Ship-from Cust No",ShipToAddr."Double Blind Ship-from Cust No");
                                                                  "External Ship-to No." := ShipToAddr."External No.";
                                                                  // << Shipping

                                                                    "Shipping Agent Service Code" := ShipToAddr."Shipping Agent Service Code";
                                                                    IF ShipToAddr."Tax Area Code" <> '' THEN
                                                                      "Tax Area Code" := ShipToAddr."Tax Area Code";
                                                                    "Tax Liable" := ShipToAddr."Tax Liable";
                                                                  END ELSE
                                                                    IF "Sell-to Customer No." <> '' THEN BEGIN
                                                                      GetCust("Sell-to Customer No.");
                                                                      // DW002
                                                                      SalesSetup.GET;
                                                                      IF (NOT Cust."Leave Ship Address Blank") AND
                                                                         ("Ship-to Address" = '') THEN BEGIN
                                                                      // DW002
                                                                        "Ship-to Name" := Cust.Name;
                                                                        "Ship-to Name 2" := Cust."Name 2";
                                                                        "Ship-to Address" := Cust.Address;
                                                                        "Ship-to Address 2" := Cust."Address 2";
                                                                        "Ship-to City" := Cust.City;
                                                                        "Ship-to Post Code" := Cust."Post Code";
                                                                        "Ship-to County" := Cust.County;
                                                                        VALIDATE("Ship-to Country/Region Code",Cust."Country/Region Code");
                                                                        "Ship-to Contact" := Cust.Contact;
                                                                      END; // DW002
                                                                      "Shipment Method Code" := Cust."Shipment Method Code";
                                                                      IF NOT SellToCustTemplate.GET("Sell-to Customer Template Code") THEN BEGIN
                                                                        "Tax Area Code" := Cust."Tax Area Code";
                                                                        "Tax Liable" := Cust."Tax Liable";
                                                                      END;
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        VALIDATE("Location Code",Cust."Location Code");

                                                                    // >> Shipping
                                                                    // "Shipping Agent Code" := Cust."Shipping Agent Code";
                                                                    "Residential Delivery" := Cust."Residential Delivery";
                                                                    IF Cust."Shipping Agent Code" <> '' THEN BEGIN
                                                                      VALIDATE("Shipping Agent Code",Cust."Shipping Agent Code");
                                                                      IF Cust."E-Ship Agent Service" <> '' THEN
                                                                        VALIDATE("E-Ship Agent Service",Cust."E-Ship Agent Service");
                                                                    END;
                                                                    "Shipping Payment Type" := Cust."Shipping Payment Type";
                                                                    "Shipping Insurance" := Cust."Shipping Insurance";
                                                                    IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                      VALIDATE("Third Party Ship. Account No.",'')
                                                                    ELSE
                                                                      IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                           "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                           "Sell-to Customer No.","Ship-to Code")
                                                                      THEN
                                                                        VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.");
                                                                    IF NOT "Free Freight" THEN BEGIN
                                                                      "Free Freight" := Cust."Free Freight";
                                                                      "No Free Freight Lines on Order" := Cust."No Free Freight Lines on Order";
                                                                    END;
                                                                    // DW 10/14
                                                                    "Residential Delivery" := Cust."Residential Delivery";
                                                                    Liftgate := Cust."Require Liftgate";
                                                                    "Limited Access" := Cust."Limited Access";
                                                                    "Inside Delivery" := Cust."Inside Delivery";
                                                                    "Call Ahead" := Cust."Call Ahead";
                                                                    "Signature Required" := Cust."Signature Required";
                                                                    // DW
                                                                    "Blind Shipment" := Cust."Blind Shipment";
                                                                    "Double Blind Shipment" := Cust."Double Blind Shipment";
                                                                    VALIDATE("Double Blind Ship-from Cust No",Cust."Double Blind Ship-from Cust No");
                                                                    "External Ship-to No." := Cust."External No.";
                                                                    // << Shipping

                                                                      "Shipping Agent Service Code" := Cust."Shipping Agent Service Code";
                                                                    END;

                                                                GetShippingTime(FIELDNO("Ship-to Code"));

                                                                IF (xRec."Sell-to Customer No." = "Sell-to Customer No.") AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN
                                                                  IF (xRec."VAT Country/Region Code" <> "VAT Country/Region Code") OR
                                                                     (xRec."Tax Area Code" <> "Tax Area Code")
                                                                  THEN
                                                                    RecreateSalesLines(FIELDCAPTION("Ship-to Code"))
                                                                  ELSE BEGIN
                                                                    IF xRec."Shipping Agent Code" <> "Shipping Agent Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Code"));
                                                                    IF xRec."Shipping Agent Service Code" <> "Shipping Agent Service Code" THEN
                                                                      MessageIfSalesLinesExist(FIELDCAPTION("Shipping Agent Service Code"));
                                                                    IF xRec."Tax Liable" <> "Tax Liable" THEN
                                                                      VALIDATE("Tax Liable");
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              ESM=C¢d. direcci¢n env¡o cliente;
                                                              FRC=Code de livraison;
                                                              ENC=Ship-to Code] }
    { 13  ;   ;Ship-to Name        ;Text60        ;CaptionML=[ENU=Ship-to Name;
                                                              ESM=Env¡o a-Nombre;
                                                              FRC=Nom du destinataire;
                                                              ENC=Ship-to Name] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              ESM=Env¡o a-Nombre 2;
                                                              FRC=Nom du destinataire 2;
                                                              ENC=Ship-to Name 2] }
    { 15  ;   ;Ship-to Address     ;Text50        ;CaptionML=[ENU=Ship-to Address;
                                                              ESM=Direcci¢n de env¡o;
                                                              FRC=Adresse (destinataire);
                                                              ENC=Ship-to Address] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              ESM=Env¡o a-Colonia 2;
                                                              FRC=Adresse de livraison 2;
                                                              ENC=Ship-to Address 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation="Post Code".City;
                                                   OnValidate=BEGIN
                                                                // 2016
                                                                // PostCode.ValidateCity(
                                                                //  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                CheckFreightQuote;  //B2C02
                                                                // 
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              ESM=Env¡o a-Municipio/Ciudad;
                                                              FRC=Ville (destinataire);
                                                              ENC=Ship-to City] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[ENU=Ship-to Contact;
                                                              ESM=Env¡o a-Atenci¢n;
                                                              FRC=Contact destinataire;
                                                              ENC=Ship-to Contact] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                IF ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND
                                                                   NOT ("Order Date" = xRec."Order Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Order Date"));

                                                                // DW001 Recalculate Shipment Date always
                                                                IF "Document Type" IN ["Document Type"::Quote,"Document Type"::Order] THEN
                                                                  CRIDateFunctions.CalcShipDate(Rec);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Order Date;
                                                              ESM=Fecha pedido;
                                                              FRC=Date commande;
                                                              ENC=Order Date] }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=BEGIN
                                                                TestNoSeriesDate(
                                                                  "Posting No.","Posting No. Series",
                                                                  FIELDCAPTION("Posting No."),FIELDCAPTION("Posting No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepayment No.","Prepayment No. Series",
                                                                  FIELDCAPTION("Prepayment No."),FIELDCAPTION("Prepayment No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepmt. Cr. Memo No.","Prepmt. Cr. Memo No. Series",
                                                                  FIELDCAPTION("Prepmt. Cr. Memo No."),FIELDCAPTION("Prepmt. Cr. Memo No. Series"));

                                                                VALIDATE("Document Date","Posting Date");

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN
                                                                  PriceMessageIfSalesLinesExist(FIELDCAPTION("Posting Date"));

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    ConfirmUpdateCurrencyFactor;
                                                                END;

                                                                IF "Posting Date" <> xRec."Posting Date" THEN
                                                                  IF DeferralHeadersExist THEN
                                                                    ConfirmUpdateDeferralDate;
                                                                SynchronizeAsmHeader;
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              ESM=Fecha registro;
                                                              FRC=Date de report;
                                                              ENC=Posting Date] }
    { 21  ;   ;Shipment Date       ;Date          ;OnValidate=BEGIN
                                                                // DW 10/2010 Modify RT038 to follow standards
                                                                IF HideValidationDialog THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Shipment Date"),FALSE)
                                                                ELSE
                                                                // DW
                                                                UpdateSalesLines(FIELDCAPTION("Shipment Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Expected Ship Date;
                                                              ESM=Fecha env¡o;
                                                              FRC=Date de livraison;
                                                              ENC=Expected Ship Date];
                                                   Description=DW DAC 10/2010 Change Caption to Expected Ship Date }
    { 22  ;   ;Posting Description ;Text50        ;CaptionML=[ENU=Posting Description;
                                                              ESM=Texto de registro;
                                                              FRC=Description du report;
                                                              ENC=Posting Description] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END;
                                                                END;
                                                                IF xRec."Payment Terms Code" = "Prepmt. Payment Terms Code" THEN BEGIN
                                                                  IF xRec."Prepayment Due Date" = 0D THEN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                  VALIDATE("Prepmt. Payment Terms Code","Payment Terms Code");
                                                                END;
                                                                // >> Shipping
                                                                IF PaymentTerms.GET("Payment Terms Code") THEN BEGIN
                                                                  "COD Payment" := PaymentTerms."COD Payment";
                                                                  "COD Cashiers Check" := PaymentTerms."COD Cashiers Check";
                                                                END ELSE BEGIN
                                                                  "COD Payment" := FALSE;
                                                                  "COD Cashiers Check" := FALSE;
                                                                END;

                                                                // << Shipping
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              ESM=C¢d. t‚rminos pago;
                                                              FRC=Code modalit‚s de paiement;
                                                              ENC=Payment Terms Code] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              ESM=Fecha vencimiento;
                                                              FRC=Date d'‚ch‚ance;
                                                              ENC=Due Date] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              ESM=% Dto. P.P.;
                                                              FRC=% escompte de paiement;
                                                              ENC=Payment Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              ESM=Fecha dto. P.P.;
                                                              FRC=Date escompte de paiement;
                                                              ENC=Pmt. Discount Date] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                // DW 9/14
                                                                IF ShipMethod.GET("Shipment Method Code") THEN BEGIN
                                                                  VALIDATE("Shipping Payment Type",ShipMethod."Shipping Payment Type");
                                                                  IF ShipMethod."Free Freight" THEN
                                                                    "Free Freight" := TRUE;
                                                                  IF ShipMethod."No Free Freight Lines" THEN
                                                                    "No Free Freight Lines on Order" := TRUE;
                                                                  //SLW20150128-end

                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Shipment Method Code;
                                                              ESM=C¢d. m‚todo de env¡o;
                                                              FRC=Code m‚thode de livraison;
                                                              ENC=Shipment Method Code] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  MessageIfSalesLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;
                                                                UpdateOutboundWhseHandlingTime;

                                                                // DW 3/14 Recalculate Shipment Date for new orders
                                                                IF xRec."Location Code" = '' THEN
                                                                  IF "Document Type" IN ["Document Type"::Quote,"Document Type"::Order] THEN
                                                                    CRIDateFunctions.CalcShipDate(Rec);
                                                                // DW 7/14 Revalidate 3rd Party Account
                                                                IF "Shipping Payment Type" = "Shipping Payment Type"::"Third Party" THEN
                                                                  VALIDATE("Shipping Payment Type");
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              ESM=C¢d. almac‚n;
                                                              FRC=Code d'emplacement;
                                                              ENC=Location Code] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              ESM=C¢d. dim. acceso dir. 1;
                                                              FRC=Code raccourci de dimension 1;
                                                              ENC=Shortcut Dimension 1 Code];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              ESM=C¢d. dim. acceso dir. 2;
                                                              FRC=Code raccourci de dimension 2;
                                                              ENC=Shortcut Dimension 2 Code];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code10      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              ESM=Grupo contable cliente;
                                                              FRC=ParamŠtre report client;
                                                              ENC=Customer Posting Group];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=VAR
                                                                DOPaymentTransLogEntry@1001 : Record 829;
                                                              BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date")]) OR ("Currency Code" <> xRec."Currency Code") THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                IF DOPaymentTransLogEntry.FINDFIRST THEN
                                                                  DOPaymentTransLogMgt.ValidateHasNoValidTransactions("Document Type",FORMAT("Document Type"),"No.");
                                                                IF (CurrFieldNo <> FIELDNO("Currency Code")) AND ("Currency Code" = xRec."Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    UpdateCurrencyFactor;
                                                                    RecreateSalesLines(FIELDCAPTION("Currency Code"));
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              ESM=C¢d. divisa;
                                                              FRC=Code devise;
                                                              ENC=Currency Code] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> 0 THEN
                                                                  TESTFIELD("Currency Code"); // DW 3/11
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Currency Factor"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              ESM=Factor divisa;
                                                              FRC=Facteur devise;
                                                              ENC=Currency Factor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   Description=DW 3/11 editable }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Price Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Price Group;
                                                              ESM=Grupo precio cliente;
                                                              FRC=Groupe de prix du client;
                                                              ENC=Customer Price Group] }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                SalesLine@1000 : Record 37;
                                                                Currency@1001 : Record 4;
                                                                RecalculatePrice@1002 : Boolean;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Job Contract Entry No.",'<>%1',0);
                                                                  IF SalesLine.FIND('-') THEN BEGIN
                                                                    SalesLine.TESTFIELD("Job No.",'');
                                                                    SalesLine.TESTFIELD("Job Contract Entry No.",0);
                                                                  END;

                                                                  SalesLine.RESET;
                                                                  SalesLine.SETRANGE("Document Type","Document Type");
                                                                  SalesLine.SETRANGE("Document No.","No.");
                                                                  SalesLine.SETFILTER("Unit Price",'<>%1',0);
                                                                  SalesLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF SalesLine.FINDFIRST THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      CONFIRM(
                                                                        STRSUBSTNO(
                                                                          Text024,
                                                                          FIELDCAPTION("Prices Including VAT"),SalesLine.FIELDCAPTION("Unit Price")),
                                                                        TRUE);
                                                                    SalesLine.SetSalesHeader(Rec);

                                                                    IF RecalculatePrice AND "Prices Including VAT" THEN
                                                                      SalesLine.MODIFYALL(Amount,0,TRUE);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");
                                                                    SalesLine.LOCKTABLE;
                                                                    LOCKTABLE;
                                                                    SalesLine.FINDSET;
                                                                    REPEAT
                                                                      SalesLine.TESTFIELD("Quantity Invoiced",0);
                                                                      SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        SalesLine."VAT Difference" := 0;
                                                                        SalesLine.UpdateAmounts;
                                                                      END ELSE
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          SalesLine."Unit Price" :=
                                                                            ROUND(
                                                                              SalesLine."Unit Price" * (1 + (SalesLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF SalesLine.Quantity <> 0 THEN BEGIN
                                                                            SalesLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                SalesLine.Quantity * SalesLine."Unit Price" * SalesLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            SalesLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                SalesLine."Inv. Discount Amount" * (1 + (SalesLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          SalesLine."Unit Price" :=
                                                                            ROUND(
                                                                              SalesLine."Unit Price" / (1 + (SalesLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF SalesLine.Quantity <> 0 THEN BEGIN
                                                                            SalesLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                SalesLine.Quantity * SalesLine."Unit Price" * SalesLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            SalesLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                SalesLine."Inv. Discount Amount" / (1 + (SalesLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      SalesLine.MODIFY;
                                                                    UNTIL SalesLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              ESM=Precios IVA incluido;
                                                              FRC=Prix incluant la TVA;
                                                              ENC=Prices Including VAT] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                              END;

                                                   AccessByPermission=TableData 19=R;
                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              ESM=C¢d. dto. factura;
                                                              FRC=Code escompte facture;
                                                              ENC=Invoice Disc. Code] }
    { 40  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Customer Disc. Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              ESM=Grupo dto. cliente;
                                                              FRC=Groupe d'escompte du client;
                                                              ENC=Customer Disc. Group] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              ESM=C¢d. idioma;
                                                              FRC=Code langue;
                                                              ENC=Language Code] }
    { 43  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                ApprovalEntry@1001 : Record 454;
                                                              BEGIN
                                                                ApprovalEntry.SETRANGE("Table ID",DATABASE::"Sales Header");
                                                                ApprovalEntry.SETRANGE("Document Type","Document Type");
                                                                ApprovalEntry.SETRANGE("Document No.","No.");
                                                                ApprovalEntry.SETFILTER(Status,'%1|%2',ApprovalEntry.Status::Created,ApprovalEntry.Status::Open);
                                                                IF NOT ApprovalEntry.ISEMPTY THEN
                                                                  ERROR(Text053,FIELDCAPTION("Salesperson Code"));

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              ESM=C¢d. vendedor;
                                                              FRC=Code repr‚sentant;
                                                              ENC=Salesperson Code] }
    { 45  ;   ;Order Class         ;Code10        ;CaptionML=[ENU=Order Class;
                                                              ESM=Clase pedido;
                                                              FRC=Classe commande;
                                                              ENC=Order Class] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Comment Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                 No.=FIELD(No.),
                                                                                                 Document Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              ESM=Comentario;
                                                              FRC=Commentaire;
                                                              ENC=Comment];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              ESM=N§ copias impresas;
                                                              FRC=Nombre impressions;
                                                              ENC=No. Printed];
                                                   Editable=No }
    { 51  ;   ;On Hold             ;Code3         ;TableRelation=IF (Pick Status=FILTER(' ')) "Custom Field Lookup Selections".Code WHERE (Ref Type=CONST(On Hold))
                                                                 ELSE IF (Pick Status=FILTER(<>' ')) "Custom Field Lookup Selections".Code WHERE (Ref Type=CONST(Shipping Hold));
                                                   CaptionML=[ENU=On Hold;
                                                              ESM=Esperar;
                                                              FRC=En attente;
                                                              ENC=On Hold];
                                                   Description=DW 1/14 Add Table Relation }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              ESM=Liq. por tipo documento;
                                                              FRC=Type document affect‚ …;
                                                              ENC=Applies-to Doc. Type];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    ESM=" ,Pago,Factura,Nota cr‚dito,Docs. inter‚s,Recordatorio,Reembolso";
                                                                    FRC=" ,Paiement,Facture,Note de cr‚dit,Note de frais financiers,Rappel,Remboursement";
                                                                    ENC=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=BEGIN
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.");
                                                                  SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    SetAmountToApply("Applies-to Doc. No.","Bill-to Customer No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      SetAmountToApply(xRec."Applies-to Doc. No.","Bill-to Customer No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              CustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive,"Due Date");
                                                              CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                              CustLedgEntry.SETRANGE(Open,TRUE);
                                                              IF "Applies-to Doc. No." <> '' THEN BEGIN
                                                                CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                IF CustLedgEntry.FINDFIRST THEN;
                                                                CustLedgEntry.SETRANGE("Document Type");
                                                                CustLedgEntry.SETRANGE("Document No.");
                                                              END ELSE
                                                                IF "Applies-to Doc. Type" <> 0 THEN BEGIN
                                                                  CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                  IF CustLedgEntry.FINDFIRST THEN;
                                                                  CustLedgEntry.SETRANGE("Document Type");
                                                                END ELSE
                                                                  IF Amount <> 0 THEN BEGIN
                                                                    CustLedgEntry.SETRANGE(Positive,Amount < 0);
                                                                    IF CustLedgEntry.FINDFIRST THEN;
                                                                    CustLedgEntry.SETRANGE(Positive);
                                                                  END;

                                                              ApplyCustEntries.SetSales(Rec,CustLedgEntry,SalesHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
                                                              ApplyCustEntries.SETRECORD(CustLedgEntry);
                                                              ApplyCustEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyCustEntries.GetCustLedgEntry(CustLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",CustLedgEntry."Currency Code",GenJnILine."Account Type"::Customer,TRUE);
                                                                "Applies-to Doc. Type" := CustLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := CustLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyCustEntries);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              ESM=Liq. por n§ documento;
                                                              FRC=Nø doc. affect‚ …;
                                                              ENC=Applies-to Doc. No.] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              ESM=Cta. contrapartida;
                                                              FRC=Nø compte contr“le;
                                                              ENC=Bal. Account No.] }
    { 56  ;   ;Recalculate Invoice Disc.;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Recalculate Invoice Disc.=CONST(Yes)));
                                                   CaptionML=[ENU=Recalculate Invoice Disc.;
                                                              ESM=Recalcular dto. en la factura;
                                                              FRC=Recalculer remise facture;
                                                              ENC=Recalculate Invoice Disc.];
                                                   Editable=No }
    { 57  ;   ;Ship                ;Boolean       ;CaptionML=[ENU=Ship;
                                                              ESM=Env¡o;
                                                              FRC=Livrer;
                                                              ENC=Ship];
                                                   Editable=No }
    { 58  ;   ;Invoice             ;Boolean       ;CaptionML=[ENU=Invoice;
                                                              ESM=Factura;
                                                              FRC=Facture;
                                                              ENC=Invoice] }
    { 59  ;   ;Print Posted Documents;Boolean     ;CaptionML=[ENU=Print Posted Documents;
                                                              ESM=Imprimir documentos registrados;
                                                              FRC=Imprimer les documents report‚s;
                                                              ENC=Print Posted Documents] }
    { 60  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line".Amount WHERE (Document Type=FIELD(Document Type),
                                                                                              Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount;
                                                              ESM=Importe;
                                                              FRC=Montant;
                                                              ENC=Amount];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Amount Including VAT;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Amount Including VAT" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Including Tax;
                                                              ESM=Importe IVA incl.;
                                                              FRC=Montant avec TVA;
                                                              ENC=Amount Including Tax];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[ENU=Shipping No.;
                                                              ESM=N§ env¡o venta;
                                                              FRC=Nø livraison;
                                                              ENC=Shipping No.] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              ESM=N§ sig. factura;
                                                              FRC=Nø report;
                                                              ENC=Posting No.] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;TableRelation="Sales Shipment Header";
                                                   CaptionML=[ENU=Last Shipping No.;
                                                              ESM=élt. n§ env¡o venta;
                                                              FRC=Nø dern. bon de livraison;
                                                              ENC=Last Shipping No.];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              ESM=élt. n§ factura;
                                                              FRC=Nø dernier report;
                                                              ENC=Last Posting No.];
                                                   Editable=No }
    { 66  ;   ;Prepayment No.      ;Code20        ;CaptionML=[ENU=Prepayment No.;
                                                              ESM=N§ anticipo;
                                                              FRC=Nø paiement anticip‚;
                                                              ENC=Prepayment No.] }
    { 67  ;   ;Last Prepayment No. ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[ENU=Last Prepayment No.;
                                                              ESM=N§ £ltimo anticipo;
                                                              FRC=Dernier nø de paiement anticip‚;
                                                              ENC=Last Prepayment No.] }
    { 68  ;   ;Prepmt. Cr. Memo No.;Code20        ;CaptionML=[ENU=Prepmt. Cr. Memo No.;
                                                              ESM=N§ nota cr‚dito anticipo;
                                                              FRC=Nø note de cr‚dit pour paiement anticip‚;
                                                              ENC=Prepmt. Cr. Memo No.] }
    { 69  ;   ;Last Prepmt. Cr. Memo No.;Code20   ;TableRelation="Sales Cr.Memo Header";
                                                   CaptionML=[ENU=Last Prepmt. Cr. Memo No.;
                                                              ESM=N§ £ltima nota cr‚dito anticipo;
                                                              FRC=Dernier nø note de cr‚dit pour paiement anticip‚;
                                                              ENC=Last Prepmt. Cr. Memo No.] }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=Tax Registration No.;
                                                              ESM=RFC/Curp;
                                                              FRC=Nø identification TPS/TVH;
                                                              ENC=GST/HST Registration No.] }
    { 71  ;   ;Combine Shipments   ;Boolean       ;CaptionML=[ENU=Combine Shipments;
                                                              ESM=Fact. autom tica;
                                                              FRC=Combiner les livraisons;
                                                              ENC=Combine Shipments] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              ESM=C¢d. auditor¡a;
                                                              FRC=Code motif;
                                                              ENC=Reason Code] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN BEGIN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                    RecreateSalesLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              ESM=Grupo contable negocio;
                                                              FRC=Groupe de report de march‚;
                                                              ENC=Gen. Bus. Posting Group] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              ESM=Op. triangular;
                                                              FRC=Trans. tripartite UE;
                                                              ENC=EU 3-Party Trade] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transaction Type"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              ESM=Naturaleza transacci¢n;
                                                              FRC=Type de transaction;
                                                              ENC=Transaction Type] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transport Method"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              ESM=Modo transporte;
                                                              FRC=Mode de transport;
                                                              ENC=Transport Method] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Tax Country/Region Code;
                                                              ESM=C¢d. IVA pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion TVA;
                                                              ENC=VAT Country/Region Code] }
    { 79  ;   ;Sell-to Customer Name;Text50       ;CaptionML=[ENU=Sell-to Customer Name;
                                                              ESM=Venta a-Nombre;
                                                              FRC=Nom du client (d‚biteur);
                                                              ENC=Sell-to Customer Name] }
    { 80  ;   ;Sell-to Customer Name 2;Text50     ;CaptionML=[ENU=Sell-to Customer Name 2;
                                                              ESM=Venta a-Nombre 2;
                                                              FRC=Nom 2 du client (d‚biteur);
                                                              ENC=Sell-to Customer Name 2] }
    { 81  ;   ;Sell-to Address     ;Text50        ;CaptionML=[ENU=Sell-to Address;
                                                              ESM=Venta a-Direcci¢n;
                                                              FRC=Adresse (d‚biteur);
                                                              ENC=Sell-to Address] }
    { 82  ;   ;Sell-to Address 2   ;Text50        ;CaptionML=[ENU=Sell-to Address 2;
                                                              ESM=Venta a-Colonia;
                                                              FRC=Adresse 2 (d‚biteur);
                                                              ENC=Sell-to Address 2] }
    { 83  ;   ;Sell-to City        ;Text30        ;OnValidate=BEGIN
                                                                //DW002
                                                                //IF "Date Received" = 0D THEN
                                                                //  PostCode.ValidateCity("Sell-to City","Sell-to Post Code","Sell-to County");
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpCity("Sell-to City","Sell-to Post Code","Sell-to County",TRUE);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to City;
                                                              ESM=Venta a-Municipio/Ciudad;
                                                              FRC=Ville (d‚biteur);
                                                              ENC=Sell-to City] }
    { 84  ;   ;Sell-to Contact     ;Text60        ;CaptionML=[ENU=Sell-to Contact;
                                                              ESM=Venta a-Atenci¢n;
                                                              FRC=Contact (d‚biteur);
                                                              ENC=Sell-to Contact] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=ZIP Code;
                                                              ESM=Fact. a-C.P.;
                                                              FRC=Code postal de facturation;
                                                              ENC=Postal/ZIP Code] }
    { 86  ;   ;Bill-to County      ;Text30        ;CaptionML=[ENU=State;
                                                              ESM=Fact. a-Provincia;
                                                              FRC=Comt‚ de facturation;
                                                              ENC=Province/State] }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              ESM=Fact. a-C¢d. pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion (facturation);
                                                              ENC=Country/Region Code] }
    { 88  ;   ;Sell-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                //RAD 101008 Removed Validation for EDI
                                                                {IF "Date Received" = 0D THEN
                                                                  PostCode.ValidatePostCode("Sell-to City","Sell-to Post Code","Sell-to County");
                                                                }
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpPostCode("Sell-to City","Sell-to Post Code","Sell-to County",TRUE);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Sell-to ZIP Code;
                                                              ESM=Venta a-C.P.;
                                                              FRC=Code postal (d‚biteur);
                                                              ENC=Sell-to Postal/ZIP Code] }
    { 89  ;   ;Sell-to County      ;Text30        ;CaptionML=[ENU=Sell-to State;
                                                              ESM=Venta a-Provincia;
                                                              FRC=Comt‚ (d‚biteur);
                                                              ENC=Sell-to Province/State] }
    { 90  ;   ;Sell-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Ship-to Country/Region Code");
                                                              END;

                                                   CaptionML=[ENU=Sell-to Country/Region Code;
                                                              ESM=Venta a-C¢d. pa¡s/regi¢n;
                                                              FRC=Code pays/r‚gion (d‚biteur);
                                                              ENC=Sell-to Country/Region Code] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=VAR
                                                                locshipMethod@1000000000 : Record 10;
                                                                CheckPost@1000000001 : Boolean;
                                                              BEGIN

                                                                //PostCode.ValidatePostCode(
                                                                //  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                                // 2016 Remove Address checking; no longer multi-company
                                                                 {  //Mike
                                                                VALIDATE("Ship-to Country/Region Code");  //SLW20160324
                                                                VALIDATE("Ship-to County");  //SLW20160324
                                                                }
                                                              END;

                                                   OnLookup=BEGIN
                                                              VALIDATE("Ship-to Post Code");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to ZIP Code;
                                                              ESM=Env¡o a-C.P.;
                                                              FRC=Code postal destinataire;
                                                              ENC=Ship-to Postal/ZIP Code] }
    { 92  ;   ;Ship-to County      ;Text30        ;OnValidate=BEGIN
                                                                // T388 New New Auto Best
                                                                IF ("Ship-to Country/Region Code" IN ['US','CA']) THEN BEGIN
                                                                  VALIDATE("Location Code",ECRFulfillment.SimpleBestLocation(Rec,"Ship-to County"));
                                                                  CheckFreightQuote;  //B2C02
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to State;
                                                              ESM=Env¡o a-Provincia;
                                                              FRC=Comt‚ destinataire;
                                                              ENC=Ship-to Province/State] }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                // >> Shipping
                                                                IF "Ship-to Country/Region Code" <> xRec."Ship-to Country/Region Code" THEN
                                                                  IF "Shipping Agent Code" <> '' THEN BEGIN
                                                                    xRec."Shipping Agent Code" := '';
                                                                    VALIDATE("Shipping Agent Code");
                                                                  END;
                                                                // << Shipping

                                                                CheckFreightQuote;  //B2C02
                                                              END;

                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              ESM=C¢d. pa¡s/regi¢n direcci¢n de env¡o;
                                                              FRC=Code pays/r‚gion (destinataire);
                                                              ENC=Ship-to Country/Region Code] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              ESM=Tipo contrapartida;
                                                              FRC=Type compte contr“le;
                                                              ENC=Bal. Account Type];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    ESM=Cuenta,Banco;
                                                                    FRC=Compte GL,Compte bancaire;
                                                                    ENC=G/L Account,Bank Account];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Exit Point"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Exit Point;
                                                              ESM=Puerto/Aerop. carga;
                                                              FRC=Pays destination;
                                                              ENC=Exit Point] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              ESM=Correcci¢n;
                                                              FRC=Correction;
                                                              ENC=Correction] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                IF xRec."Document Date" <> "Document Date" THEN
                                                                  UpdateDocumentDate := TRUE;
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              ESM=Fecha emisi¢n documento;
                                                              FRC=Date document;
                                                              ENC=Document Date] }
    { 100 ;   ;External Document No.;Code35       ;OnValidate=BEGIN
                                                                CheckDuplicateDocNo; //DW006
                                                              END;

                                                   CaptionML=[ENU=Purchase Order No.;
                                                              ESM=N§ documento externo;
                                                              FRC=Nø document externe;
                                                              ENC=Purchase Order No.];
                                                   Description=DW002 }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION(Area),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              ESM=C¢d. provincia;
                                                              FRC=Zone;
                                                              ENC=Area] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdateSalesLines(FIELDCAPTION("Transaction Specification"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              ESM=Especificaci¢n transacci¢n;
                                                              FRC=Sp‚cification transaction;
                                                              ENC=Transaction Specification] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=VAR
                                                                SEPADirectDebitMandate@1000 : Record 1230;
                                                                DOPaymentTransLogEntry@1001 : Record 829;
                                                              BEGIN
                                                                IF DOPaymentTransLogEntry.FINDFIRST THEN
                                                                  DOPaymentTransLogMgt.ValidateHasNoValidTransactions("Document Type",FORMAT("Document Type"),"No.");
                                                                IF DOPaymentMgt.IsValidPaymentMethod(xRec."Payment Method Code") AND NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code")
                                                                THEN
                                                                  TESTFIELD("Credit Card No.",'');
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                IF PaymentMethod."Direct Debit" THEN BEGIN
                                                                  IF "Direct Debit Mandate ID" = '' THEN
                                                                    "Direct Debit Mandate ID" := SEPADirectDebitMandate.GetDefaultMandate("Bill-to Customer No.","Due Date");
                                                                  IF "Payment Terms Code" = '' THEN
                                                                    "Payment Terms Code" := PaymentMethod."Direct Debit Pmt. Terms Code";
                                                                END;
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                "Bal. Account No." := PaymentMethod."Bal. Account No.";
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              ESM=C¢d. forma pago;
                                                              FRC=Code mode de paiement;
                                                              ENC=Payment Method Code] }
    { 105 ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."Shipping Agent Code" = "Shipping Agent Code" THEN
                                                                  EXIT;

                                                                "Shipping Agent Service Code" := '';
                                                                GetShippingTime(FIELDNO("Shipping Agent Code"));
                                                                UpdateSalesLines(FIELDCAPTION("Shipping Agent Code"),CurrFieldNo <> 0);
                                                                // >> Shipping
                                                                SalesSetup.GET;
                                                                // TCFRT02 Begin
                                                                // IF SalesSetup."Pickup Shipping Agent Code" <> '' THEN
                                                                //  IF "Shipping Agent Code" = SalesSetup."Pickup Shipping Agent Code" THEN
                                                                //    "Shipping Payment Type" := "Shipping Payment Type"::"Third Party"; // DW 8/14 REMOVED 5/17

                                                                IF SalesSetup."Enable Shipping" THEN BEGIN // TCFRT02 End
                                                                IF ("Shipping Agent Code" <> xRec."Shipping Agent Code") AND
                                                                   (xRec."Shipping Agent Code" <> '') AND SalesSetup."Enable Shipping"
                                                                THEN BEGIN
                                                                  IF CurrFieldNo = FIELDNO("Shipping Agent Code") THEN BEGIN
                                                                    DeleteShippingAgentOptionPage;

                                                                    Package.RESET;
                                                                    Package.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                                                                    Package.SETRANGE("Source Type",DATABASE::"Sales Header");
                                                                    Package.SETRANGE("Source Subtype","Document Type");
                                                                    Package.SETRANGE("Source ID","No.");
                                                                    IF Package.FIND('-') THEN
                                                                      MESSAGE(Text14000701);
                                                                  END;

                                                                  VALIDATE("E-Ship Agent Service",'');
                                                                END;

                                                                IF ("Shipping Agent Code" <> '') AND SalesSetup."Enable Shipping" THEN BEGIN
                                                                  ShippingAgent.GET("Shipping Agent Code");
                                                                  "World Wide Service" :=
                                                                     EShipAgentService.WorldWideService(ShippingAgent,"Ship-to Country/Region Code");
                                                                  VALIDATE(
                                                                    "E-Ship Agent Service",
                                                                    EShipAgentService.DefaultShipAgentService(ShippingAgent,"Ship-to Country/Region Code"));

                                                                  IF CurrFieldNo = FIELDNO("Shipping Agent Code") THEN
                                                                    EShipAgentService.CheckNameAddressSalesHeader(Rec,"Shipping Agent Code");
                                                                END ELSE
                                                                  "World Wide Service" := FALSE;

                                                                IF "Shipping Agent Code" <> xRec."Shipping Agent Code" THEN
                                                                  IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                    VALIDATE("Third Party Ship. Account No.",'')
                                                                  ELSE
                                                                    IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                         "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                         "Sell-to Customer No.","Ship-to Code")
                                                                    THEN
                                                                      VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.")
                                                                    ELSE //  Add this:
                                                                      IF ShippingAccount.GetShippingAccountNoByLocation(
                                                                         "Shipping Agent Code","Sell-to Customer No.","Ship-to Code","Location Code") THEN
                                                                        VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.")
                                                                      ELSE
                                                                        VALIDATE("Third Party Ship. Account No.",'');
                                                                END; // TCFRT02
                                                                // << Shipping
                                                                SetPackRuleShipping(FIELDNO("Shipping Agent Code")); // DWPR
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              ESM=C¢d. transportista;
                                                              FRC=Code agent de livraison;
                                                              ENC=Shipping Agent Code] }
    { 106 ;   ;Package Tracking No.;Text30        ;CaptionML=[ENU=Package Tracking No.;
                                                              ESM=N§ seguimiento bulto;
                                                              FRC=Nø de tra‡abilit‚;
                                                              ENC=Package Tracking No.] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              ESM=Nos. serie;
                                                              FRC=S‚ries de nø;
                                                              ENC=No. Series];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              ESM=N§ serie registro;
                                                              FRC=S‚ries de nø report;
                                                              ENC=Posting No. Series] }
    { 109 ;   ;Shipping No. Series ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Shipping No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series");
                                                                END;
                                                                TESTFIELD("Shipping No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Shipment Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Shipment Nos.","Shipping No. Series") THEN
                                                                  VALIDATE("Shipping No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Shipping No. Series;
                                                              ESM=N§  serie de env¡os;
                                                              FRC=S‚ries de nø livraison;
                                                              ENC=Shipping No. Series] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              ESM=C¢d.  rea impuesto;
                                                              FRC=Code de r‚gion fiscale;
                                                              ENC=Tax Area Code] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                UpdateSalesLines(FIELDCAPTION("Tax Liable"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              ESM=Sujeto a impuesto;
                                                              FRC=Imposable;
                                                              ENC=Tax Liable] }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group" THEN
                                                                  RecreateSalesLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=Tax Bus. Posting Group;
                                                              ESM=Grupo registro IVA neg.;
                                                              FRC=Groupe de reports de taxe sur la valeur ajout‚e de l'entreprise;
                                                              ENC=Tax Bus. Posting Group] }
    { 117 ;   ;Reserve             ;Option        ;AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Reserve;
                                                              ESM=Reserva;
                                                              FRC=R‚server;
                                                              ENC=Reserve];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    ESM=Nunca,Opcional,Siempre;
                                                                    FRC=Jamais,Optionnel,Toujours;
                                                                    ENC=Never,Optional,Always];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                TempCustLedgEntry@1000 : Record 21;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.",Open);
                                                                  CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  CustLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,'');
                                                                  CustLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              ESM=Liq. por id.;
                                                              FRC=Code affect‚ …;
                                                              ENC=Applies-to ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                // >> EDI
                                                                IF EDITemp THEN
                                                                  EXIT;
                                                                // << EDI

                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    FIELDCAPTION("VAT Base Discount %"),
                                                                    GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                    GLSetup.TABLECAPTION);

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                SalesLine.SETRANGE("Document Type","Document Type");
                                                                SalesLine.SETRANGE("Document No.","No.");
                                                                SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
                                                                SalesLine.SETFILTER(Quantity,'<>0');
                                                                SalesLine.LOCKTABLE;
                                                                LOCKTABLE;
                                                                IF SalesLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    IF (SalesLine."Quantity Invoiced" <> SalesLine.Quantity) OR
                                                                       ("Shipping Advice" <> "Shipping Advice"::Partial) OR
                                                                       (SalesLine.Type <> SalesLine.Type::"Charge (Item)") OR
                                                                       (CurrFieldNo <> 0)
                                                                    THEN BEGIN
                                                                      SalesLine.UpdateAmounts;
                                                                      SalesLine.MODIFY;
                                                                    END;
                                                                  UNTIL SalesLine.NEXT = 0;
                                                                END;
                                                                SalesLine.RESET;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              ESM=% Dto. base IVA;
                                                              FRC=% escompte base TVA;
                                                              ENC=VAT Base Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              ESM=Estado;
                                                              FRC=tat;
                                                              ENC=Status];
                                                   OptionCaptionML=[ENU=Open,Released,Pending Approval,Pending Prepayment;
                                                                    ESM=Abierto,Lanzado,Aprobaci¢n pendiente,Anticipo pendiente;
                                                                    FRC=Ouvert,Lib‚r‚,Approbation en attente,Paiement anticip‚ en attente;
                                                                    ENC=Open,Released,Pending Approval,Pending Prepayment];
                                                   OptionString=Open,Released,Pending Approval,Pending Prepayment;
                                                   Editable=No }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              ESM=C lculo descuento factura;
                                                              FRC=Calcul escompte facture;
                                                              ENC=Invoice Discount Calculation];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    ESM=Ninguno,%,Importe;
                                                                    FRC=Aucun,%,Montant;
                                                                    ENC=None,%,Amount];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              ESM=Valor descuento factura;
                                                              FRC=Valeur escompte facture;
                                                              ENC=Invoice Discount Value];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 123 ;   ;Send IC Document    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Send IC Document" THEN BEGIN
                                                                  IF "Bill-to IC Partner Code" = '' THEN
                                                                    TESTFIELD("Sell-to IC Partner Code");
                                                                  TESTFIELD("IC Direction","IC Direction"::Outgoing);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Send IC Document;
                                                              ESM=Enviar documento IC;
                                                              FRC=Envoyer document IC;
                                                              ENC=Send IC Document] }
    { 124 ;   ;IC Status           ;Option        ;CaptionML=[ENU=IC Status;
                                                              ESM=Estado socio IC;
                                                              FRC=tat IC;
                                                              ENC=IC Status];
                                                   OptionCaptionML=[ENU=New,Pending,Sent;
                                                                    ESM=Nuevo,Pendiente,Enviado;
                                                                    FRC=Nouveau,En attente,Envoy‚;
                                                                    ENC=New,Pending,Sent];
                                                   OptionString=New,Pending,Sent }
    { 125 ;   ;Sell-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Sell-to IC Partner Code;
                                                              ESM=C¢digo IC asociada de venta;
                                                              FRC=Code partenaire IC (d‚biteur);
                                                              ENC=Sell-to IC Partner Code];
                                                   Editable=No }
    { 126 ;   ;Bill-to IC Partner Code;Code20     ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=IC Partner Code;
                                                              ESM=C¢digo IC asociada facturaci¢n;
                                                              FRC=Code de partenaire IC;
                                                              ENC=IC Partner Code];
                                                   Editable=No }
    { 129 ;   ;IC Direction        ;Option        ;OnValidate=BEGIN
                                                                IF "IC Direction" = "IC Direction"::Incoming THEN
                                                                  "Send IC Document" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=IC Direction;
                                                              ESM=Direcci¢n env¡o IC;
                                                              FRC=Direction IC;
                                                              ENC=IC Direction];
                                                   OptionCaptionML=[ENU=Outgoing,Incoming;
                                                                    ESM=Saliente,Entrante;
                                                                    FRC=Sortant,Entrant;
                                                                    ENC=Outgoing,Incoming];
                                                   OptionString=Outgoing,Incoming }
    { 130 ;   ;Prepayment %        ;Decimal       ;OnValidate=BEGIN
                                                                IF xRec."Prepayment %" <> "Prepayment %" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Prepayment %"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Prepayment %;
                                                              ESM=% anticipo;
                                                              FRC=% paiement anticip‚;
                                                              ENC=Prepayment %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 131 ;   ;Prepayment No. Series;Code10       ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepayment No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series");
                                                                END;
                                                                TESTFIELD("Prepayment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series") THEN
                                                                  VALIDATE("Prepayment No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepayment No. Series;
                                                              ESM=N§ serie anticipo;
                                                              FRC=Nø s‚rie de paiement anticip‚;
                                                              ENC=Prepayment No. Series] }
    { 132 ;   ;Compress Prepayment ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Compress Prepayment;
                                                              ESM=Compresi¢n anticipo;
                                                              FRC=Compression paiement anticip‚;
                                                              ENC=Compress Prepayment] }
    { 133 ;   ;Prepayment Due Date ;Date          ;CaptionML=[ENU=Prepayment Due Date;
                                                              ESM=Fecha vencimiento anticipo;
                                                              FRC=ch‚ance de paiement anticip‚;
                                                              ENC=Prepayment Due Date] }
    { 134 ;   ;Prepmt. Cr. Memo No. Series;Code10 ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepmt. Cr. Memo No." <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series");
                                                                END;
                                                                TESTFIELD("Prepmt. Cr. Memo No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series") THEN
                                                                  VALIDATE("Prepmt. Cr. Memo No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepmt. Cr. Memo No. Series;
                                                              ESM=N§ serie nota cr‚dito anticipo;
                                                              FRC=Nø s‚rie de note de cr‚dit pour paiement anticip‚;
                                                              ENC=Prepmt. Cr. Memo No. Series] }
    { 135 ;   ;Prepmt. Posting Description;Text50 ;CaptionML=[ENU=Prepmt. Posting Description;
                                                              ESM=Texto registro anticipo;
                                                              FRC=Description du report de paiement anticip‚;
                                                              ENC=Prepmt. Posting Description] }
    { 138 ;   ;Prepmt. Pmt. Discount Date;Date    ;CaptionML=[ENU=Prepmt. Pmt. Discount Date;
                                                              ESM=Fecha dto. P.P. anticipo;
                                                              FRC=Date d'escompte de paiement anticip‚;
                                                              ENC=Prepmt. Pmt. Discount Date] }
    { 139 ;   ;Prepmt. Payment Terms Code;Code10  ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                PaymentTerms@1000 : Record 3;
                                                              BEGIN
                                                                IF ("Prepmt. Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Prepmt. Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Prepayment Due Date","Document Date");
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Prepmt. Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Prepmt. Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Prepayment Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Terms Code;
                                                              ESM=C¢digo t‚rminos anticipo;
                                                              FRC=Code modal. rŠgl. paiem. antic.;
                                                              ENC=Prepmt. Payment Terms Code] }
    { 140 ;   ;Prepmt. Payment Discount %;Decimal ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Discount %;
                                                              ESM=% descuento anticipo;
                                                              FRC=% escompte rŠgl. paiem. antic.;
                                                              ENC=Prepmt. Payment Discount %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              ESM=N§ cotizaci¢n;
                                                              FRC=Nø devis;
                                                              ENC=Quote No.];
                                                   Editable=No }
    { 160 ;   ;Job Queue Status    ;Option        ;OnLookup=VAR
                                                              JobQueueEntry@1000 : Record 472;
                                                            BEGIN
                                                              IF "Job Queue Status" = "Job Queue Status"::" " THEN
                                                                EXIT;
                                                              JobQueueEntry.ShowStatusMsg("Job Queue Entry ID");
                                                            END;

                                                   CaptionML=[ENU=Job Queue Status;
                                                              ESM=Estado de cola de proyectos;
                                                              FRC=tat de la file d'attente des travaux;
                                                              ENC=Job Queue Status];
                                                   OptionCaptionML=[ENU=" ,Scheduled for Posting,Error,Posting";
                                                                    ESM=" ,Programado para registro,Error,Registro";
                                                                    FRC=" ,Planifi‚ pour le report,Erreur,Report";
                                                                    ENC=" ,Scheduled for Posting,Error,Posting"];
                                                   OptionString=[ ,Scheduled for Posting,Error,Posting];
                                                   Editable=No }
    { 161 ;   ;Job Queue Entry ID  ;GUID          ;CaptionML=[ENU=Job Queue Entry ID;
                                                              ESM=Id. mov. cola proyecto;
                                                              FRC=Code ‚criture file d'attente des travaux;
                                                              ENC=Job Queue Entry ID];
                                                   Editable=No }
    { 165 ;   ;Incoming Document Entry No.;Integer;TableRelation="Incoming Document";
                                                   OnValidate=VAR
                                                                IncomingDocument@1000 : Record 130;
                                                              BEGIN
                                                                IF "Incoming Document Entry No." = xRec."Incoming Document Entry No." THEN
                                                                  EXIT;
                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  IncomingDocument.RemoveReferenceToWorkingDocument(xRec."Incoming Document Entry No.")
                                                                ELSE
                                                                  IncomingDocument.SetSalesDoc(Rec);
                                                              END;

                                                   CaptionML=[ENU=Incoming Document Entry No.;
                                                              ESM=N§ mov. de documentos entrantes;
                                                              FRC=Nø de s‚quence du document entrant;
                                                              ENC=Incoming Document Entry No.] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              ESM=Id. grupo dimensiones;
                                                              FRC=Code ensemble de dimensions;
                                                              ENC=Dimension Set ID];
                                                   Editable=No }
    { 825 ;   ;Authorization Required;Boolean     ;CaptionML=[ENU=Authorization Required;
                                                              ESM=Se necesita autorizaci¢n;
                                                              FRC=Autorisation requise;
                                                              ENC=Authorization Required] }
    { 827 ;   ;Credit Card No.     ;Code20        ;TableRelation="DO Payment Credit Card" WHERE (Customer No.=FIELD(Bill-to Customer No.));
                                                   OnValidate=VAR
                                                                DOPaymentTransLogEntry@1000 : Record 829;
                                                              BEGIN
                                                                IF NOT DOPaymentTransLogEntry.ISEMPTY THEN
                                                                  DOPaymentTransLogMgt.ValidateHasNoValidTransactions("Document Type",FORMAT("Document Type"),"No.");

                                                                IF "Credit Card No." = '' THEN
                                                                  EXIT;

                                                                DOPaymentMgt.CheckCreditCardData("Credit Card No.");

                                                                IF NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code") THEN
                                                                  FIELDERROR("Payment Method Code");
                                                              END;

                                                   CaptionML=[ENU=Credit Card No.;
                                                              ESM=N§ tarjeta de cr‚dito;
                                                              FRC=Nø de carte de cr‚dit;
                                                              ENC=Credit Card No.] }
    { 1200;   ;Direct Debit Mandate ID;Code35     ;TableRelation="SEPA Direct Debit Mandate" WHERE (Customer No.=FIELD(Bill-to Customer No.),
                                                                                                    Closed=CONST(No),
                                                                                                    Blocked=CONST(No));
                                                   CaptionML=[ENU=Direct Debit Mandate ID;
                                                              ESM=Id. de orden de domiciliaci¢n de adeudo directo;
                                                              FRC=ID mandat de pr‚lŠvement;
                                                              ENC=Direct Debit Mandate ID] }
    { 1305;   ;Invoice Discount Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Inv. Discount Amount" WHERE (Document No.=FIELD(No.),
                                                                                                              Document Type=FIELD(Document Type)));
                                                   CaptionML=[ENU=Invoice Discount Amount;
                                                              ESM=Importe descuento factura;
                                                              FRC=Montant d'escompte de la facture;
                                                              ENC=Invoice Discount Amount];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5043;   ;No. of Archived Versions;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Max("Sales Header Archive"."Version No." WHERE (Document Type=FIELD(Document Type),
                                                                                                               No.=FIELD(No.),
                                                                                                               Doc. No. Occurrence=FIELD(Doc. No. Occurrence)));
                                                   CaptionML=[ENU=No. of Archived Versions;
                                                              ESM=N§ de versiones archivadas;
                                                              FRC=Nbre versions archiv‚es;
                                                              ENC=No. of Archived Versions];
                                                   Editable=No }
    { 5048;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              ESM=Ocurrencia N§ doc.;
                                                              FRC=Occurrence nø doc.;
                                                              ENC=Doc. No. Occurrence] }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=VAR
                                                                locCampaign@1000000000 : Record 5071;
                                                              BEGIN
                                                                CreateDim(
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                //SLW20150120-begin
                                                                CLEAR(locCampaign);
                                                                IF locCampaign.GET("Campaign No.") THEN BEGIN
                                                                  IF locCampaign."Shipment Method" <> '' THEN
                                                                    VALIDATE("Shipment Method Code",locCampaign."Shipment Method");
                                                                  IF locCampaign."Shipping Agent Code" <> '' THEN
                                                                    VALIDATE("Shipping Agent Code", locCampaign."Shipping Agent Code");
                                                                  IF locCampaign."E-Ship Agent Service" <> '' THEN
                                                                    VALIDATE("E-Ship Agent Service", locCampaign."E-Ship Agent Service");
                                                                END;
                                                                //SLW20150120-end
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              ESM=N§ campa¤a;
                                                              FRC=Nø promotion;
                                                              ENC=Campaign No.] }
    { 5051;   ;Sell-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                SellToCustTemplate@1000 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TESTFIELD(Status,Status::Open);

                                                                IF NOT InsertMode AND
                                                                   ("Sell-to Customer Template Code" <> xRec."Sell-to Customer Template Code") AND
                                                                   (xRec."Sell-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Sell-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Sell-to Customer Template Code" = '' THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Sell-to Customer Template Code"));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Sell-to Customer Template Code" := xRec."Sell-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF SellToCustTemplate.GET("Sell-to Customer Template Code") THEN BEGIN
                                                                  IF GLSetup."VAT in Use" THEN
                                                                    SellToCustTemplate.TESTFIELD("Gen. Bus. Posting Group");
                                                                  "Gen. Bus. Posting Group" := SellToCustTemplate."Gen. Bus. Posting Group";
                                                                  "VAT Bus. Posting Group" := SellToCustTemplate."VAT Bus. Posting Group";
                                                                  IF "Bill-to Customer No." = '' THEN
                                                                    VALIDATE("Bill-to Customer Template Code","Sell-to Customer Template Code");
                                                                END;

                                                                IF NOT InsertMode AND
                                                                   ((xRec."Sell-to Customer Template Code" <> "Sell-to Customer Template Code") OR
                                                                    (xRec."Currency Code" <> "Currency Code"))
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Sell-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer Template Code;
                                                              ESM=Venta a-C¢d. plant. cliente;
                                                              FRC=Code modŠle d‚biteur;
                                                              ENC=Sell-to Customer Template Code] }
    { 5052;   ;Sell-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                                Opportunity@1000 : Record 5092;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Sell-to Contact No." <> xRec."Sell-to Contact No.") AND
                                                                   (xRec."Sell-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Sell-to Contact No." = '') AND ("Opportunity No." <> '') THEN
                                                                    ERROR(Text049,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Sell-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF ("Sell-to Contact No." = '') AND ("Sell-to Customer No." = '') THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Sell-to Contact No."));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                    IF "Opportunity No." <> '' THEN BEGIN
                                                                      Opportunity.GET("Opportunity No.");
                                                                      IF Opportunity."Contact No." <> "Sell-to Contact No." THEN BEGIN
                                                                        MODIFY;
                                                                        Opportunity.VALIDATE("Contact No.","Sell-to Contact No.");
                                                                        Opportunity.MODIFY;
                                                                      END
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Sell-to Customer No." <> '') AND ("Sell-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Sell-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Sell-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Sell-to Customer No.");
                                                                END;

                                                                UpdateSellToCust("Sell-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Sell-to Customer No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Sell-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Sell-to Contact No." <> '' THEN
                                                                IF Cont.GET("Sell-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Sell-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Sell-to Contact No.;
                                                              ESM=Venta a-N§ contacto;
                                                              FRC=Nø contact d‚biteur;
                                                              ENC=Sell-to Contact No.] }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Bill-to Contact No." <> xRec."Bill-to Contact No.") AND
                                                                   (xRec."Bill-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Bill-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF ("Bill-to Contact No." = '') AND ("Bill-to Customer No." = '') THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Bill-to Contact No."));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Contact No." := xRec."Bill-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Bill-to Customer No." <> '') AND ("Bill-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Bill-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Bill-to Customer No.");
                                                                END;

                                                                UpdateBillToCust("Bill-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Bill-to Customer No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Bill-to Contact No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Bill-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              ESM=Fact. a-N§ contacto;
                                                              FRC=Nø contact facturation;
                                                              ENC=Bill-to Contact No.] }
    { 5054;   ;Bill-to Customer Template Code;Code10;
                                                   TableRelation="Customer Template";
                                                   OnValidate=VAR
                                                                BillToCustTemplate@1001 : Record 5105;
                                                              BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Quote);
                                                                TESTFIELD(Status,Status::Open);

                                                                IF NOT InsertMode AND
                                                                   ("Bill-to Customer Template Code" <> xRec."Bill-to Customer Template Code") AND
                                                                   (xRec."Bill-to Customer Template Code" <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Bill-to Customer Template Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    SalesLine.RESET;
                                                                    SalesLine.SETRANGE("Document Type","Document Type");
                                                                    SalesLine.SETRANGE("Document No.","No.");
                                                                    IF "Bill-to Customer Template Code" = '' THEN BEGIN
                                                                      IF NOT SalesLine.ISEMPTY THEN
                                                                        ERROR(Text005,FIELDCAPTION("Bill-to Customer Template Code"));
                                                                      INIT;
                                                                      SalesSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Customer Template Code" := xRec."Bill-to Customer Template Code";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                VALIDATE("Ship-to Code",'');
                                                                IF BillToCustTemplate.GET("Bill-to Customer Template Code") THEN BEGIN
                                                                  BillToCustTemplate.TESTFIELD("Customer Posting Group");
                                                                  "Customer Posting Group" := BillToCustTemplate."Customer Posting Group";
                                                                  "Invoice Disc. Code" := BillToCustTemplate."Invoice Disc. Code";
                                                                  "Customer Price Group" := BillToCustTemplate."Customer Price Group";
                                                                  "Customer Disc. Group" := BillToCustTemplate."Customer Disc. Group";
                                                                  "Allow Line Disc." := BillToCustTemplate."Allow Line Disc.";
                                                                  "Tax Area Code" := BillToCustTemplate."Tax Area Code";
                                                                  "Tax Liable" := BillToCustTemplate."Tax Liable";
                                                                  VALIDATE("Payment Terms Code",BillToCustTemplate."Payment Terms Code");
                                                                  VALIDATE("Payment Method Code",BillToCustTemplate."Payment Method Code");
                                                                  "Shipment Method Code" := BillToCustTemplate."Shipment Method Code";
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");

                                                                IF NOT InsertMode AND
                                                                   (xRec."Sell-to Customer Template Code" = "Sell-to Customer Template Code") AND
                                                                   (xRec."Bill-to Customer Template Code" <> "Bill-to Customer Template Code")
                                                                THEN
                                                                  RecreateSalesLines(FIELDCAPTION("Bill-to Customer Template Code"));
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer Template Code;
                                                              ESM=Fact. a-C¢d. plant. cliente;
                                                              FRC=Code modŠle client factur‚;
                                                              ENC=Customer Template Code] }
    { 5055;   ;Opportunity No.     ;Code20        ;TableRelation=IF (Document Type=FILTER(<>Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                           Closed=CONST(No))
                                                                                                                           ELSE IF (Document Type=CONST(Order)) Opportunity.No. WHERE (Contact No.=FIELD(Sell-to Contact No.),
                                                                                                                                                                                       Sales Document No.=FIELD(No.),
                                                                                                                                                                                       Sales Document Type=CONST(Order));
                                                   OnValidate=BEGIN
                                                                LinkSalesDocWithOpportunity(xRec."Opportunity No.");
                                                              END;

                                                   CaptionML=[ENU=Opportunity No.;
                                                              ESM=N§ oportunidad;
                                                              FRC=Nø d'opportunit‚;
                                                              ENC=Opportunity No.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF NOT UserSetupMgt.CheckRespCenter(0,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text027,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter);

                                                                "Location Code" := UserSetupMgt.GetLocation(0,'',"Responsibility Center");
                                                                UpdateOutboundWhseHandlingTime;
                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Customer Template","Bill-to Customer Template Code");

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreateSalesLines(FIELDCAPTION("Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              ESM=Centro responsabilidad;
                                                              FRC=Centre de gestion;
                                                              ENC=Responsibility Centre] }
    { 5750;   ;Shipping Advice     ;Option        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF InventoryPickConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(Text066,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION);
                                                                IF WhseShpmntConflict("Document Type","No.","Shipping Advice") THEN
                                                                  ERROR(STRSUBSTNO(Text070,FIELDCAPTION("Shipping Advice"),FORMAT("Shipping Advice"),TABLECAPTION));

                                                                // >> EDI
                                                                IF NOT RunFromEDI THEN
                                                                // << EDI (Missing Indentation)
                                                                WhseSourceHeader.SalesHeaderVerifyChange(Rec,xRec);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipping Advice;
                                                              ESM=Aviso env¡o;
                                                              FRC=Avis de livraison;
                                                              ENC=Shipping Advice];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    ESM=Parcial,Completo;
                                                                    FRC=Partiel,Complet;
                                                                    ENC=Partial,Complete];
                                                   OptionString=Partial,Complete }
    { 5751;   ;Shipped Not Invoiced;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         Qty. Shipped Not Invoiced=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipped Not Invoiced;
                                                              ESM=Enviado no facturado;
                                                              FRC=Livr‚ non factur‚;
                                                              ENC=Shipped Not Invoiced];
                                                   Editable=No }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Sales Line"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                            Document No.=FIELD(No.),
                                                                                                            Type=FILTER(<>' '),
                                                                                                            Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              ESM=Enviado completamente;
                                                              FRC=EntiŠrement livr‚e;
                                                              ENC=Completely Shipped];
                                                   Editable=No }
    { 5753;   ;Posting from Whse. Ref.;Integer    ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Posting from Whse. Ref.;
                                                              ESM=Regis. desde almac. ref.;
                                                              FRC=Validat. … partir r‚f. magasin;
                                                              ENC=Posting from Whse. Ref.] }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              ESM=Filtro almac‚n;
                                                              FRC=Filtre emplacement;
                                                              ENC=Location Filter] }
    { 5790;   ;Requested Delivery Date;Date       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                {//T388 begin comment out
                                                                IF "Promised Delivery Date" <> 0D THEN
                                                                  ERROR(
                                                                    Text028,
                                                                    FIELDCAPTION("Requested Delivery Date"),
                                                                    FIELDCAPTION("Promised Delivery Date"));
                                                                }//T388 end comment

                                                                IF "Requested Delivery Date" <> xRec."Requested Delivery Date" THEN
                                                                  // DW 10/2010 Modify RT038 to follow standards
                                                                  IF HideValidationDialog THEN
                                                                    UpdateSalesLines(FIELDCAPTION("Requested Delivery Date"),FALSE)
                                                                  ELSE
                                                                  // DW
                                                                  UpdateSalesLines(FIELDCAPTION("Requested Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Requested Ship Date;
                                                              ESM=Fecha entrega requerida;
                                                              FRC=Date livraison demand‚e;
                                                              ENC=Requested Ship Date];
                                                   Description=DW 10/2010 Caption changed to Requested Ship Date }
    { 5791;   ;Promised Delivery Date;Date        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Delivery Date" <> xRec."Promised Delivery Date" THEN
                                                                  // DW 10/2010 Modify RT038 to follow standards
                                                                  IF HideValidationDialog THEN
                                                                    UpdateSalesLines(FIELDCAPTION("Promised Delivery Date"),FALSE)
                                                                  ELSE
                                                                  // DW
                                                                  UpdateSalesLines(FIELDCAPTION("Promised Delivery Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Promised Delivery Date;
                                                              ESM=Fecha entrega prometida;
                                                              FRC=Date livraison confirm‚e;
                                                              ENC=Promised Delivery Date] }
    { 5792;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Shipping Time" <> xRec."Shipping Time" THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Shipping Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              ESM=Tiempo env¡o;
                                                              FRC=D‚lai de livraison;
                                                              ENC=Shipping Time] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Outbound Whse. Handling Time" <> xRec."Outbound Whse. Handling Time") AND
                                                                   (xRec."Sell-to Customer No." = "Sell-to Customer No.")
                                                                THEN
                                                                  UpdateSalesLines(FIELDCAPTION("Outbound Whse. Handling Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 7320=R;
                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              ESM=Tiempo manip. alm. salida;
                                                              FRC=D‚lai d‚senlogement;
                                                              ENC=Outbound Whse. Handling Time] }
    { 5794;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                GetShippingTime(FIELDNO("Shipping Agent Service Code"));
                                                                UpdateSalesLines(FIELDCAPTION("Shipping Agent Service Code"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              ESM=C¢d. servicio transportista;
                                                              FRC=Code prestation agent de livraison;
                                                              ENC=Shipping Agent Service Code] }
    { 5795;   ;Late Order Shipping ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                         Document No.=FIELD(No.),
                                                                                         Shipment Date=FIELD(Date Filter),
                                                                                         Outstanding Quantity=FILTER(<>0)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Late Order Shipping;
                                                              ESM=Env¡o retrasado;
                                                              FRC=Livraison en retard;
                                                              ENC=Late Order Shipping];
                                                   Editable=No }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ESM=Filtro fecha;
                                                              FRC=Filtre date;
                                                              ENC=Date Filter] }
    { 5800;   ;Receive             ;Boolean       ;CaptionML=[ENU=Receive;
                                                              ESM=Recepci¢n;
                                                              FRC=Recevoir;
                                                              ENC=Receive] }
    { 5801;   ;Return Receipt No.  ;Code20        ;CaptionML=[ENU=Return Receipt No.;
                                                              ESM=N§ recep. devol.;
                                                              FRC=Nø r‚ception retour;
                                                              ENC=Return Receipt No.] }
    { 5802;   ;Return Receipt No. Series;Code10   ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Return Receipt No. Series" <> '' THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                  NoSeriesMgt.TestSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series");
                                                                END;
                                                                TESTFIELD("Return Receipt No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH SalesHeader DO BEGIN
                                                                SalesHeader := Rec;
                                                                SalesSetup.GET;
                                                                SalesSetup.TESTFIELD("Posted Return Receipt Nos.");
                                                                IF NoSeriesMgt.LookupSeries(SalesSetup."Posted Return Receipt Nos.","Return Receipt No. Series") THEN
                                                                  VALIDATE("Return Receipt No. Series");
                                                                Rec := SalesHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Return Receipt No. Series;
                                                              ESM=N§ serie recep. devol.;
                                                              FRC=Souche de nø r‚ception retour;
                                                              ENC=Return Receipt No. Series] }
    { 5803;   ;Last Return Receipt No.;Code20     ;TableRelation="Return Receipt Header";
                                                   CaptionML=[ENU=Last Return Receipt No.;
                                                              ESM=N§ £ltima recep. devol.;
                                                              FRC=Dernier nø r‚ception retour;
                                                              ENC=Last Return Receipt No.];
                                                   Editable=No }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfSalesLinesExist(FIELDCAPTION("Allow Line Disc."));
                                                              END;

                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              ESM=Permite dto. l¡nea;
                                                              FRC=Autoriser remise ligne;
                                                              ENC=Allow Line Disc.] }
    { 7200;   ;Get Shipment Used   ;Boolean       ;CaptionML=[ENU=Get Shipment Used;
                                                              ESM=Obtener m‚todo de env¡o usado;
                                                              FRC=Extraire livraison utilis‚e;
                                                              ENC=Get Shipment Used];
                                                   Editable=No }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(0,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text061,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetSalesFilter2("Assigned User ID"));
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              ESM=Id. usuario asignado;
                                                              FRC=Code utilisateur affect‚;
                                                              ENC=Assigned User ID] }
    { 10005;  ;Ship-to UPS Zone    ;Code2         ;CaptionML=[ENU=Ship-to UPS Zone;
                                                              ESM=Env¡o a-Zona UPS;
                                                              FRC=Zone de livraison UPS;
                                                              ENC=Ship-to UPS Zone] }
    { 10009;  ;Outstanding Amount ($);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                  Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Outstanding Amount ($);
                                                              ESM=Importe pendiente ($);
                                                              FRC=Montant non pay‚ ($);
                                                              ENC=Outstanding Amount ($)];
                                                   Editable=No }
    { 10015;  ;Tax Exemption No.   ;Text30        ;CaptionML=[ENU=Tax Exemption No.;
                                                              ESM=N§ exenci¢n fisc.;
                                                              FRC=Nø d'exon‚ration fiscale;
                                                              ENC=Tax Exemption No.] }
    { 10018;  ;STE Transaction ID  ;Text20        ;CaptionML=[ENU=STE Transaction ID;
                                                              ESM=Id. transacci¢n STE;
                                                              FRC=ID de transaction STE;
                                                              ENC=STE Transaction ID];
                                                   Editable=No }
    { 12600;  ;Prepmt. Include Tax ;Boolean       ;OnValidate=VAR
                                                                GLSetup@1020000 : Record 98;
                                                              BEGIN
                                                                IF IsPrepmtInvoicePosted THEN
                                                                  ERROR(PrepmtInvoiceExistsErr,FIELDCAPTION("Prepmt. Include Tax"));
                                                                IF xRec."Prepmt. Include Tax" = "Prepmt. Include Tax" THEN
                                                                  EXIT;
                                                                IF NOT "Prepmt. Include Tax" THEN
                                                                  EXIT;
                                                                IF "Currency Code" = '' THEN
                                                                  EXIT;
                                                                GLSetup.GET;
                                                                IF GLSetup."LCY Code" = "Currency Code" THEN
                                                                  EXIT;
                                                                ERROR(PrepmtIncludeTaxErr,FIELDCAPTION("Prepmt. Include Tax"));
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Include Tax;
                                                              ESM=Impuesto incluido anticipo;
                                                              FRC=Paiem. ant. avec taxe;
                                                              ENC=Prepmt. Include Tax] }
    { 50000;  ;Cancel After Date   ;Date          ;Description=TCFRT01 }
    { 50001;  ;Ship-to Phone       ;Text30        ;CaptionML=ENU=Phone No.;
                                                   Description=tjb DW Change Caption }
    { 50002;  ;Ship-to E-mail      ;Text60        ;Description=tjb }
    { 50008;  ;Allocation Level    ;Option        ;OptionCaptionML=ENU=Complete Lines,Partial Lines,Complete Order;
                                                   OptionString=Complete Lines,Partial Lines,Complete Order;
                                                   Description=DW 4/18 }
    { 50009;  ;Pkg Qty. to Ship    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Package Qty. to Ship" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.)));
                                                   Description=Editable=No }
    { 50010;  ;Qty. To Ship        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Qty. to Ship" WHERE (Document Type=FIELD(Document Type),
                                                                                                      Document No.=FIELD(No.),
                                                                                                      Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                                      Type=CONST(Item),
                                                                                                      Shipment Date=FIELD(FILTER(Date Filter)),
                                                                                                      Location Code=FIELD(FILTER(Location Filter))));
                                                   Description=RT005;
                                                   Editable=No }
    { 50011;  ;Outstanding Quantity;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Quantity" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.),
                                                                                                              Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                                                                                              Type=CONST(Item),
                                                                                                              Location Code=FIELD(FILTER(Location Filter)),
                                                                                                              Shipment Date=FIELD(FILTER(Date Filter))));
                                                   Description=RT005;
                                                   Editable=No }
    { 50012;  ;Order Value         ;Decimal       ;Description=RT005;
                                                   Editable=No }
    { 50014;  ;Fulfillment Planning Status;Option ;OptionString=Not Assigned,Failed,Succeeded;
                                                   Description=DWBLM,T388;
                                                   Editable=No }
    { 50016;  ;Backorder Allowed   ;Text2         ;Description=DWEDI }
    { 50017;  ;Next Line Ship Date ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Min("Sales Line"."Shipment Date" WHERE (Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Type=CONST(Item),
                                                                                                       Location Code=FIELD(FILTER(Location Filter)),
                                                                                                       Outstanding Quantity=FILTER(<>0)));
                                                   Description=DWWHS;
                                                   Editable=No }
    { 50018;  ;Re-opened           ;Boolean       ;Description=DWEDI }
    { 50019;  ;PO Ack. Sent        ;DateTime      ;Description=DWEDI }
    { 50020;  ;On-Hand Status      ;Text20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Location Sales Order"."On Hand Status" WHERE (Order No.=FIELD(No.),
                                                                                                                     Location Code=FIELD(FILTER(Location Filter))));
                                                   OnValidate=VAR
                                                                EDIDropShipTradePartner@1000000000 : Record 50024;
                                                              BEGIN
                                                              END;

                                                   Description=DWEDI;
                                                   Editable=No }
    { 50021;  ;Days to Ship        ;Option        ;OptionString=Default,1 Day,2 Day,3 Day,per EDI,Same Day;
                                                   Description=DW 6/13;
                                                   Editable=No }
    { 50022;  ;Order Time          ;Time          ;Description=DW 6/13 }
    { 50023;  ;Fully Packed Date   ;Date          ;Description=DW 8/13 }
    { 50024;  ;Days Shipped        ;Integer       ;Description=DW 12/13 }
    { 50025;  ;Credit Reversal     ;Boolean       ;Description=DW 12/13 }
    { 50026;  ;Delete CC After Invoice;Boolean    ;Description=DW 10/14 }
    { 50027;  ;Deliver-to Shipping Agent;Code10   ;TableRelation="Shipping Agent";
                                                   Description=DW 11/14 }
    { 50030;  ;Total Weight        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Extended Weight" WHERE (Document Type=FIELD(Document Type),
                                                                                                         Document No.=FIELD(No.),
                                                                                                         Type=FILTER(Item)));
                                                   Description=DW101 RDA 09/01/10 }
    { 50031;  ;Total Cube          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Extended Cube" WHERE (Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Type=FILTER(Item)));
                                                   Description=DW101 RDA 09/01/10 }
    { 50032;  ;Total Cu. Ft.       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Cu. Ft." WHERE (Document Type=FIELD(Document Type),
                                                                                                 Document No.=FIELD(No.),
                                                                                                 Type=FILTER(Item)));
                                                   Description=DW101 RDA 10/03/10 }
    { 50033;  ;Liftgate            ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open); // DW 12/13
                                                                CheckFreightQuote;  //B2C02
                                                              END;

                                                   Description=S }
    { 50034;  ;Limited Access      ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open); // DW 12/13
                                                                CheckFreightQuote;  //B2C02
                                                              END;

                                                   Description=S }
    { 50035;  ;Inside Delivery     ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open); // DW 12/13
                                                              END;

                                                   Description=S }
    { 50036;  ;Call Ahead          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open); // DW 12/13
                                                              END;

                                                   Description=S }
    { 50037;  ;Return Receipt Option;Option       ;OptionCaptionML=ENU=" ,Receipt Only,Signature,Adult Signature";
                                                   OptionString=[ ,Receipt Only,Signature,Adult Signature];
                                                   Description=DWWEB }
    { 50038;  ;Signature Required  ;Boolean       ;OnValidate=BEGIN

                                                                CheckFreightQuote;  //B2C02
                                                              END;

                                                   Description=S }
    { 50039;  ;Packing Rule Code   ;Code10        ;TableRelation="Packing Rule";
                                                   OnValidate=BEGIN
                                                                SetPackRuleShipping(FIELDNO("Packing Rule Code")); // DWPR
                                                              END;

                                                   Description=DW0217 }
    { 50040;  ;Web Import          ;Boolean       ;Description=DWWEB }
    { 50041;  ;RTV Import          ;Boolean       ;Description=DWRTV }
    { 50042;  ;FTP Import          ;Boolean        }
    { 50043;  ;EDI Warehouse Code  ;Code10        ;Description=DW0518 }
    { 50045;  ;Date Received       ;Date          ;Description= from BizTalk }
    { 50046;  ;Time Received       ;Time          ;Description= from BizTalk }
    { 50060;  ;EDI Shipping Code   ;Code25        ;TableRelation="EDI Shipping Cross Reference"."EDI Trade Partner Ship Code" WHERE (EDI Trade Partner=FIELD(EDI Trade Partner));
                                                   OnValidate=BEGIN
                                                                IF "EDI Shipping Code" <> '' THEN
                                                                  GetEDIShipXref; // DW 7/12
                                                              END;

                                                   Description=RT016 -SLW20150312 expanded for Amazon DS }
    { 50061;  ;EDI Ship Speed Code ;Code10        ;OnValidate=BEGIN
                                                                IF "EDI Ship Speed Code" <> '' THEN
                                                                  GetEDIShipXref; // DW 7/12
                                                              END;

                                                   Description=DW 7/12 }
    { 50062;  ;Do not Ship Before  ;Date          ;CaptionML=ENU=Do not Ship Before;
                                                   Description=DW 5/13,T388 }
    { 50063;  ;EDI Location Code   ;Code10        ;OnValidate=VAR
                                                                EDILocationCodes@1000000000 : Record 50092;
                                                              BEGIN
                                                                //DWSBC 06/19/2018 >>>
                                                                IF ("EDI Location Code" <> '') AND ("EDI Trade Partner" <> '') THEN BEGIN
                                                                  CLEAR(EDILocationCodes);
                                                                  IF EDILocationCodes.GET("EDI Trade Partner","EDI Location Code") THEN
                                                                    "Quick Ship" := EDILocationCodes."Quick Ship"
                                                                  ELSE
                                                                    "Quick Ship" := FALSE;
                                                                END ELSE BEGIN
                                                                  "Quick Ship" := FALSE;
                                                                END;
                                                                //DWSBC 06/19/2018 <<<
                                                              END;

                                                   Description=DW0418 }
    { 50064;  ;Message Texts       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Message Text" WHERE (Order No.=FIELD(No.)));
                                                   OnLookup=VAR
                                                              MT@1000000000 : Record 50040;
                                                            BEGIN
                                                              MT.FILTERGROUP(2);
                                                              MT.SETRANGE("Order No.","No.");
                                                              MT.FILTERGROUP(0);
                                                              IF MT.FINDLAST THEN
                                                                IF MT.BatchDateTime <> 0DT THEN BEGIN
                                                                   MT.SETRANGE(BatchDateTime,MT.BatchDateTime);
                                                                END;
                                                              PAGE.RUNMODAL(PAGE::"Message Text by Batch Date",MT);
                                                            END;

                                                   Description=T388;
                                                   Editable=No }
    { 50065;  ;Ship-Ahead Allowed  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Ship Ahead" WHERE (No.=FIELD(Sell-to Customer No.)));
                                                   Editable=No }
    { 50066;  ;Priority Escalation Date;Date      ;Description=DW0218 }
    { 50067;  ;Warehouse Shipped   ;DateTime      ;Description=DW0218 }
    { 50068;  ;Quick Ship          ;Boolean       ;FieldClass=Normal }
    { 50069;  ;3PL Warehouse       ;Code10        ;TableRelation="3PL Warehouses";
                                                   ValidateTableRelation=Yes }
    { 50070;  ;Moulton Order No.   ;Code8         ;Description=DW SBC 2018-07-20 }
    { 60501;  ;Pick Status         ;Option        ;OptionString=[ ,Pending Pick,In Pick,Packed - Missing Info,Ready to Ship,Shipped,Error in Posting,No Pick];
                                                   Description=PS01 }
    { 60503;  ;Original Order No.  ;Code20        ;Description=PS01 }
    { 60504;  ;Pick Counter        ;Integer       ;Description=PS01;
                                                   Editable=No }
    { 70000;  ;Lines Shipped Not Invoiced;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Line" WHERE (Document Type=CONST(Order),
                                                                                         Document No.=FIELD(No.),
                                                                                         Qty. Shipped Not Invoiced=FILTER(<>0)));
                                                   Description=DS4 Flow field;
                                                   Editable=No }
    { 70001;  ;One-Click Eligible  ;Boolean       ;Description=T335;
                                                   Editable=No }
    { 70003;  ;Routing Request Entry;Integer      ;Description=PS01;
                                                   Editable=No }
    { 70010;  ;Web Order No.       ;Code30        ;Description=DW0118 was Ship Agent Quote No. }
    { 70551;  ;Exclude from Usage  ;Boolean       ;OnValidate=BEGIN
                                                                // UBP
                                                                SalesLine.RESET;
                                                                SalesLine.SETRANGE("Document Type","Document Type");
                                                                SalesLine.SETRANGE("Document No.","No.");
                                                                SalesLine.MODIFYALL("Exclude from Usage","Exclude from Usage");
                                                                // UBP
                                                              END;

                                                   CaptionML=ENU=Exclude from Usage }
    { 70570;  ;Days to Fulfill     ;Integer       ;Description=//PS01 }
    { 14000350;;EDI Order          ;Boolean       ;CaptionML=ENU=EDI Order }
    { 14000351;;EDI Internal Doc. No.;Code10      ;TableRelation="E.D.I. Receive Document Hdr.";
                                                   CaptionML=ENU=EDI Internal Doc. No.;
                                                   Editable=No }
    { 14000354;;EDI Ack. Generated ;Boolean       ;CaptionML=ENU=EDI Ack. Generated;
                                                   Editable=No }
    { 14000355;;EDI Ack. Gen. Date ;Date          ;CaptionML=ENU=EDI Ack. Gen. Date;
                                                   Editable=No }
    { 14000360;;EDI Released       ;Boolean       ;CaptionML=ENU=EDI Released }
    { 14000361;;EDI WHSE Shp. Gen  ;Boolean       ;CaptionML=ENU=EDI WHSE Shp. Gen;
                                                   Editable=No }
    { 14000362;;EDI WHSE Shp. Gen Date;Date       ;CaptionML=ENU=EDI WHSE Shp. Gen Date;
                                                   Editable=No }
    { 14000365;;EDI Expected Delivery Date;Date   ;CaptionML=ENU=EDI Expected Delivery Date }
    { 14000366;;EDI Trade Partner  ;Code20        ;OnValidate=VAR
                                                                EDIDropShipTradePartner@1000000000 : Record 50024;
                                                              BEGIN
                                                                EDIIntegration.TradePtnrValidateSalesHdr(Rec);
                                                                MODIFY;

                                                                IF "EDI Trade Partner" <> xRec."EDI Trade Partner" THEN BEGIN
                                                                  VALIDATE("EDI Sell-to Code",'');
                                                                  VALIDATE("EDI Ship-for Code",'');
                                                                  VALIDATE("EDI Ship-to Code",'');
                                                                  "External Sell-to No." := '';
                                                                  "External Ship-to No." := '';
                                                                  "External Ship-for No." := '';

                                                                  //RT012 -BEGIN
                                                                  EDIDropShipTradePartner.RESET;
                                                                  EDIDropShipTradePartner.SETRANGE("EDI Trade Partner",Rec."EDI Trade Partner");
                                                                  EDIDropShipTradePartner.SETRANGE("Dflt. Sales Division",TRUE);
                                                                  IF EDIDropShipTradePartner.FINDFIRST THEN BEGIN
                                                                    VALIDATE("On-Hand Status",EDIDropShipTradePartner."Sales Division");
                                                                  END ELSE BEGIN
                                                                    VALIDATE("On-Hand Status",'');
                                                                  END;
                                                                  //RT012 -END

                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              EDIIntegration.TradePtnrLookupSalesHdr(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Trade Partner }
    { 14000367;;EDI Sell-to Code   ;Code20        ;OnValidate=BEGIN
                                                                EDIIntegration.SellToCodeValidate(Rec);
                                                              END;

                                                   OnLookup=BEGIN
                                                              EDIIntegration.SellToCodeLookup(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Sell-to Code }
    { 14000368;;EDI Ship-to Code   ;Code20        ;OnValidate=BEGIN
                                                                EDIIntegration.ShipToCodeValidate(Rec,CurrFieldNo);
                                                              END;

                                                   OnLookup=BEGIN
                                                              EDIIntegration.ShipToCodeLookup(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Ship-to Code }
    { 14000369;;EDI Ship-for Code  ;Code20        ;OnValidate=BEGIN
                                                                EDIIntegration.ShipForCodeValidate(Rec);
                                                              END;

                                                   OnLookup=BEGIN
                                                              EDIIntegration.ShipForCodeLookup(Rec);
                                                            END;

                                                   CaptionML=ENU=EDI Ship-for Code }
    { 14000370;;Order Status Required;Boolean     ;CaptionML=ENU=Order Status Required }
    { 14000371;;Pricing Discrepancy;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         EDI Price Discrepancy=CONST(Yes)));
                                                   CaptionML=ENU=Pricing Discrepancy;
                                                   Editable=No }
    { 14000372;;EDI Cancel After Date;Date        ;CaptionML=ENU=EDI Cancel After Date }
    { 14000373;;Shipment Release   ;Boolean       ;CaptionML=ENU=Shipment Release }
    { 14000374;;EDI Invoice        ;Boolean       ;CaptionML=ENU=EDI Invoice }
    { 14000375;;EDI Cancellation Request;Boolean  ;CaptionML=ENU=EDI Cancellation Request }
    { 14000376;;EDI Cancellation Date;Date        ;CaptionML=ENU=EDI Cancellation Date;
                                                   Editable=No }
    { 14000379;;EDI Cancellation Advice;Boolean   ;CaptionML=ENU=EDI Cancellation Advice }
    { 14000380;;EDI Cancellation Advice Date;Date ;CaptionML=ENU=EDI Cancellation Advice Date;
                                                   Editable=No }
    { 14000381;;EDI Cancellation Generated;Boolean;CaptionML=ENU=EDI Cancellation Advice Generated;
                                                   Editable=No }
    { 14000382;;EDI Transaction Date;Date         ;CaptionML=ENU=EDI Transaction Date;
                                                   Editable=No }
    { 14000383;;EDI Transaction Time;Time         ;CaptionML=ENU=EDI Transaction Time;
                                                   Editable=No }
    { 14000391;;EDI Response to Request Req.;Boolean;
                                                   CaptionML=ENU=EDI Response to Request Req. }
    { 14000392;;EDI Response Generated;Boolean    ;CaptionML=ENU=EDI Response Generated;
                                                   Editable=No }
    { 14000393;;EDI Response Generated Date;Date  ;CaptionML=ENU=EDI Response Generated Date;
                                                   Editable=No }
    { 14000394;;EDI Quote Change Request;Boolean  ;CaptionML=ENU=EDI Quote Change Request }
    { 14000395;;EDI Quote Change Processed;Boolean;CaptionML=ENU=EDI Quote Change Processed;
                                                   Editable=No }
    { 14000396;;EDI Quote Change ProcessedDate;Date;
                                                   CaptionML=ENU=EDI Quote Change Processed Date;
                                                   Editable=No }
    { 14000601;;Total Qty. Received (base);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Receive Line"."Quantity (Base)" WHERE (Source Type=CONST(36),
                                                                                                           Source Subtype=FIELD(Document Type),
                                                                                                           Source ID=FIELD(No.),
                                                                                                           Type=FILTER('Account (G/L)'..Item),
                                                                                                           Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Qty. Received (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000602;;Total Outstanding Qty. (base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Qty. (Base)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                 Document No.=FIELD(No.),
                                                                                                                 Type=FILTER(Item),
                                                                                                                 Drop Shipment=CONST(No),
                                                                                                                 Pack=CONST(Yes),
                                                                                                                 Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Outstanding Qty. (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000603;;Total Return Qty to Rec (base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Return Qty. to Receive (Base)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                       Document No.=FIELD(No.),
                                                                                                                       Type=FILTER(Item),
                                                                                                                       Drop Shipment=CONST(No),
                                                                                                                       Pack=CONST(Yes),
                                                                                                                       Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Return Qty to Rec (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000604;;Receive Exists     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(Receive WHERE (Source Type=CONST(36),
                                                                                    Source Subtype=FIELD(Document Type),
                                                                                    Source ID=FIELD(No.),
                                                                                    Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Receive Exists;
                                                   Editable=No }
    { 14000701;;E-Ship Agent Service;Code30       ;TableRelation="E-Ship Agent Service".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code),
                                                                                                    World Wide Service=FIELD(World Wide Service));
                                                   OnValidate=BEGIN
                                                                IF "E-Ship Agent Service" <> '' THEN BEGIN
                                                                  TESTFIELD("Shipping Agent Code");
                                                                  ShippingAgent.GET("Shipping Agent Code");
                                                                  EShipAgentService.ValidateEShipAgentService(
                                                                    ShippingAgent,"E-Ship Agent Service","Ship-to Country/Region Code");

                                                                  IF EShipAgentService."Default Shipping Agent Service" <> '' THEN
                                                                    IF "Shipping Agent Service Code" <> EShipAgentService."Default Shipping Agent Service" THEN
                                                                      VALIDATE("Shipping Agent Service Code",EShipAgentService."Default Shipping Agent Service");

                                                                  IF EShipAgentService."Residential Service" THEN
                                                                    "Residential Delivery" := TRUE; // DW 12/13
                                                                END;

                                                                IF ("E-Ship Agent Service" <> xRec."E-Ship Agent Service") AND
                                                                   (CurrFieldNo = FIELDNO("E-Ship Agent Service"))
                                                                THEN BEGIN
                                                                  DeleteShippingAgentOptionPage;

                                                                  Package.RESET;
                                                                  Package.SETCURRENTKEY("Source Type","Source Subtype","Source ID");
                                                                  Package.SETRANGE("Source Type",DATABASE::"Sales Header");
                                                                  Package.SETRANGE("Source Subtype","Document Type");
                                                                  Package.SETRANGE("Source ID","No.");
                                                                  IF Package.FIND('-') THEN
                                                                    MESSAGE(Text14000701);
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Shipping Agent Code");
                                                              ShippingAgent.GET("Shipping Agent Code");
                                                              EShipAgentService.LookupEShipAgentService(
                                                                ShippingAgent,"E-Ship Agent Service","Ship-to Country/Region Code");
                                                              IF PAGE.RUNMODAL(0,EShipAgentService) = ACTION::LookupOK THEN
                                                                VALIDATE("E-Ship Agent Service",EShipAgentService.Code);
                                                            END;

                                                   CaptionML=ENU=E-Ship Agent Service }
    { 14000702;;Total Qty. To Ship (base);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Qty. to Ship (Base)" WHERE (Document Type=FIELD(Document Type),
                                                                                                             Document No.=FIELD(No.),
                                                                                                             Pack=CONST(Yes),
                                                                                                             Location Code=FIELD(Location Filter),
                                                                                                             Drop Shipment=CONST(No)));
                                                   CaptionML=ENU=Total Qty. To Ship (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000703;;Total Qty. Packed (base);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Package Line"."Quantity (Base)" WHERE (Source Type=CONST(36),
                                                                                                           Source Subtype=FIELD(Document Type),
                                                                                                           Source ID=FIELD(No.),
                                                                                                           Type=FILTER('Account (G/L)'..Resource),
                                                                                                           Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Total Qty. Packed (base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000704;;Residential Delivery;Boolean      ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open); // DW 12/13
                                                                CheckFreightQuote;  //B2C02
                                                              END;

                                                   CaptionML=ENU=Residential Delivery }
    { 14000705;;Free Freight       ;Boolean       ;OnValidate=BEGIN

                                                                IF NOT "Free Freight" THEN
                                                                  "No Free Freight Lines on Order" := FALSE;
                                                              END;

                                                   CaptionML=ENU=Free Freight }
    { 14000706;;COD Payment        ;Boolean       ;CaptionML=ENU=COD Payment;
                                                   BlankZero=Yes }
    { 14000709;;World Wide Service ;Boolean       ;CaptionML=ENU=World Wide Service;
                                                   Editable=No }
    { 14000710;;Blind Shipment     ;Boolean       ;OnValidate=BEGIN
                                                                IF "Blind Shipment" THEN
                                                                  "Double Blind Shipment" := FALSE;
                                                              END;

                                                   CaptionML=ENU=Blind Shipment }
    { 14000711;;Double Blind Shipment;Boolean     ;OnValidate=BEGIN
                                                                IF "Double Blind Shipment" THEN
                                                                  "Blind Shipment" := FALSE
                                                                ELSE
                                                                  "Double Blind Ship-from Cust No" := '';
                                                              END;

                                                   CaptionML=ENU=Double Blind Shipment }
    { 14000712;;Double Blind Ship-from Cust No;Code20;
                                                   TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                //RT012 Rem: IF "Double Blind Ship-from Cust No" <> '' THEN
                                                                //RT012 Rem:   TESTFIELD("Double Blind Shipment");

                                                                //RT012 -BEGIN
                                                                IF "Double Blind Ship-from Cust No" <> '' THEN BEGIN
                                                                  "Blind Shipment"        := FALSE;
                                                                  "Double Blind Shipment" := TRUE;
                                                                END ELSE BEGIN
                                                                  "Double Blind Shipment" := FALSE;
                                                                END;
                                                                //RT012 -END
                                                              END;

                                                   CaptionML=ENU=Double Blind Ship-from Cust No }
    { 14000713;;No Free Freight Lines on Order;Boolean;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Free Freight");
                                                              END;

                                                   CaptionML=ENU=No Free Freight Lines on Order }
    { 14000714;;COD Cashiers Check ;Boolean       ;CaptionML=ENU=COD Cashiers Check;
                                                   Editable=No }
    { 14000715;;E-Ship Whse. Outst. Qty (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=FILTER(Pick),
                                                                                                                              Source Type=CONST(37),
                                                                                                                              Source Subtype=FIELD(Document Type),
                                                                                                                              Source No.=FIELD(No.),
                                                                                                                              Action Type=FILTER(' '|Take),
                                                                                                                              Breakbulk No.=FILTER(0),
                                                                                                                              Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Whse. Outst. Qty (Base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000716;;Shipping Payment Type;Option      ;OnValidate=BEGIN
                                                                IF "Shipping Payment Type" = "Shipping Payment Type"::Prepaid THEN
                                                                  VALIDATE("Third Party Ship. Account No.",'')
                                                                ELSE
                                                                  IF ShippingAccount.GetPrimaryShippingAccountNo(
                                                                       "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                       "Sell-to Customer No.","Ship-to Code")
                                                                  THEN
                                                                    VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.")
                                                                  // DW 7/14
                                                                  ELSE
                                                                    IF ShippingAccount.GetShippingAccountNoByLocation(
                                                                       "Shipping Agent Code","Sell-to Customer No.","Ship-to Code","Location Code") THEN
                                                                    VALIDATE("Third Party Ship. Account No.",ShippingAccount."Account No.");

                                                                SetPackRuleShipping(FIELDNO("Shipping Payment Type")); // DWPR
                                                              END;

                                                   CaptionML=ENU=Shipping Payment Type;
                                                   OptionCaptionML=ENU=Prepaid,Third Party,Freight Collect,Consignee;
                                                   OptionString=Prepaid,Third Party,Freight Collect,Consignee }
    { 14000717;;Third Party Ship. Account No.;Code20;
                                                   OnValidate=BEGIN
                                                                IF "Third Party Ship. Account No." <> '' THEN BEGIN
                                                                  ShippingAccount."Shipping Agent Code" := "Shipping Agent Code";
                                                                  ShippingAccount.TestShippingAccountNo("Third Party Ship. Account No.");
                                                                END;

                                                                IF ("Third Party Ship. Account No." <> '') AND
                                                                   ("Shipping Payment Type" <> "Shipping Payment Type"::Prepaid)
                                                                THEN BEGIN
                                                                  CLEAR(ShippingAccount);

                                                                  IF NOT ShippingAccount.GET(
                                                                           ShippingAccount."Ship-to Type"::Customer,
                                                                           "Sell-to Customer No.","Ship-to Code","Shipping Agent Code",
                                                                           "Third Party Ship. Account No.")
                                                                  THEN BEGIN
                                                                    ShippingAccount.RESET;
                                                                    ShippingAccount.SETCURRENTKEY("Shipping Agent Code","Account No.");
                                                                    ShippingAccount.SETRANGE("Shipping Agent Code","Shipping Agent Code");
                                                                    ShippingAccount.SETRANGE("Account No.","Third Party Ship. Account No.");
                                                                    IF NOT ShippingAccount.FIND('-') THEN
                                                                      ;
                                                                  END;

                                                                  IF (ShippingAccount."Account No." <> '') AND
                                                                     ("Shipping Payment Type" <> "Shipping Payment Type"::Prepaid)
                                                                  THEN
                                                                    "Shipping Insurance" := ShippingAccount."Shipping Insurance";
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF ShippingAccount.LookupThirdPartyAccountNo(
                                                                   "Shipping Agent Code",ShippingAccount."Ship-to Type"::Customer,
                                                                   "Sell-to Customer No.","Ship-to Code")
                                                              THEN
                                                                VALIDATE("Third Party Ship. Account No.",ShippingAccount.GetLookupAccountNo);
                                                            END;

                                                   CaptionML=ENU=Third Party Ship. Account No. }
    { 14000718;;Shipping Insurance ;Option        ;CaptionML=ENU=Shipping Insurance;
                                                   OptionCaptionML=ENU=" ,Never,Always";
                                                   OptionString=[ ,Never,Always] }
    { 14000719;;E-Ship Whse. Ship. Qty (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. to Ship (Base)" WHERE (Source Type=CONST(37),
                                                                                                                          Source Subtype=FIELD(Document Type),
                                                                                                                          Source No.=FIELD(No.),
                                                                                                                          Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Whse. Ship. Qty (Base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000720;;E-Ship Invt. Outst. Qty (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=FILTER(Invt. Pick),
                                                                                                                              Source Type=CONST(37),
                                                                                                                              Source Subtype=FIELD(Document Type),
                                                                                                                              Source No.=FIELD(No.),
                                                                                                                              Action Type=FILTER(' '|Take),
                                                                                                                              Breakbulk No.=FILTER(0),
                                                                                                                              Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Invt. Outst. Qty (Base);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 14000722;;E-Ship Outst. Lines Exists;Boolean;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Line" WHERE (Document Type=FIELD(Document Type),
                                                                                         Document No.=FIELD(No.),
                                                                                         No.=FILTER(<>''),
                                                                                         Outstanding Quantity=FILTER(<>0),
                                                                                         Pack=CONST(Yes),
                                                                                         Drop Shipment=CONST(No),
                                                                                         Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=E-Ship Outst. Lines Exists;
                                                   Editable=No }
    { 14000723;;Exists on Bill of Lading;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Bill of Lading Line" WHERE (Type=CONST(Order),
                                                                                                  No.=FIELD(No.),
                                                                                                  Closed=CONST(No),
                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                  Source Type=CONST(36),
                                                                                                  Source Subtype=FIELD(Document Type),
                                                                                                  Source ID=FIELD(No.)));
                                                   CaptionML=ENU=Exists on Bill of Lading;
                                                   Editable=No }
    { 14000724;;Package Exists     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(Package WHERE (Source Type=CONST(36),
                                                                                    Source Subtype=FIELD(Document Type),
                                                                                    Source ID=FIELD(No.),
                                                                                    Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Package Exists;
                                                   Editable=No }
    { 14000725;;Warehouse Shipment Exists;Boolean ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Warehouse Shipment Line" WHERE (Source Type=FILTER(37),
                                                                                                      Source Subtype=FIELD(Document Type),
                                                                                                      Source No.=FIELD(No.),
                                                                                                      Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Warehouse Shipment Exists;
                                                   Editable=No }
    { 14000726;;Inventory Pick Exists;Boolean     ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Warehouse Activity Line" WHERE (Activity Type=CONST(Invt. Pick),
                                                                                                      Source Type=FILTER(37|25000),
                                                                                                      Source Subtype=FIELD(Document Type),
                                                                                                      Source No.=FIELD(No.),
                                                                                                      Location Code=FIELD(Location Filter)));
                                                   CaptionML=ENU=Inventory Pick Exists;
                                                   Editable=No }
    { 14000825;;Ship-for Code      ;Code20        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=BEGIN
                                                                IF "Ship-for Code" <> '' THEN BEGIN
                                                                  ShipToAddr.GET("Sell-to Customer No.","Ship-for Code");
                                                                  "External Ship-for No." := ShipToAddr."External No.";
                                                                  IF ShipToAddr."Dist. Center Ship-to Code" <> '' THEN
                                                                    VALIDATE("Ship-to Code",ShipToAddr."Dist. Center Ship-to Code")
                                                                  ELSE
                                                                    VALIDATE("Ship-to Code","Ship-for Code");
                                                                END ELSE
                                                                  "External Ship-for No." := '';
                                                              END;

                                                   CaptionML=ENU=Ship-for Code }
    { 14000826;;External Sell-to No.;Code20       ;CaptionML=ENU=External Sell-to No. }
    { 14000827;;External Ship-to No.;Code20       ;CaptionML=ENU=External Ship-to No. }
    { 14000828;;External Ship-for No.;Code20      ;CaptionML=ENU=External Ship-for No. }
    { 14000829;;Invoice for Bill of Lading No.;Code20;
                                                   TableRelation="Bill of Lading";
                                                   CaptionML=ENU=Invoice for Bill of Lading No. }
    { 14000831;;Invoice for Shipment No.;Code20   ;TableRelation="Sales Shipment Header".No. WHERE (Order No.=FIELD(No.),
                                                                                                    Shipment Invoice No.=FILTER(''));
                                                   OnValidate=VAR
                                                                Shipping@14000700 : Codeunit 14000701;
                                                              BEGIN
                                                                IF "Invoice for Shipment No." <> '' THEN BEGIN
                                                                  TESTFIELD("Shipment Invoice Override",FALSE);

                                                                  SalesShptHeader.GET("Invoice for Shipment No.");
                                                                  SalesShptHeader.TESTFIELD("Shipment Invoice No.",'');

                                                                  IF SalesShptHeader."Bill of Lading No." <> '' THEN
                                                                    VALIDATE("Invoice for Bill of Lading No.",SalesShptHeader."Bill of Lading No.");

                                                                  Shipping.SetShipmentInvoiceQty(Rec);
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Invoice for Shipment No. }
    { 14000832;;Shipment Invoice Override;Boolean ;OnValidate=BEGIN
                                                                IF "Shipment Invoice Override" THEN
                                                                  TESTFIELD("Invoice for Shipment No.",'');
                                                              END;

                                                   CaptionML=ENU=Shipment Invoice Override }
    { 14000901;;E-Mail Confirmation Handled;Boolean;
                                                   CaptionML=ENU=E-Mail Confirmation Handled }
    { 37028300;;Net Amount Authorized (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Authorize|Return Authorize|Voice Authorize),
                                                                                                                            Transaction Status=CONST(Approved),
                                                                                                                            Authorization Expiration Date=FIELD(Expiration Filter)));
                                                   CaptionML=[ENU=Net Amount Authorized ($);
                                                              FRC=Montant net autoris‚ ($);
                                                              ENC=Net Amount Authorized ($)];
                                                   Editable=No }
    { 37028303;;Expiration Filter  ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Expiration Filter;
                                                              FRC=Filtre par expiration;
                                                              ENC=Expiration Filter];
                                                   Editable=No }
    { 37028305;;Net Amt. to Auth.-Sale (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Unposted Document Type=FIELD(Document Type),
                                                                                                                            Unposted Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Authorize|Return Authorize|Voice Authorize),
                                                                                                                            Transaction Status=CONST(Queued)));
                                                   CaptionML=[ENU=Net Amt. to Auth.-Sale ($);
                                                              FRC=Mont. net … aut. - Vente ($);
                                                              ENC=Net Amt. to Auth.-Sale ($)];
                                                   Editable=No }
    { 37028306;;Net Amt. Authorized-Sale (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Unposted Document Type=FIELD(Document Type),
                                                                                                                            Unposted Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Authorize|Return Authorize|Voice Authorize),
                                                                                                                            Transaction Status=CONST(Approved),
                                                                                                                            Authorization Expiration Date=FIELD(Expiration Filter)));
                                                   CaptionML=[ENU=Net Amt. Authorized-Sale ($);
                                                              FRC=Mont. net aut. - Vente ($);
                                                              ENC=Net Amt. Authorized-Sale ($)];
                                                   Editable=No }
    { 37028311;;Net Amt. Auth. On Hold (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Authorize|Return Authorize|Voice Authorize),
                                                                                                                            Authorization Expiration Date=FIELD(Expiration Filter),
                                                                                                                            Transaction Status=CONST(Hold)));
                                                   CaptionML=[ENU=Net Amt. Auth. On Hold (LCY);
                                                              FRC=Montant net … autoriser en attente ($);
                                                              ENC=Net Amt. Auth. On Hold (LCY)];
                                                   Editable=No }
    { 37028312;;Net Amount to Authorize (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Authorize|Reverse|Return Authorize|Voice Authorize),
                                                                                                                            Transaction Status=CONST(Queued)));
                                                   CaptionML=[ENU=Net Amount to Authorize ($);
                                                              FRC=Montant net … autoriser ($);
                                                              ENC=Net Amount to Authorize ($)];
                                                   Editable=No }
    { 37028314;;Net Amt. to Settle-Sale (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Unposted Document Type=FIELD(Document Type),
                                                                                                                            Unposted Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Charge|Settle|Capture|Refund|Credit|Return Settle),
                                                                                                                            Transaction Status=FILTER(Queued|Batched)));
                                                   CaptionML=[ENU=Net Amt. to Settle-Sale ($);
                                                              FRC=Mont. net … r‚gler - Vente ($);
                                                              ENC=Net Amt. to Settle-Sale ($)];
                                                   Editable=No }
    { 37028315;;Net Amount to Settle (LCY);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Charge|Settle|Capture|Refund|Credit|Return Settle),
                                                                                                                            Transaction Status=FILTER(Queued|Batched)));
                                                   CaptionML=[ENU=Net Amount to Settle ($);
                                                              FRC=Montant net … r‚gler ($);
                                                              ENC=Net Amount to Settle ($)];
                                                   Editable=No }
    { 37028316;;Net Amount Settled (LCY);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Charge|Settle|Capture|Refund|Credit|Return Settle),
                                                                                                                            Transaction Status=CONST(Approved)));
                                                   CaptionML=[ENU=Net Amount Settled ($);
                                                              FRC=Montant net r‚gl‚ ($);
                                                              ENC=Net Amount Settled ($)];
                                                   Editable=No }
    { 37028317;;Net Amount Settled-Sale (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Signed Transaction Amt. (LCY)" WHERE (Unposted Document Type=FIELD(Document Type),
                                                                                                                            Unposted Document No.=FIELD(No.),
                                                                                                                            Method Type=FILTER(Charge|Settle|Capture|Refund|Credit|Return Settle),
                                                                                                                            Transaction Status=CONST(Approved)));
                                                   CaptionML=[ENU=Net Amount Settled-Sale ($);
                                                              FRC=Montant net r‚gl‚ - Vente ($);
                                                              ENC=Net Amount Settled-Sale ($)];
                                                   Editable=No }
    { 37028318;;Amount Paid (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("EFT Transaction"."Transaction Amount (LCY)" WHERE (Unposted Document Type=FIELD(Document Type),
                                                                                                                       Unposted Document No.=FIELD(No.),
                                                                                                                       Method Type=FILTER(Charge|Settle|Capture|Refund|Credit|Return Settle|Authorize|Return Authorize|Voice Authorize),
                                                                                                                       Transaction Status=FILTER(Queued|Batched|Approved)));
                                                   CaptionML=ENU=Amount Paid (LCY);
                                                   Editable=No }
    { 37028320;;Sell-to Phone No.  ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Sell-to Phone No.;
                                                              FRC=Nø de t‚l‚phone de l'acheteur;
                                                              ENC=Sell-to Phone No.] }
    { 37028321;;Bill-to Phone No.  ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              FRC=Nø de t‚l‚phone;
                                                              ENC=Phone No.] }
    { 37028322;;Ship-to Phone No.  ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone No.;
                                                              FRC=Nø de t‚l‚phone de livraison;
                                                              ENC=Ship-to Phone No.] }
    { 37028323;;Bill-to Federal ID No.;Text30     ;CaptionML=[ENU=Bill-to Federal ID No.;
                                                              FRC=Nø ID f‚d‚ral de facturation;
                                                              ENC=Bill-to Federal ID No.] }
    { 37028324;;Bill-to Identification No.;Text30 ;CaptionML=[ENU=Bill-to Identification No.;
                                                              FRC=Nø d'identification de facturation;
                                                              ENC=Bill-to Identification No.] }
    { 37028325;;Bill-to Identification County;Code2;
                                                   CaptionML=[ENU=Bill-to Identification State;
                                                              FRC=tat d'identification de facturation;
                                                              ENC=Bill-to Identification Province] }
    { 37028326;;Account Number     ;Code19        ;CaptionML=[ENU=Account Number;
                                                              FRC=Num‚ro de compte;
                                                              ENC=Account Number] }
    { 37028327;;Expiration Month   ;Code2         ;CaptionML=[ENU=Expiration Month;
                                                              FRC=Mois d'expiration;
                                                              ENC=Expiration Month];
                                                   Numeric=Yes;
                                                   CharAllowed=09 }
    { 37028328;;Expiration Year    ;Code2         ;CaptionML=[ENU=Expiration Year;
                                                              FRC=Ann‚e d'expiration;
                                                              ENC=Expiration Year];
                                                   Numeric=Yes;
                                                   CharAllowed=09 }
    { 37028329;;Routing Number     ;Code10        ;CaptionML=[ENU=Routing Number;
                                                              FRC=Num‚ro de routage;
                                                              ENC=Routing Number] }
    { 37028330;;Check Type         ;Option        ;CaptionML=[ENU=Check Type;
                                                              FRC=Type de chŠque;
                                                              ENC=Cheque Type];
                                                   OptionCaptionML=ENU=" ,Personal,Business";
                                                   OptionString=[ ,Personal,Business];
                                                   Description=Type of Check (e.g., ÃPersonalÄ or ÃBusinessÄ) }
    { 37028331;;Hash               ;Code40        ;CaptionML=[ENU=Hash;
                                                              FRC=Hachage;
                                                              ENC=Hash];
                                                   Editable=No }
    { 37028332;;Card Type          ;Option        ;CaptionML=[ENU=Card Type;
                                                              FRC=Type de carte;
                                                              ENC=Card Type];
                                                   OptionCaptionML=ENU=" ,Business,Commerce,Corporate,Purchasing,Non-Commercial";
                                                   OptionString=[ ,Business,Commerce,Corporate,Purchasing,Non-Commercial] }
    { 37028333;;Account Type       ;Option        ;CaptionML=[ENU=Account Type;
                                                              FRC=Type de compte;
                                                              ENC=Account Type];
                                                   OptionCaptionML=ENU=" ,Visa,MasterCard,American Express,Discover,Diner's Club,JCB Card,Other,Gift Card,EBT,Check,Laser,Maestro,Solo,Switch";
                                                   OptionString=[ ,Visa,MasterCard,American Express,Discover,Diner's Club,JCB Card,Other,Gift Card,EBT,Check,Laser,Maestro,Solo,Switch];
                                                   Editable=No }
    { 37028334;;Issuer Identification Number;Code6;TableRelation="Issuer ID Number";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Issuer Identification Number;
                                                              FRC=Num‚ro d'identification de l'‚metteur;
                                                              ENC=Issuer Identification Number];
                                                   Editable=No }
    { 37028335;;Encryption Salt    ;Code8         ;CaptionML=[ENU=Encryption Salt;
                                                              FRC=Salt de chiffrage;
                                                              ENC=Encryption Salt];
                                                   Editable=No }
    { 37028336;;Protected Account Number;Code50   ;CaptionML=ENU=Protected Account Number;
                                                   Editable=No }
    { 37028337;;EFT Tender Type    ;Option        ;CaptionML=[ENU=EFT Tender Type;
                                                              FRC=Type d'offre EFT;
                                                              ENC=EFT Tender Type];
                                                   OptionCaptionML=ENU=" ,,Check,Credit Card,,,Gift Card";
                                                   OptionString=[ ,,Check,Credit Card,,,Gift Card] }
    { 37028339;;EFT Customer Link Type;Option     ;CaptionML=ENU=EFT Customer Link Type;
                                                   OptionCaptionML=ENU=Customer,Contact;
                                                   OptionString=Customer,Contact }
    { 37028340;;EFT Customer Link No.;Code20      ;TableRelation=IF (EFT Customer Link Type=CONST(Customer)) Customer
                                                                 ELSE IF (EFT Customer Link Type=CONST(Contact)) Contact;
                                                   CaptionML=ENU=EFT Customer Link No.;
                                                   NotBlank=Yes }
    { 37028341;;EFT Customer Link Line No.;Integer;TableRelation=IF (EFT Tender Type=CONST(Check)) "Customer Checking Account"."Line No." WHERE (Link Type=FIELD(EFT Customer Link Type),
                                                                                                                                                 No.=FIELD(EFT Customer Link No.))
                                                                                                                                                 ELSE IF (EFT Tender Type=CONST(Credit Card)) "Customer Credit Card"."Line No." WHERE (Link Type=FIELD(EFT Customer Link Type),
                                                                                                                                                                                                                                       No.=FIELD(EFT Customer Link No.));
                                                   CaptionML=[ENU=EFT Customer Link Line No.;
                                                              FRC=Ligne nø;
                                                              ENC=Line No.] }
    { 37028342;;Account Number Protection Type;Option;
                                                   CaptionML=ENU=Account Number Protection Type;
                                                   OptionCaptionML=ENU=Encryption,Tokenization,Remote Storage;
                                                   OptionString=Encryption,Tokenization,Remote Storage;
                                                   Editable=No }
    { 37028343;;EFT Order ID       ;GUID          ;CaptionML=ENU=EFT Order ID }
    { 37028344;;EFT Store No.      ;Code10        ;TableRelation="EFT Store";
                                                   CaptionML=ENU=EFT Store No. }
    { 37028345;;Electronic Invoice Type;Option    ;CaptionML=ENU=Electronic Invoice Type;
                                                   OptionCaptionML=ENU=None,Electronic,Paper and Electronic,Paper;
                                                   OptionString=None,Electronic,Paper and Electronic,Paper }
    { 37028350;;EFT GUID           ;GUID          ;CaptionML=ENU=EFT GUID }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Document Type,Sell-to Customer No.       }
    {    ;Document Type,Bill-to Customer No.       }
    {    ;Document Type,Combine Shipments,Bill-to Customer No.,Currency Code,EU 3-Party Trade,Dimension Set ID }
    {    ;Sell-to Customer No.,External Document No. }
    {    ;Document Type,Sell-to Contact No.        }
    {    ;Bill-to Contact No.                      }
    {    ;Incoming Document Entry No.              }
    {    ;EDI Order,EDI Trade Partner,EDI Internal Doc. No.;
                                                   KeyGroups=SE-EDI }
    {    ;Document Type,EDI Trade Partner,External Document No.,Sell-to Customer No.,Ship-to Code;
                                                   KeyGroups=SE-EDI }
    {    ;Hash,Bill-to Customer No.               ;KeyGroups=EFT }
    {    ;EFT Tender Type,EFT Customer Link Type,EFT Customer Link No.,EFT Customer Link Line No.;
                                                   KeyGroups=EFT }
    {    ;Document Type,Your Reference            ;KeyGroups=EFT }
    {    ;Sell-to Customer No.,External Document No.,No. }
    {    ;Document Type,Status                     }
    {    ;Document Type,Status,Order Date          }
    {    ;Document Type,Status,Shipment Date       }
    {    ;Document Type,External Document No.      }
    {    ;Shipping Agent Code,Shipment Date        }
    {    ;Original Order No.,Location Code,Pick Status }
    {    ;Original Order No.,Location Code,Pick Counter,Pick Status }
    {    ;Shipment Date                            }
    {    ;One-Click Eligible,Posting Description   }
    {    ;Routing Request Entry                    }
    {    ;Pick Status                              }
    {    ;Priority Escalation Date                 }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;No.,Sell-to Customer Name,Amount,Sell-to Contact,Amount Including VAT }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Do you want to print shipment %1?;ESM=¨Confirma que desea imprimir la remisi¢n %1?;FRC=Voulez-vous imprimer la livraison %1?;ENC=Do you want to print shipment %1?';
      Text001@1001 : TextConst 'ENU=Do you want to print invoice %1?;ESM=¨Confirma que desea imprimir la factura %1?;FRC=Voulez-vous imprimer la facture %1?;ENC=Do you want to print invoice %1?';
      Text002@1002 : TextConst 'ENU=Do you want to print credit memo %1?;ESM=¨Confirma que desea imprimir la nota de cr‚dito %1?;FRC=Voulez-vous imprimer la note de cr‚dit %1?;ENC=Do you want to print credit memo %1?';
      Text003@1003 : TextConst 'ENU=You cannot rename a %1.;ESM=No se puede cambiar el nombre a %1.;FRC=Vous ne pouvez pas renommer un %1.;ENC=You cannot rename a %1.';
      Text004@1004 : TextConst 'ENU=Do you want to change %1?;ESM=¨Confirma que desea cambiar %1?;FRC=D‚sirez-vous modifier %1?;ENC=Do you want to change %1?';
      Text005@1005 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;ESM=No se puede modificar el cliente %1 ya que el documento tiene una o m s l¡neas.;FRC=Impossible de remettre %1 … z‚ro parce que le document a toujours une ou plusieurs lignes.;ENC=You cannot reset %1 because the document still has one or more lines.';
      Text006@1006 : TextConst 'ENU=You cannot change %1 because the order is associated with one or more purchase orders.;ESM=No se puede cambiar %1 porque el pedido est  asociado a pedidos de compra.;FRC=Vous ne pouvez changer %1 parce que la commande est associ‚e … un ou plusieurs bon(s) de commande.;ENC=You cannot change %1 because the order is associated with one or more purchase orders.';
      Text007@1007 : TextConst 'ENU=%1 cannot be greater than %2 in the %3 table.;ESM=En la tabla %3, %1 no puede ser mayor que %2.;FRC=%1 ne peut ˆtre plus grand que %2 dans la table %3.;ENC=%1 cannot be greater than %2 in the %3 table.';
      Text009@1009 : TextConst 'ENU=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de remisiones. Un env¡o dev. vac¡o %1 se crear  para llenar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros livraison. Une livraison vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for shipments. An empty shipment %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text012@1012 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento se provocar  una discontinuidad en la numeraci¢n de la serie de facturas registradas. Se crear  una factura registrada en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des factures report‚es. Une facture report‚e vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for posted invoices. An empty posted invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text014@1014 : TextConst 'ENU=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de notas de cr‚dito registradas. Se crear  un nota cr‚dito regis. en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros d''avoirs report‚s. Un avoir report‚ vide %1 va ˆtre cr‚‚ pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for posted credit memos. An empty posted credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text015@1015 : TextConst 'ENU=If you change %1, the existing sales lines will be deleted and new sales lines based on the new information on the header will be created.\\Do you want to change %1?;ESM=Si cambia %1, se eliminar n las l¡ns. venta actuales y se crear n nuevas l¡ns. venta bas ndose en informaci¢n de la cabecera.\\¨Desea cambiar %1?;FRC=Si vous modifiez %1, les lignes vente existantes seront supprim‚es et de nouvelles lignes vente bas‚es sur les nouvelles informations sur l''en-tˆte seront cr‚‚es.\\Voulez-vous modifier %1ÿ?;ENC=If you change %1, the existing sales lines will be deleted and new sales lines based on the new information on the header will be created.\\Do you want to change %1?';
      Text017@1017 : TextConst 'ENU=You must delete the existing sales lines before you can change %1.;ESM=Se deben eliminar las l¡neas de venta existentes antes de cambiar %1.;FRC=Vous devez supprimer les lignes de ventes existantes avant de pouvoir changer %1.;ENC=You must delete the existing sales lines before you can change %1.';
      Text018@1018 : TextConst 'ENU=You have changed %1 on the sales header, but it has not been changed on the existing sales lines.\;ESM=Se ha modificado %1 en cab. ventas, pero no se ha modificado en las l¡neas de venta.\;FRC=Vous avez chang‚ %1 dans l''en-tˆte des ventes, mais vous ne l''avez pas chang‚ dans les lignes de ventes existantes.\;ENC=You have changed %1 on the sales header, but it has not been changed on the existing sales lines.\';
      Text019@1019 : TextConst 'ENU=You must update the existing sales lines manually.;ESM=Debe actualizar las l¡neas de venta existentes manualmente.;FRC=Vous devez mettre … jour les lignes de ventes existantes manuellement.;ENC=You must update the existing sales lines manually.';
      Text020@1020 : TextConst 'ENU=The change may affect the exchange rate used in the price calculation of the sales lines.;ESM=El cambio puede afectar al tipo de cambio utilizado en el c lculo del precio en las l¡neas de vtas.;FRC=Le taux de change peut affecter le calcul de prix sur les lignes de ventes.;ENC=The change may affect the exchange rate used in the price calculation of the sales lines.';
      Text021@1021 : TextConst 'ENU=Do you want to update the exchange rate?;ESM=¨Confirma que desea modificar el tipo de cambio?;FRC=Voulez-vous mettre … jour le taux de change?;ENC=Do you want to update the exchange rate?';
      Text022@1022 : TextConst 'ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.;ESM=No puede borrar este documento. Su identificaci¢n est  configurada s¢lo para procesar %1 %2.;FRC=Vous ne pouvez pas supprimer ce document. Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.;ENC=You cannot delete this document. Your identification is set up to process from %1 %2 only.';
      Text023@1023 : TextConst 'ENU=Do you want to print return receipt %1?;ESM=¨Confirma que desea imprimir la recep. devol. %1?;FRC=Souhaitez-vous imprimer le document r‚ception retour %1 ?;ENC=Do you want to print return receipt %1?';
      Text024@1024 : TextConst 'ENU=You have modified the %1 field. The recalculation of tax may cause penny differences, so you must check the amounts afterward. Do you want to update the %2 field on the lines to reflect the new value of %1?;ESM=Ha modificado el campo %1. El nuevo c lculo de IVA puede tener alguna diferencia, por lo que deber¡a comprobar los importes. ¨Desea actualizar el campo %2 en la l¡neas para reflejar el nuevo valor de %1?;FRC=Vous avez modifi‚ le champ %1. Le nouveau calcul de la TVA va engendrer de petites diff‚rences. Veuillez v‚rifier les montants. Souhaitez-vous mettre … jour le champ %2 sur les lignes pour refl‚ter la nouvelle valeur de %1ÿ?;ENC=You have modified the %1 field. The recalculation of tax may cause penny differences, so you must check the amounts afterwards. Do you want to update the %2 field on the lines to reflect the new value of %1?';
      Text027@1027 : TextConst 'ENU=Your identification is set up to process from %1 %2 only.;ESM=Su identificaci¢n est  configurada para procesar s¢lo desde %1 %2.;FRC=Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.;ENC=Your identification is set up to process from %1 %2 only.';
      Text028@1028 : TextConst 'ENU=You cannot change the %1 when the %2 has been filled in.;ESM=No puede cambiar %1 despu‚s de introducir datos en %2.;FRC=Vous ne pouvez pas modifier le champ %1 lorsque le champ %2 a ‚t‚ renseign‚.;ENC=You cannot change the %1 when the %2 has been filled in.';
      Text030@1030 : TextConst 'ENU=Deleting this document will cause a gap in the number series for return receipts. An empty return receipt %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Eliminar este documento causar  un error en la serie num‚rica de las recep. devol. Se crear  una recep. devoluc. %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des r‚ceptions retour. Une r‚ception retour vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuerÿ?;ENC=Deleting this document will cause a gap in the number series for return receipts. An empty return receipt %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text031@1031 : TextConst 'ENU=You have modified %1.\\;ESM=Ha modificado %1.\\;FRC=Vous avez modifi‚ le champ %1.\\;ENC=You have modified %1.\\';
      Text032@1032 : TextConst 'ENU=Do you want to update the lines?;ESM=¨Confirma que desea actualizar las l¡neas?;FRC=Souhaitez-vous mettre les lignes … jour ?;ENC=Do you want to update the lines?';
      Text067@2002 : TextConst 'ENU=%1 %4 with amount of %2 has already been authorized on %3 and is not expired yet. You must void the previous authorization before you can re-authorize this %1.;ESM=%1 %4 de importe %2 se autoriz¢ el %3 y todav¡a no expir¢. Para volver a autorizar %1, es necesario anular la autorizaci¢n anterior.;FRC=%1 %4 avec le montant de %2 a d‚j… ‚t‚ autoris‚ sur %3 et n''est pas encore expir‚. Vous devez annuler l''autorisation pr‚c‚dente avant de pouvoir autoriser de nouveau %1.;ENC=%1 %4 with amount of %2 has already been authorized on %3 and is not expired yet. You must void the previous authorization before you can re-authorize this %1.';
      Text068@2003 : TextConst 'ENU=There is nothing to void.;ESM=No hay nada que anular.;FRC=Il n''y a rien … annuler.;ENC=There is nothing to void.';
      Text069@2004 : TextConst 'ENU=The selected operation cannot complete with the specified %1.;ESM=No se puede completar la operaci¢n seleccionada con el valor de %1 especificado.;FRC=Impossible de terminer l''op‚ration s‚lectionn‚e avec le %1 sp‚cifi‚.;ENC=The selected operation cannot complete with the specified %1.';
      SalesSetup@1033 : Record 311;
      GLSetup@1034 : Record 98;
      GLAcc@1035 : Record 15;
      SalesHeader@1036 : Record 36;
      SalesLine@1037 : Record 37;
      CustLedgEntry@1038 : Record 21;
      Cust@1039 : Record 18;
      PaymentTerms@1040 : Record 3;
      PaymentMethod@1041 : Record 289;
      CurrExchRate@1042 : Record 330;
      SalesCommentLine@1043 : Record 44;
      ShipToAddr@1044 : Record 222;
      PostCode@1045 : Record 225;
      BankAcc@1046 : Record 270;
      SalesShptHeader@1047 : Record 110;
      SalesInvHeader@1048 : Record 112;
      SalesCrMemoHeader@1049 : Record 114;
      ReturnRcptHeader@1050 : Record 6660;
      SalesInvHeaderPrepmt@1101 : Record 112;
      SalesCrMemoHeaderPrepmt@1100 : Record 114;
      GenBusPostingGrp@1051 : Record 250;
      GenJnILine@1052 : Record 81;
      RespCenter@1053 : Record 5714;
      InvtSetup@1054 : Record 313;
      Location@1055 : Record 14;
      WhseRequest@1056 : Record 5765;
      ShippingAgentService@1057 : Record 5790;
      TempReqLine@1089 : TEMPORARY Record 246;
      SalesTaxDifference@1020000 : Record 10012;
      ShippingAgent@14000701 : Record 291;
      Package@14000702 : Record 14000701;
      EShipAgentService@14000705 : Record 14000708;
      ShippingAccount@14000706 : Record 14000714;
      ReceiveHeader@14000700 : Record 14000601;
      UserSetupMgt@1058 : Codeunit 5700;
      NoSeriesMgt@1059 : Codeunit 396;
      CustCheckCreditLimit@1060 : Codeunit 312;
      TransferExtendedText@1061 : Codeunit 378;
      GenJnlApply@1062 : Codeunit 225;
      SalesPost@1063 : Codeunit 80;
      CustEntrySetApplID@1064 : Codeunit 101;
      DimMgt@1065 : Codeunit 408;
      ApprovalsMgmt@1082 : Codeunit 1535;
      WhseSourceHeader@1073 : Codeunit 5781;
      ArchiveManagement@1075 : Codeunit 5063;
      SalesLineReserve@1066 : Codeunit 99000832;
      DOPaymentMgt@2000 : Codeunit 825;
      DOPaymentTransLogMgt@2001 : Codeunit 829;
      EDIIntegration@14000351 : Codeunit 14000363;
      RunFromEDI@14000352 : Boolean;
      EDITemp@14000353 : Boolean;
      ApplyCustEntries@1067 : Page 232;
      CurrencyDate@1068 : Date;
      HideValidationDialog@1069 : Boolean;
      Confirmed@1070 : Boolean;
      Text035@1076 : TextConst 'ENU=You cannot Release Quote or Make Order unless you specify a customer on the quote.\\Do you want to create customer(s) now?;ESM=No puede lanzar cotizaci¢n o hacer pedido hasta que especifique un cliente en la cotizaci¢n.\\¨Quiere crear un cliente(s) ahora?;FRC=Vous ne pouvez pas ‚mettre un devis ou cr‚er une commande … moins de sp‚cifier un client sur le devis.\\Souhaitez-vous cr‚er un client maintenant ?;ENC=You cannot Release Quote or Make Order unless you specify a customer on the quote.\\Do you want to create customer(s) now?';
      Text037@1078 : TextConst 'ENU=Contact %1 %2 is not related to customer %3.;ESM=Contacto %1 %2 no est  relacionado con el cliente %3.;FRC=Le contact %1 %2 n''est pas associ‚ au client %3.;ENC=Contact %1 %2 is not related to customer %3.';
      Text038@1074 : TextConst 'ENU=Contact %1 %2 is related to a different company than customer %3.;ESM=Contacto %1 %2 est  relacionado con una empresa diferente al cliente %3.;FRC=Le contact %1 %2 est associ‚ … une compagnie diff‚rente de celle du client %3.;ENC=Contact %1 %2 is related to a different company than customer %3.';
      Text039@1086 : TextConst 'ENU=Contact %1 %2 is not related to a customer.;ESM=Contacto %1 %2 no est  relacionado con un cliente.;FRC=Le contact %1 %2 n''est pas associ‚ … un client.;ENC=Contact %1 %2 is not related to a customer.';
      ReservEntry@1079 : Record 337;
      TempReservEntry@1080 : TEMPORARY Record 337;
      Text040@1083 : TextConst 'ENU=A won opportunity is linked to this order.\It has to be changed to status Lost before the Order can be deleted.\Do you want to change the status for this opportunity now?;ESM=Una oportunidad ganada est  vinculada a este pedido.\Antes de poder eliminar el pedido, debe cambiar el estado a Perdida.\¨Desea cambiar el estado para esta oportunidad?;FRC=Une opportunit‚ gagn‚e est associ‚e … cette commande.\L''‚tat doit ˆtre d‚fini sur Perdue pour pouvoir supprimer la commande.\Souhaitez-vous modifier l''‚tat de cette opportunit‚ maintenantÿ?;ENC=A won opportunity is linked to this order.\It has to be changed to status Lost before the Order can be deleted.\Do you want to change the status for this opportunity now?';
      Text043@1087 : TextConst 'ENU=Wizard Aborted;ESM=Wizard Abortado;FRC=Assistant interrompu;ENC=Wizard Aborted';
      Text044@1088 : TextConst 'ENU=The status of the opportunity has not been changed. The program has aborted deleting the order.;ESM=No se ha cambiado el estado de la oportunidad. El programa ha anulado la eliminaci¢n del pedido.;FRC=L''‚tat de l''opportunit‚ n''a pas ‚t‚ modifi‚. Le systŠme a abandonn‚ la suppression de la commande.;ENC=The status of the opportunity has not been changed. The program has aborted deleting the order.';
      SkipSellToContact@1016 : Boolean;
      SkipBillToContact@1025 : Boolean;
      Text045@1081 : TextConst 'ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";ESM="No puede cambiar el campo %1 porque %2 %3 tiene %4 = %5 y ya se ha asignado el %6 a %7 %8.";FRC="Vous ne pouvez pas modifier le champ %1, puisque %2 %3 a un %4 = %5 et que le %6 a d‚j… ‚t‚ attribu‚ … %7 %8.";ENC="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8."';
      Text048@1091 : TextConst 'ENU=Sales quote %1 has already been assigned to opportunity %2. Would you like to reassign this quote?;ESM=La cotizaci¢n de ventas %1 ya fue asignada a la oportunidad %2. ¨Desea volver a asignar la cotizaci¢n?;FRC=Le devis %1 a d‚j… ‚t‚ affect‚ … l''opportunit‚ %2. Voulez-vous r‚affecter ce devis?;ENC=Sales quote %1 has already been assigned to opportunity %2. Would you like to reassign this quote?';
      Text049@1092 : TextConst 'ENU=The %1 field cannot be blank because this quote is linked to an opportunity.;ESM=El campo %1 no puede estar vac¡o porque la cotizaci¢n est  asociada a una oportunidad.;FRC=On ne peut pas laisser le champ %1 vide car ce devis est li‚ … une opportunit‚.;ENC=The %1 field cannot be blank because this quote is linked to an opportunity.';
      InsertMode@1093 : Boolean;
      CompanyInfo@1094 : Record 79;
      HideCreditCheckDialogue@1097 : Boolean;
      Text051@1071 : TextConst 'ENU=The sales %1 %2 already exists.;ESM=Ya existen las ventas %1 %2.;FRC=Les ventes %1 %2 existent d‚j….;ENC=The sales %1 %2 already exists.';
      Text052@1098 : TextConst 'ENU=The sales %1 %2 has item tracking. Do you want to delete it anyway?;ESM=El valor %1 %2 de ventas tiene seguimiento de productos. ¨Desea eliminarlo de todas maneras?;FRC=Les ventes %1 %2 comportent des donn‚es de tra‡abilit‚. Voulez-vous les supprimer quand mˆme?;ENC=The sales %1 %2 has item tracking. Do you want to delete it anyway?';
      Text053@1102 : TextConst 'ENU=You must cancel the approval process if you wish to change the %1.;ESM=Debe cancelar el proceso de aprobaci¢n si desea cambiar el %1.;FRC=Vous devez annuler le processus d''approbation si vous voulez changer le %1.;ENC=You must cancel the approval process if you wish to change the %1.';
      Text055@1008 : TextConst 'ENU=Do you want to print prepayment invoice %1?;ESM=¨Desea imprimir la factura anticipo %1?;FRC=Voulez-vous imprimer la facture pour paiement anticip‚ %1?;ENC=Do you want to print prepayment invoice %1?';
      Text054@1010 : TextConst 'ENU=Do you want to print prepayment credit memo %1?;ESM=¨Desea imprimir la nota de cr‚dito anticipo %1?;FRC=Voulez-vous imprimer la note de cr‚dit pour paiement anticip‚ %1?;ENC=Do you want to print prepayment credit memo %1?';
      Text056@1105 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de facturas de anticipo. Se crear  una factura anticipo en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des factures de paiement anticip‚. Une facture de paiement anticip‚ vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuer?;ENC=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text057@1108 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;ESM=Si elimina el documento, se provocar  una discontinuidad en la numeraci¢n de la serie de notas de cr‚dito de anticipo. Se crear  una nota de cr‚dito anticipo en blanco %1 para completar este error en las series num‚ricas.\\¨Desea continuar?;FRC=La suppression de ce document va engendrer un ‚cart dans la s‚rie de num‚ros des notes de cr‚dit de paiement anticip‚. Une note de cr‚dit de paiement anticip‚ vide %1 va ˆtre cr‚‚e pour ‚viter un ‚cart dans la s‚rie de num‚ros.\\Voulez-vous continuer?;ENC=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?';
      Text061@1110 : TextConst 'ENU=%1 is set up to process from %2 %3 only.;ESM=Se ha configurado %1 para procesar s¢lo desde %2 %3.;FRC=Le param‚trage de %1 ne permet de traiter que %2 %3.;ENC=%1 is set up to process from %2 %3 only.';
      Text062@1072 : TextConst 'ENU=You cannot change %1 because the corresponding %2 %3 has been assigned to this %4.;ESM=No puede cambiar %1 porque el %2 %3 correspondiente ha sido asignado a este %4.;FRC=Vous ne pouvez pas modifier %1 car le %2 %3 correspondant a ‚t‚ affect‚ … ce %4.;ENC=You cannot change %1 because the corresponding %2 %3 has been assigned to this %4.';
      Text063@1077 : TextConst 'ENU=Reservations exist for this order. These reservations will be canceled if a date conflict is caused by this change.\\Do you want to continue?;ESM=Existen reservas para este pedido. Dichas reservas se cancelar n si este cambio provoca un conflicto de fechas.\\¨Desea continuar?;FRC=Il existe des r‚servations pour cette commande. Ces r‚servations seront annul‚es si cette modification entraŒne un conflit de dates.\\Voulez-vous continuerÿ?;ENC=Reservations exist for this order. These reservations will be cancelled if a date conflict is caused by this change.\\Do you want to continue?';
      Text064@1090 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;ESM=Puede que haya cambiado una dimensi¢n.\\¨Desea actualizar las l¡neas?;FRC=Vous avez probablement modifi‚ une dimension.\\Souhaitez-vous mettre … jour les lignesÿ?;ENC=You may have changed a dimension.\\Do you want to update the lines?';
      UpdateDocumentDate@1120 : Boolean;
      Text066@1095 : TextConst 'ENU=You cannot change %1 to %2 because an open inventory pick on the %3.;ESM=No puede cambiar %1 a %2 debido a un picking de inventario abierto en %3.;FRC=Vous ne pouvez pas modifier %1 en %2 car un pr‚lŠvement inventaire est ouvert sur %3.;ENC=You cannot change %1 to %2 because an open inventory pick on the %3.';
      Text070@1096 : TextConst 'ENU=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.;ESM=No puede cambiar %1 a %2 debido a que existe un env¡o de almac‚n abierto para %3.;FRC=Vous ne pouvez pas modifier %1 en %2 car il existe une livraison entrep“t ouverte pour %3.;ENC=You cannot change %1  to %2 because an open warehouse shipment exists for the %3.';
      BilltoCustomerNoChanged@1121 : Boolean;
      Text071@1011 : TextConst 'ENU=There are unpaid prepayment invoices that are related to the document of type %1 with the number %2.;ESM=Hay facturas de anticipo sin pagar relacionadas con el documento de tipo %1 con el n£mero %2.;FRC=Il existe des factures de paiement anticip‚ impay‚es li‚es au document de type %1 portant le num‚ro %2.;ENC=There are unpaid prepayment invoices that are related to the document of type %1 with the number %2.';
      Text072@1013 : TextConst 'ENU=There are unpaid prepayment invoices related to the document of type %1 with the number %2.;ESM=Hay facturas anticipo sin pagar relacionadas con el documento de tipo %1 con el n£mero %2.;FRC=Il existe des factures de paiement anticip‚ impay‚es li‚es au document de type %1 portant le num‚ro %2.;ENC=There are unpaid prepayment invoices related to the document of type %1 with the number %2.';
      DeferralLineQst@1144 : TextConst 'ENU=Do you want to update the deferral schedules for the lines?;ESM=¨Desea actualizar las previsiones de fraccionamiento para las l¡neas?;FRC=Souhaitez-vous mettre … jour les tableaux ‚chelonnement pour les lignes?;ENC=Do you want to update the deferral schedules for the lines?';
      PrepmtIncludeTaxErr@1020001 : TextConst '@@@=%1 is the feildname Prepmt. Include Tax;ENU=You cannot select the %1 field for foreign currencies.;ESM=No puede seleccionar el campo %1 para monedas extranjeras.;FRC=Vous ne pouvez pas s‚lectionner le champ %1 pour des devises ‚trangŠres.;ENC=You cannot select the %1 field for foreign currencies.';
      PrepmtInvoiceExistsErr@1020002 : TextConst 'ENU=You cannot change %1 because there is a posted Prepayment Invoice.;ESM=No puede cambiar el valor de %1 porque hay una factura de anticipo registrada.;FRC=Vous ne pouvez pas modifier %1 parce qu''une facture pour paiement anticip‚ est report‚e.;ENC=You cannot change %1 because there is a posted Prepayment Invoice.';
      SynchronizingMsg@1026 : TextConst 'ENU=Synchronizing ...\ from: Sales Header with %1\ to: Assembly Header with %2.;ESM=Sincronizando...\ desde: encabezado de ventas con %1\ hasta: encabezado de ensamblado con %2.;FRC=Synchronisation ...\ deÿ: En-tˆte vente avec %1\ versÿ: En-tˆte assemblage avec %2.;ENC=Synchronizing ...\ from: Sales Header with %1\ to: Assembly Header with %2.';
      ShippingAdviceErr@1029 : TextConst 'ENU=This order must be a complete shipment.;ESM=Este pedido debe ser un env¡o completo.;FRC=Cet ordre doit ˆtre une livraison trait‚e.;ENC=This order must be a complete shipment.';
      Text14000701@14000707 : TextConst 'ENU=Packages already exist for this order.';
      Text14000702@14000708 : TextConst 'ENU=Nothing to Receive';
      Text14000703@14000709 : TextConst 'ENU=Nothing Received';
      Text14000704@14000710 : TextConst 'ENU=Fully Received';
      Text14000705@14000711 : TextConst 'ENU=Overreceived';
      Text14000706@14000712 : TextConst 'ENU=Partially Received';
      Text14000707@14000713 : TextConst 'ENU=Nothing to Ship';
      Text14000708@14000714 : TextConst 'ENU=Nothing Packed';
      Text14000709@14000715 : TextConst 'ENU=Fully Packed';
      Text14000710@14000716 : TextConst 'ENU=Overpacked';
      Text14000711@14000717 : TextConst 'ENU=Partially Packed';
      "//DW"@1000000013 : Integer;
      SlsHdrExt@1000000000 : Record 50004;
      ShipMethod@1000000015 : Record 10;
      CRIDateFunctions@1000000012 : Codeunit 50007;
      RT005Text001@1000000022 : TextConst 'ENU=Order must be released to calculate best location';
      TEXT60000@1000000021 : TextConst 'ENU=Quote Type %1 already exists on %2 No. %3.';
      TEXT60001@1000000020 : TextConst 'ENU=Quote Type must be blank for Document Type - %1.';
      TEXT60002@1000000019 : TextConst 'ENU=Quote %1 is required for processing Inventory Updates to CSN and may NOT be Deleted.';
      "//388"@1000000016 : Integer;
      ECRFulfillment@1000000017 : Codeunit 50046;

    PROCEDURE InitInsert@61();
    VAR
      SlsHdrExt@1000000004 : Record 50004;
    BEGIN
      // 2016 Moved from OnInsert
      SalesSetup.GET;

      // To generate separate no.series for web order //DESSV
      //OR (NOT GUIALLOWED) causing ALL EDI Orders to get WEB No Series.  Must resolve a different way.
      //IF (("Web Order") AND ("Document Type"="Document Type"::Quote)) OR (NOT GUIALLOWED) THEN

      IF "No." = '' THEN BEGIN

        IF "EDI Order" THEN
          IF SalesSetup."EDI Order Nos." <> '' THEN
                "No.":=NoSeriesMgt.GetNextNo(SalesSetup."EDI Order Nos.","Posting Date",TRUE);

        IF "FTP Import" THEN
          IF SalesSetup."FTP Order Nos." <> '' THEN
                "No.":=NoSeriesMgt.GetNextNo(SalesSetup."FTP Order Nos.","Posting Date",TRUE);
        // 
        TestNoSeries;
        NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Posting Date","No.","No. Series");
      END;

      InitRecord;
    END;

    PROCEDURE InitRecord@10();
    BEGIN
      SalesSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
            IF "Document Type" = "Document Type"::Order THEN BEGIN
              NoSeriesMgt.SetDefaultSeries("Prepayment No. Series",SalesSetup."Posted Prepmt. Inv. Nos.");
              NoSeriesMgt.SetDefaultSeries("Prepmt. Cr. Memo No. Series",SalesSetup."Posted Prepmt. Cr. Memo Nos.");
            END;
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (SalesSetup."Invoice Nos." = SalesSetup."Posted Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Invoice Nos.");
            IF SalesSetup."Shipment on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Shipping No. Series",SalesSetup."Posted Shipment Nos.");
          END;
        "Document Type"::"Return Order":
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
            NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (SalesSetup."Credit Memo Nos." = SalesSetup."Posted Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",SalesSetup."Posted Credit Memo Nos.");
            IF SalesSetup."Return Receipt on Credit Memo" THEN
              NoSeriesMgt.SetDefaultSeries("Return Receipt No. Series",SalesSetup."Posted Return Receipt Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote] THEN
        BEGIN
        "Shipment Date" := WORKDATE;
        "Order Date" := WORKDATE;
        VALIDATE("Order Date"); // DW001
      END;
      IF "Document Type" = "Document Type"::"Return Order" THEN
        "Order Date" := WORKDATE;

      IF NOT ("Document Type" IN ["Document Type"::"Blanket Order","Document Type"::Quote]) AND
         ("Posting Date" = 0D)
      THEN
        "Posting Date" := WORKDATE;

      IF SalesSetup."Default Posting Date" = SalesSetup."Default Posting Date"::"No Date" THEN
        "Posting Date" := 0D;

      "Document Date" := WORKDATE;

      VALIDATE("Location Code",UserSetupMgt.GetLocation(0,Cust."Location Code","Responsibility Center"));

      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      Reserve := Reserve::Optional;

      UpdateOutboundWhseHandlingTime;

      "Responsibility Center" := UserSetupMgt.GetRespCenter(0,"Responsibility Center");
    END;

    LOCAL PROCEDURE InitNoSeries@77();
    BEGIN
      IF xRec."Shipping No." <> '' THEN BEGIN
        "Shipping No. Series" := xRec."Shipping No. Series";
        "Shipping No." := xRec."Shipping No.";
      END;
      IF xRec."Posting No." <> '' THEN BEGIN
        "Posting No. Series" := xRec."Posting No. Series";
        "Posting No." := xRec."Posting No.";
      END;
      IF xRec."Return Receipt No." <> '' THEN BEGIN
        "Return Receipt No. Series" := xRec."Return Receipt No. Series";
        "Return Receipt No." := xRec."Return Receipt No.";
      END;
      IF xRec."Prepayment No." <> '' THEN BEGIN
        "Prepayment No. Series" := xRec."Prepayment No. Series";
        "Prepayment No." := xRec."Prepayment No.";
      END;
      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
      END;
    END;

    PROCEDURE AssistEdit@1(OldSalesHeader@1000 : Record 36) : Boolean;
    VAR
      SalesHeader2@1001 : Record 36;
    BEGIN
      WITH SalesHeader DO BEGIN
        COPY(Rec);
        SalesSetup.GET;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldSalesHeader."No. Series","No. Series") THEN BEGIN
          IF ("Sell-to Customer No." = '') AND ("Sell-to Contact No." = '') THEN BEGIN
            HideCreditCheckDialogue := FALSE;
            CheckCreditMaxBeforeInsert;
            HideCreditCheckDialogue := TRUE;
          END;
          NoSeriesMgt.SetSeries("No.");
          IF SalesHeader2.GET("Document Type","No.") THEN
            ERROR(Text051,LOWERCASE(FORMAT("Document Type")),"No.");
          Rec := SalesHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE TestNoSeries@6() : Boolean;
    BEGIN
      SalesSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote:
          SalesSetup.TESTFIELD("Quote Nos.");
        "Document Type"::Order:
          SalesSetup.TESTFIELD("Order Nos.");
        "Document Type"::Invoice:
          BEGIN
            SalesSetup.TESTFIELD("Invoice Nos.");
            SalesSetup.TESTFIELD("Posted Invoice Nos.");
          END;
        "Document Type"::"Return Order":
          SalesSetup.TESTFIELD("Return Order Nos.");
        "Document Type"::"Credit Memo":
          BEGIN
            SalesSetup.TESTFIELD("Credit Memo Nos.");
            SalesSetup.TESTFIELD("Posted Credit Memo Nos.");
          END;
        "Document Type"::"Blanket Order":
          SalesSetup.TESTFIELD("Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@9() : Code[10];
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(SalesSetup."Quote Nos.");
        "Document Type"::Order:
          EXIT(SalesSetup."Order Nos.");
        "Document Type"::Invoice:
          EXIT(SalesSetup."Invoice Nos.");
        "Document Type"::"Return Order":
          EXIT(SalesSetup."Return Order Nos.");
        "Document Type"::"Credit Memo":
          EXIT(SalesSetup."Credit Memo Nos.");
        "Document Type"::"Blanket Order":
          EXIT(SalesSetup."Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@8() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(SalesSetup."Posted Credit Memo Nos.");
      EXIT(SalesSetup."Posted Invoice Nos.");
    END;

    LOCAL PROCEDURE GetPostingPrepaymentNoSeriesCode@59() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(SalesSetup."Posted Prepmt. Cr. Memo Nos.");
      EXIT(SalesSetup."Posted Prepmt. Inv. Nos.");
    END;

    LOCAL PROCEDURE TestNoSeriesDate@40(No@1000 : Code[20];NoSeriesCode@1001 : Code[10];NoCapt@1002 : Text[1024];NoSeriesCapt@1004 : Text[1024]);
    VAR
      NoSeries@1005 : Record 308;
    BEGIN
      IF (No <> '') AND (NoSeriesCode <> '') THEN BEGIN
        NoSeries.GET(NoSeriesCode);
        IF NoSeries."Date Order" THEN
          ERROR(
            Text045,
            FIELDCAPTION("Posting Date"),NoSeriesCapt,NoSeriesCode,
            NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
            NoCapt,No);
      END;
    END;

    PROCEDURE ConfirmDeletion@11() : Boolean;
    BEGIN
      SalesPost.TestDeleteHeader(
        Rec,SalesShptHeader,SalesInvHeader,SalesCrMemoHeader,ReturnRcptHeader,
        SalesInvHeaderPrepmt,SalesCrMemoHeaderPrepmt);
      IF SalesShptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text009,TRUE,
             SalesShptHeader."No.")
        THEN
          EXIT;
      IF SalesInvHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text012,TRUE,
             SalesInvHeader."No.")
        THEN
          EXIT;
      IF SalesCrMemoHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text014,TRUE,
             SalesCrMemoHeader."No.")
        THEN
          EXIT;
      IF ReturnRcptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text030,TRUE,
             ReturnRcptHeader."No.")
        THEN
          EXIT;
      IF "Prepayment No." <> '' THEN
        IF NOT CONFIRM(
             Text056,TRUE,
             SalesInvHeaderPrepmt."No.")
        THEN
          EXIT;
      IF "Prepmt. Cr. Memo No." <> '' THEN
        IF NOT CONFIRM(
             Text057,TRUE,
             SalesCrMemoHeaderPrepmt."No.")
        THEN
          EXIT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetCust@2(CustNo@1000 : Code[20]);
    BEGIN
      IF NOT (("Document Type" = "Document Type"::Quote) AND (CustNo = '')) THEN BEGIN
        IF CustNo <> Cust."No." THEN
          Cust.GET(CustNo);
      END ELSE
        CLEAR(Cust);
    END;

    PROCEDURE SalesLinesExist@3() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE RecreateSalesLines@4(ChangedFieldName@1000 : Text[100]);
    VAR
      SalesLineTmp@1001 : TEMPORARY Record 37;
      ItemChargeAssgntSales@1004 : Record 5809;
      TempItemChargeAssgntSales@1003 : TEMPORARY Record 5809;
      TempInteger@1006 : TEMPORARY Record 2000000026;
      TempATOLink@1009 : TEMPORARY Record 904;
      ATOLink@1010 : Record 904;
      ExtendedTextAdded@1002 : Boolean;
    BEGIN
      // >> EDI
      IF EDITemp THEN
        EXIT;
      // << EDI

      IF SalesLinesExist THEN BEGIN
        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(
              Text015,FALSE,ChangedFieldName);
        IF Confirmed THEN BEGIN
          SalesLine.LOCKTABLE;
          ItemChargeAssgntSales.LOCKTABLE;
          ReservEntry.LOCKTABLE;
          MODIFY;
          SalesLine.RESET;
          SalesLine.SETRANGE("Document Type","Document Type");
          SalesLine.SETRANGE("Document No.","No.");
          IF SalesLine.FINDSET THEN BEGIN
            TempReservEntry.DELETEALL;
            RecreateReservEntryReqLine(SalesLineTmp,TempATOLink,ATOLink);
            ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
            ItemChargeAssgntSales.SETRANGE("Document No.","No.");
            TransferItemChargeAssgntSalesToTemp(ItemChargeAssgntSales,TempItemChargeAssgntSales);
            SalesLine.DELETEALL(TRUE);
            SalesLine.INIT;
            SalesLine."Line No." := 0;
            SalesLineTmp.FINDSET;
            ExtendedTextAdded := FALSE;
            SalesLine.BlockDynamicTracking(TRUE);
            REPEAT
              IF SalesLineTmp."Attached to Line No." = 0 THEN BEGIN
                CreateSalesLine(SalesLineTmp);
                ExtendedTextAdded := FALSE;

                IF SalesLine.Type = SalesLine.Type::Item THEN BEGIN
                  ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type",SalesLineTmp."Document Type");
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.",SalesLineTmp."Document No.");
                  TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.",SalesLineTmp."Line No.");
                  IF TempItemChargeAssgntSales.FINDSET THEN
                    REPEAT
                      IF NOT TempItemChargeAssgntSales.MARK THEN BEGIN
                        TempItemChargeAssgntSales."Applies-to Doc. Line No." := SalesLine."Line No.";
                        TempItemChargeAssgntSales.Description := SalesLine.Description;
                        TempItemChargeAssgntSales.MODIFY;
                        TempItemChargeAssgntSales.MARK(TRUE);
                      END;
                    UNTIL TempItemChargeAssgntSales.NEXT = 0;
                END;
                IF SalesLine.Type = SalesLine.Type::"Charge (Item)" THEN BEGIN
                  TempInteger.INIT;
                  TempInteger.Number := SalesLine."Line No.";
                  TempInteger.INSERT;
                END;
              END ELSE
                IF NOT ExtendedTextAdded THEN BEGIN
                  TransferExtendedText.SalesCheckIfAnyExtText(SalesLine,TRUE);
                  TransferExtendedText.InsertSalesExtText(SalesLine);
                  SalesLine.FINDLAST;
                  ExtendedTextAdded := TRUE;
                END;
              RecreateReservEntry(SalesLineTmp,SalesLine."Line No.",FALSE);
              RecreateReqLine(SalesLineTmp,SalesLine."Line No.",FALSE);
              SynchronizeForReservations(SalesLine,SalesLineTmp);

              IF TempATOLink.AsmExistsForSalesLine(SalesLineTmp) THEN BEGIN
                ATOLink := TempATOLink;
                ATOLink.INSERT;
                SalesLine.AutoAsmToOrder;
                TempATOLink.DELETE;
              END;
            UNTIL SalesLineTmp.NEXT = 0;

            ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
            SalesLineTmp.SETRANGE(Type,SalesLine.Type::"Charge (Item)");
            CreateItemChargeAssgntSales(ItemChargeAssgntSales,TempItemChargeAssgntSales,SalesLineTmp,TempInteger);
            SalesLineTmp.SETRANGE(Type);
            SalesLineTmp.DELETEALL;
            ClearItemAssgntSalesFilter(TempItemChargeAssgntSales);
            TempItemChargeAssgntSales.DELETEALL;
          END;
        END ELSE
          ERROR(
            Text017,ChangedFieldName);
      END;
      SalesLine.BlockDynamicTracking(FALSE);
    END;

    LOCAL PROCEDURE MessageIfSalesLinesExist@5(ChangedFieldName@1000 : Text[100]);
    BEGIN
      // >> EDI
      IF RunFromEDI THEN
        EXIT;
      // << EDI

      IF SalesLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text018 +
          Text019,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE PriceMessageIfSalesLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      // >> EDI
      IF RunFromEDI THEN
        EXIT;
      // << EDI

      IF SalesLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text018 +
          Text020,ChangedFieldName);
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        IF "Posting Date" <> 0D THEN
          CurrencyDate := "Posting Date"
        ELSE
          CurrencyDate := WORKDATE;

        "Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code");
      END ELSE
        "Currency Factor" := 0;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13();
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(Text021,FALSE);
      IF Confirmed THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    LOCAL PROCEDURE UpdateSalesLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      JobTransferLine@1004 : Codeunit 1004;
      Question@1002 : Text[250];
    BEGIN
      IF NOT SalesLinesExist THEN
        EXIT;

      IF AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
            Text031 +
            Text032,ChangedFieldName);
        IF GUIALLOWED THEN
          IF DIALOG.CONFIRM(Question,TRUE) THEN
            CASE ChangedFieldName OF
              FIELDCAPTION("Shipment Date"),
              FIELDCAPTION("Shipping Agent Code"),
              FIELDCAPTION("Shipping Agent Service Code"),
              FIELDCAPTION("Shipping Time"),
              FIELDCAPTION("Requested Delivery Date"),
              FIELDCAPTION("Promised Delivery Date"),
              FIELDCAPTION("Outbound Whse. Handling Time"):
                ConfirmResvDateConflict;
            END
          ELSE
            EXIT;
      END;

      SalesLine.LOCKTABLE;
      MODIFY;

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      IF SalesLine.FINDSET THEN
        REPEAT
          CASE ChangedFieldName OF
            FIELDCAPTION("Shipment Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipment Date","Shipment Date");
            FIELDCAPTION("Currency Factor"):
              IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
                SalesLine.VALIDATE("Unit Price");
                SalesLine.VALIDATE("Unit Cost (LCY)");
                IF SalesLine."Job No." <> '' THEN
                  JobTransferLine.FromSalesHeaderToPlanningLine(SalesLine,"Currency Factor");
              END;
            FIELDCAPTION("Transaction Type"):
              SalesLine.VALIDATE("Transaction Type","Transaction Type");
            FIELDCAPTION("Transport Method"):
              SalesLine.VALIDATE("Transport Method","Transport Method");
            FIELDCAPTION("Exit Point"):
              SalesLine.VALIDATE("Exit Point","Exit Point");
            FIELDCAPTION(Area):
              SalesLine.VALIDATE(Area,Area);
            FIELDCAPTION("Transaction Specification"):
              SalesLine.VALIDATE("Transaction Specification","Transaction Specification");
            FIELDCAPTION("Shipping Agent Code"):
              SalesLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
            FIELDCAPTION("Shipping Agent Service Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
            FIELDCAPTION("Shipping Time"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Shipping Time","Shipping Time");
            FIELDCAPTION("Prepayment %"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Prepayment %","Prepayment %");
            FIELDCAPTION("Requested Delivery Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Requested Delivery Date","Requested Delivery Date");
            FIELDCAPTION("Promised Delivery Date"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Promised Delivery Date","Promised Delivery Date");
            FIELDCAPTION("Outbound Whse. Handling Time"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Outbound Whse. Handling Time","Outbound Whse. Handling Time");
            SalesLine.FIELDCAPTION("Deferral Code"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Deferral Code");
            FIELDCAPTION("Tax Liable"):
              IF SalesLine."No." <> '' THEN
                SalesLine.VALIDATE("Tax Liable","Tax Liable");
          END;
          SalesLineReserve.AssignForPlanning(SalesLine);
          SalesLine.MODIFY(TRUE);
        UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ConfirmResvDateConflict@41();
    VAR
      ResvEngMgt@1000 : Codeunit 99000831;
    BEGIN
      IF ResvEngMgt.ResvExistsForSalesHeader(Rec) THEN
        IF NOT CONFIRM(Text063,FALSE) THEN
          ERROR('');
    END;

    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20];Type5@1008 : Integer;No5@1009 : Code[20]);
    VAR
      SourceCodeSetup@1010 : Record 242;
      TableID@1011 : ARRAY [10] OF Integer;
      No@1012 : ARRAY [10] OF Code[20];
      OldDimSetID@1013 : Integer;
    BEGIN
      // >> EDI
      IF EDITemp THEN
        EXIT;
      // << EDI

      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(TableID,No,SourceCodeSetup.Sales,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      IF (OldDimSetID <> "Dimension Set ID") AND SalesLinesExist THEN BEGIN
        MODIFY;
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1005 : Integer;
    BEGIN
      // >> EDI
      IF EDITemp THEN
        EXIT;
      // << EDI

      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      IF "No." <> '' THEN
        MODIFY;

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ShippedSalesLinesExist@22() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Quantity Shipped",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE ReturnReceiptExist@5800() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Return Qty. Received",'<>0');
      EXIT(SalesLine.FINDFIRST);
    END;

    LOCAL PROCEDURE DeleteSalesLines@20();
    BEGIN
      IF SalesLine.FINDSET THEN BEGIN
        HandleItemTrackingDeletion;
        REPEAT
          SalesLine.SuspendStatusCheck(TRUE);
          SalesLine.DELETE(TRUE);
        UNTIL SalesLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE HandleItemTrackingDeletion@36();
    VAR
      ReservEntry2@1000 : Record 337;
    BEGIN
      WITH ReservEntry DO BEGIN
        RESET;
        SETCURRENTKEY(
          "Source ID","Source Ref. No.","Source Type","Source Subtype",
          "Source Batch Name","Source Prod. Order Line","Reservation Status");
        SETRANGE("Source Type",DATABASE::"Sales Line");
        SETRANGE("Source Subtype","Document Type");
        SETRANGE("Source ID","No.");
        SETRANGE("Source Batch Name",'');
        SETRANGE("Source Prod. Order Line",0);
        SETFILTER("Item Tracking",'> %1',"Item Tracking"::None);
        IF ISEMPTY THEN
          EXIT;

        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed := CONFIRM(Text052,FALSE,LOWERCASE(FORMAT("Document Type")),"No.");

        IF NOT Confirmed THEN
          ERROR('');

        IF FINDSET THEN
          REPEAT
            ReservEntry2 := ReservEntry;
            ReservEntry2.ClearItemTrackingFields;
            ReservEntry2.MODIFY;
          UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ClearItemAssgntSalesFilter@17(VAR TempItemChargeAssgntSales@1000 : Record 5809);
    BEGIN
      TempItemChargeAssgntSales.SETRANGE("Document Line No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.");
      TempItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.");
    END;

    PROCEDURE CheckCustomerCreated@18(Prompt@1000 : Boolean) : Boolean;
    VAR
      Cont@1001 : Record 5050;
    BEGIN
      IF ("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> '') THEN
        EXIT(TRUE);

      IF Prompt THEN
        IF NOT CONFIRM(Text035,TRUE) THEN
          EXIT(FALSE);

      IF "Sell-to Customer No." = '' THEN BEGIN
        TESTFIELD("Sell-to Contact No.");
        TESTFIELD("Sell-to Customer Template Code");
        Cont.GET("Sell-to Contact No.");
        Cont.CreateCustomer("Sell-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      IF "Bill-to Customer No." = '' THEN BEGIN
        TESTFIELD("Bill-to Contact No.");
        TESTFIELD("Bill-to Customer Template Code");
        Cont.GET("Bill-to Contact No.");
        Cont.CreateCustomer("Bill-to Customer Template Code");
        COMMIT;
        GET("Document Type"::Quote,"No.");
      END;

      EXIT(("Bill-to Customer No." <> '') AND ("Sell-to Customer No." <> ''));
    END;

    LOCAL PROCEDURE RecreateReservEntry@21(OldSalesLine@1000 : Record 37;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    BEGIN
      IF ToTemp THEN BEGIN
        CLEAR(ReservEntry);
        ReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        ReservEntry.SETRANGE("Source ID",OldSalesLine."Document No.");
        ReservEntry.SETRANGE("Source Ref. No.",OldSalesLine."Line No.");
        ReservEntry.SETRANGE("Source Type",DATABASE::"Sales Line");
        ReservEntry.SETRANGE("Source Subtype",OldSalesLine."Document Type");
        IF ReservEntry.FINDSET THEN
          REPEAT
            TempReservEntry := ReservEntry;
            TempReservEntry.INSERT;
          UNTIL ReservEntry.NEXT = 0;
        ReservEntry.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReservEntry);
        TempReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        TempReservEntry.SETRANGE("Source Type",DATABASE::"Sales Line");
        TempReservEntry.SETRANGE("Source Subtype",OldSalesLine."Document Type");
        TempReservEntry.SETRANGE("Source ID",OldSalesLine."Document No.");
        TempReservEntry.SETRANGE("Source Ref. No.",OldSalesLine."Line No.");
        IF TempReservEntry.FINDSET THEN
          REPEAT
            ReservEntry := TempReservEntry;
            ReservEntry."Source Ref. No." := NewSourceRefNo;
            ReservEntry.INSERT;
          UNTIL TempReservEntry.NEXT = 0;
        TempReservEntry.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE RecreateReqLine@33(OldSalesLine@1000 : Record 37;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    VAR
      ReqLine@1003 : Record 246;
    BEGIN
      IF ToTemp THEN BEGIN
        ReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        ReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        ReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF ReqLine.FINDSET THEN
          REPEAT
            TempReqLine := ReqLine;
            TempReqLine.INSERT;
          UNTIL ReqLine.NEXT = 0;
        ReqLine.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReqLine);
        TempReqLine.SETCURRENTKEY("Order Promising ID","Order Promising Line ID","Order Promising Line No.");
        TempReqLine.SETRANGE("Order Promising ID",OldSalesLine."Document No.");
        TempReqLine.SETRANGE("Order Promising Line ID",OldSalesLine."Line No.");
        IF TempReqLine.FINDSET THEN
          REPEAT
            ReqLine := TempReqLine;
            ReqLine."Order Promising Line ID" := NewSourceRefNo;
            ReqLine.INSERT;
          UNTIL TempReqLine.NEXT = 0;
        TempReqLine.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE UpdateSellToCont@24(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1004 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        IF Cust."Primary Contact No." <> '' THEN
          "Sell-to Contact No." := Cust."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
          ContBusRel.SETRANGE("No.","Sell-to Customer No.");
          IF ContBusRel.FINDFIRST THEN
            "Sell-to Contact No." := ContBusRel."Contact No."
          ELSE
            "Sell-to Contact No." := '';
        END;
        "Sell-to Contact" := Cust.Contact;
      END;
    END;

    LOCAL PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1001 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        IF Cust."Primary Contact No." <> '' THEN
          "Bill-to Contact No." := Cust."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
          ContBusRel.SETRANGE("No.","Bill-to Customer No.");
          IF ContBusRel.FINDFIRST THEN
            "Bill-to Contact No." := ContBusRel."Contact No."
          ELSE
            "Bill-to Contact No." := '';
        END;
        "Bill-to Contact" := Cust.Contact;
      END;
    END;

    LOCAL PROCEDURE UpdateSellToCust@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Customer@1006 : Record 18;
      Cont@1005 : Record 5050;
      CustTemplate@1004 : Record 5105;
      ContComp@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN
        "Sell-to Contact No." := Cont."No."
      ELSE BEGIN
        "Sell-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Sell-to Customer No." <> '') AND
           ("Sell-to Customer No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Sell-to Customer No.");
        IF "Sell-to Customer No." = '' THEN BEGIN
          SkipSellToContact := TRUE;
          VALIDATE("Sell-to Customer No.",ContBusinessRelation."No.");
          SkipSellToContact := FALSE;
        END;
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          Cont.TESTFIELD("Company No.");
          ContComp.GET(Cont."Company No.");
          "Sell-to Customer Name" := ContComp."Company Name";
          "Sell-to Customer Name 2" := ContComp."Name 2";
          "Ship-to Name" := ContComp."Company Name";
          "Ship-to Name 2" := ContComp."Name 2";
          "Ship-to Address" := ContComp.Address;
          "Ship-to Address 2" := ContComp."Address 2";
          "Ship-to City" := ContComp.City;
          "Ship-to Post Code" := ContComp."Post Code";
          "Ship-to County" := ContComp.County;
          VALIDATE("Ship-to Country/Region Code",ContComp."Country/Region Code");
          IF ("Sell-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Sell-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
      END;

      IF Cont.Type = Cont.Type::Person THEN
        "Sell-to Contact" := Cont.Name
      ELSE
        IF Customer.GET("Sell-to Customer No.") THEN
          "Sell-to Contact" := Customer.Contact
        ELSE
          "Sell-to Contact" := '';

      IF "Document Type" = "Document Type"::Quote THEN BEGIN
        IF Customer.GET("Sell-to Customer No.") OR Customer.GET(ContBusinessRelation."No.") THEN BEGIN
          IF Customer."Copy Sell-to Addr. to Qte From" = Customer."Copy Sell-to Addr. to Qte From"::Company THEN BEGIN
            Cont.TESTFIELD("Company No.");
            Cont.GET(Cont."Company No.");
          END;
        END ELSE BEGIN
          Cont.TESTFIELD("Company No.");
          Cont.GET(Cont."Company No.");
        END;
        "Sell-to Address" := Cont.Address;
        "Sell-to Address 2" := Cont."Address 2";
        "Sell-to City" := Cont.City;
        "Sell-to Post Code" := Cont."Post Code";
        "Sell-to County" := Cont.County;
        "Sell-to Country/Region Code" := Cont."Country/Region Code";
      END;
      IF ("Sell-to Customer No." = "Bill-to Customer No.") OR
         ("Bill-to Customer No." = '')
      THEN
        VALIDATE("Bill-to Contact No.","Sell-to Contact No.");
    END;

    LOCAL PROCEDURE UpdateBillToCust@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Cust@1004 : Record 18;
      Cont@1003 : Record 5050;
      CustTemplate@1002 : Record 5105;
      ContComp@1001 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Bill-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Bill-to Contact" := Cont.Name
        ELSE
          IF Cust.GET("Bill-to Customer No.") THEN
            "Bill-to Contact" := Cust.Contact
          ELSE
            "Bill-to Contact" := '';
      END ELSE BEGIN
        "Bill-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF "Bill-to Customer No." = '' THEN BEGIN
          SkipBillToContact := TRUE;
          VALIDATE("Bill-to Customer No.",ContBusinessRelation."No.");
          SkipBillToContact := FALSE;
          "Bill-to Customer Template Code" := '';
        END ELSE
          IF "Bill-to Customer No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Bill-to Customer No.");
      END ELSE BEGIN
        IF "Document Type" = "Document Type"::Quote THEN BEGIN
          Cont.TESTFIELD("Company No.");
          ContComp.GET(Cont."Company No.");
          "Bill-to Name" := ContComp."Company Name";
          "Bill-to Name 2" := ContComp."Name 2";
          "Bill-to Address" := ContComp.Address;
          "Bill-to Address 2" := ContComp."Address 2";
          "Bill-to City" := ContComp.City;
          "Bill-to Post Code" := ContComp."Post Code";
          "Bill-to County" := ContComp.County;
          "Bill-to Country/Region Code" := ContComp."Country/Region Code";
          "VAT Registration No." := ContComp."VAT Registration No.";
          VALIDATE("Currency Code",ContComp."Currency Code");
          "Language Code" := ContComp."Language Code";
          IF ("Bill-to Customer Template Code" = '') AND (NOT CustTemplate.ISEMPTY) THEN
            VALIDATE("Bill-to Customer Template Code",Cont.FindCustomerTemplate);
        END ELSE
          ERROR(Text039,Cont."No.",Cont.Name);
      END;
    END;

    LOCAL PROCEDURE GetShippingTime@23(CalledByFieldNo@1000 : Integer);
    BEGIN
      IF (CalledByFieldNo <> CurrFieldNo) AND (CurrFieldNo <> 0) THEN
        EXIT;

      IF ShippingAgentService.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
        "Shipping Time" := ShippingAgentService."Shipping Time"
      ELSE BEGIN
        GetCust("Sell-to Customer No.");
        "Shipping Time" := Cust."Shipping Time"
      END;
      IF NOT (CalledByFieldNo IN [FIELDNO("Shipping Agent Code"),FIELDNO("Shipping Agent Service Code")]) THEN
        VALIDATE("Shipping Time");
    END;

    PROCEDURE CheckCreditMaxBeforeInsert@28();
    VAR
      SalesHeader@1001 : Record 36;
      ContBusinessRelation@1002 : Record 5054;
      Cont@1003 : Record 5050;
      CustCheckCreditLimit@1000 : Codeunit 312;
    BEGIN
      IF HideCreditCheckDialogue THEN
        EXIT;
      IF (GetFilterCustNo <> '') OR ("Sell-to Customer No." <> '') THEN BEGIN
        IF "Sell-to Customer No." <> '' THEN
          Cust.GET("Sell-to Customer No.")
        ELSE
          Cust.GET(GetFilterCustNo);
        IF Cust."Bill-to Customer No." <> '' THEN
          SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
        ELSE
          SalesHeader."Bill-to Customer No." := Cust."No.";
        CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
      END ELSE
        IF GetFilterContNo <> '' THEN BEGIN
          Cont.GET(GetFilterContNo);
          ContBusinessRelation.RESET;
          ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
          ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
          ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
          IF ContBusinessRelation.FINDFIRST THEN BEGIN
            Cust.GET(ContBusinessRelation."No.");
            IF Cust."Bill-to Customer No." <> '' THEN
              SalesHeader."Bill-to Customer No." := Cust."Bill-to Customer No."
            ELSE
              SalesHeader."Bill-to Customer No." := Cust."No.";
            CustCheckCreditLimit.SalesHeaderCheck(SalesHeader);
          END;
        END;
    END;

    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record 5765;
    BEGIN
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      CASE "Document Type" OF
        "Document Type"::Order:
          BEGIN
            IF "Shipping Advice" = "Shipping Advice"::Complete THEN
              CheckShippingAdvice;
            WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Order");
          END;
        "Document Type"::"Return Order":
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Sales Return Order");
      END;
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",TRUE,FALSE,WhseRequest);
    END;

    PROCEDURE CreateTodo@30();
    VAR
      TempTodo@1000 : TEMPORARY Record 5080;
    BEGIN
      TESTFIELD("Sell-to Contact No.");
      TempTodo.CreateToDoFromSalesHeader(Rec);
    END;

    LOCAL PROCEDURE UpdateShipToAddress@31();
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          "Ship-to Name" := Location.Name;
          "Ship-to Name 2" := Location."Name 2";
          "Ship-to Address" := Location.Address;
          "Ship-to Address 2" := Location."Address 2";
          "Ship-to City" := Location.City;
          "Ship-to Post Code" := Location."Post Code";
          "Ship-to County" := Location.County;
          "Ship-to Country/Region Code" := Location."Country/Region Code";
          "Ship-to Contact" := Location.Contact;
        END ELSE BEGIN
          CompanyInfo.GET;
          "Ship-to Code" := '';
          "Ship-to Name" := CompanyInfo."Ship-to Name";
          "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
          "Ship-to Address" := CompanyInfo."Ship-to Address";
          "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
          "Ship-to City" := CompanyInfo."Ship-to City";
          "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
          "Ship-to County" := CompanyInfo."Ship-to County";
          "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
          "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        END;
      END;
    END;

    PROCEDURE ShowDocDim@32();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF SalesLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      ATOLink@1003 : Record 904;
      NewDimSetID@1002 : Integer;
      SalesLineOldDimSetID@1020001 : Integer;
    BEGIN
      // Update all lines with changed dimensions.

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT HideValidationDialog AND GUIALLOWED THEN
        IF NOT CONFIRM(Text064) THEN
          EXIT;

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.LOCKTABLE;
      IF SalesLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(SalesLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF SalesLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            SalesLineOldDimSetID := SalesLine."Dimension Set ID";
            SalesLine."Dimension Set ID" := NewDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              SalesLine."Dimension Set ID",SalesLine."Shortcut Dimension 1 Code",SalesLine."Shortcut Dimension 2 Code");
            SalesLine.MODIFY;
            ATOLink.UpdateAsmDimFromSalesLine(SalesLine);
          END;
        UNTIL SalesLine.NEXT = 0;
    END;

    PROCEDURE SetAmountToApply@35(AppliesToDocNo@1000 : Code[20];CustomerNo@1001 : Code[20]);
    VAR
      CustLedgEntry@1002 : Record 21;
    BEGIN
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",AppliesToDocNo);
      CustLedgEntry.SETRANGE("Customer No.",CustomerNo);
      CustLedgEntry.SETRANGE(Open,TRUE);
      IF CustLedgEntry.FINDFIRST THEN BEGIN
        IF CustLedgEntry."Amount to Apply" = 0 THEN  BEGIN
          CustLedgEntry.CALCFIELDS("Remaining Amount");
          CustLedgEntry."Amount to Apply" := CustLedgEntry."Remaining Amount";
        END ELSE
          CustLedgEntry."Amount to Apply" := 0;
        CustLedgEntry."Accepted Payment Tolerance" := 0;
        CustLedgEntry."Accepted Pmt. Disc. Tolerance" := FALSE;
        CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry);
      END;
    END;

    PROCEDURE LookupAdjmtValueEntries@37(QtyType@1000 : 'General,Invoicing');
    VAR
      ItemLedgEntry@1004 : Record 32;
      SalesLine@1001 : Record 37;
      SalesShptLine@1005 : Record 111;
      ReturnRcptLine@1002 : Record 6661;
      TempValueEntry@1003 : TEMPORARY Record 5802;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      TempValueEntry.RESET;
      TempValueEntry.DELETEALL;

      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice:
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH SalesShptLine DO BEGIN
                    IF SalesLine."Shipment No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Shipment No.");
                      SETRANGE("Line No.",SalesLine."Shipment Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Order No.","Order Line No.");
                      SETRANGE("Order No.",SalesLine."Document No.");
                      SETRANGE("Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Qty. Shipped Not Invoiced",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
        "Document Type"::"Return Order","Document Type"::"Credit Memo":
          BEGIN
            IF SalesLine.FINDSET THEN
              REPEAT
                IF (SalesLine.Type = SalesLine.Type::Item) AND (SalesLine.Quantity <> 0) THEN
                  WITH ReturnRcptLine DO BEGIN
                    IF SalesLine."Return Receipt No." <> '' THEN BEGIN
                      SETRANGE("Document No.",SalesLine."Return Receipt No.");
                      SETRANGE("Line No.",SalesLine."Return Receipt Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Return Order No.","Return Order Line No.");
                      SETRANGE("Return Order No.",SalesLine."Document No.");
                      SETRANGE("Return Order Line No.",SalesLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Return Qty. Rcd. Not Invd.",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL SalesLine.NEXT = 0;
          END;
      END;
      PAGE.RUNMODAL(0,TempValueEntry);
    END;

    PROCEDURE GetCustomerVATRegistrationNumber@63() : Text;
    BEGIN
      EXIT("VAT Registration No.");
    END;

    PROCEDURE GetCustomerVATRegistrationNumberLbl@62() : Text;
    BEGIN
      EXIT(FIELDCAPTION("VAT Registration No."));
    END;

    PROCEDURE GetCustomerGlobalLocationNumber@164() : Text;
    BEGIN
      EXIT('');
    END;

    PROCEDURE GetCustomerGlobalLocationNumberLbl@161() : Text;
    BEGIN
      EXIT('');
    END;

    LOCAL PROCEDURE CreateTempAdjmtValueEntries@38(VAR TempValueEntry@1001 : TEMPORARY Record 5802;ItemLedgEntryNo@1000 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      WITH ValueEntry DO BEGIN
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntryNo);
        IF FINDSET THEN
          REPEAT
            IF Adjustment THEN BEGIN
              TempValueEntry := ValueEntry;
              IF TempValueEntry.INSERT THEN;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE GetPstdDocLinesToRevere@39();
    VAR
      SalesPostedDocLines@1000 : Page 5850;
    BEGIN
      GetCust("Sell-to Customer No.");
      SalesPostedDocLines.SetToSalesHeader(Rec);
      SalesPostedDocLines.SETRECORD(Cust);
      SalesPostedDocLines.LOOKUPMODE := TRUE;
      IF SalesPostedDocLines.RUNMODAL = ACTION::LookupOK THEN
        SalesPostedDocLines.CopyLineToDoc;

      CLEAR(SalesPostedDocLines);
    END;

    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      SalesInvDisc@1000 : Codeunit 60;
    BEGIN
      SalesSetup.GET;
      IF SalesSetup."Calc. Inv. Discount" THEN
        SalesInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    PROCEDURE SetSecurityFilterOnRespCenter@43();
    BEGIN
      IF UserSetupMgt.GetSalesFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetSalesFilter);
        FILTERGROUP(0);
      END;

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    PROCEDURE Authorize@50();
    VAR
      DOPaymentTransLogEntry@1001 : Record 829;
    BEGIN
      IF NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code") THEN
        ERROR(Text069,FIELDCAPTION("Payment Method Code"));
      DOPaymentTransLogMgt.FindValidAuthorizationEntry("Document Type","No.",DOPaymentTransLogEntry);
      IF DOPaymentTransLogEntry."Entry No." = DOPaymentMgt.AuthorizeSalesDoc(Rec,0,TRUE) THEN
        ERROR(Text067,
          DOPaymentTransLogEntry."Document Type",
          DOPaymentTransLogEntry.Amount,
          DOPaymentTransLogEntry."Transaction Date-Time",
          DOPaymentTransLogEntry."Document No.");
      "Authorization Required" := TRUE;
      MODIFY;
    END;

    PROCEDURE Void@51();
    VAR
      DOPaymentTransLogEntry@1001 : Record 829;
      DOPaymentTransLogMgt@1002 : Codeunit 829;
    BEGIN
      IF NOT DOPaymentMgt.IsValidPaymentMethod("Payment Method Code") THEN
        ERROR(Text069,FIELDCAPTION("Payment Method Code"));
      CLEAR(DOPaymentMgt);
      DOPaymentMgt.CheckSalesDoc(Rec);
      IF DOPaymentTransLogMgt.FindValidAuthorizationEntry("Document Type","No.",DOPaymentTransLogEntry) THEN
        DOPaymentMgt.VoidSalesDoc(Rec,DOPaymentTransLogEntry)
      ELSE
        MESSAGE(Text068);
      "Authorization Required" := FALSE;
      MODIFY;
    END;

    PROCEDURE GetCreditcardNumber@44() : Text[20];
    VAR
      DOPaymentCreditCard@1001 : Record 827;
    BEGIN
      IF "Credit Card No." = '' THEN
        EXIT('');
      EXIT(DOPaymentCreditCard.GetCreditCardNumber("Credit Card No."));
    END;

    LOCAL PROCEDURE SynchronizeForReservations@42(VAR NewSalesLine@1000 : Record 37;OldSalesLine@1001 : Record 37);
    BEGIN
      NewSalesLine.CALCFIELDS("Reserved Quantity");
      IF NewSalesLine."Reserved Quantity" = 0 THEN
        EXIT;
      IF NewSalesLine."Location Code" <> OldSalesLine."Location Code" THEN
        NewSalesLine.VALIDATE("Location Code",OldSalesLine."Location Code");
      IF NewSalesLine."Bin Code" <> OldSalesLine."Bin Code" THEN
        NewSalesLine.VALIDATE("Bin Code",OldSalesLine."Bin Code");
      IF NewSalesLine.MODIFY THEN;
    END;

    PROCEDURE InventoryPickConflict@46(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1003 : Code[20];ShippingAdvice@1004 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseActivityLine@1000 : Record 5767;
      SalesLine@1001 : Record 37;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseActivityLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.");
      WarehouseActivityLine.SETRANGE("Source Type",DATABASE::"Sales Line");
      WarehouseActivityLine.SETRANGE("Source Subtype",DocType);
      WarehouseActivityLine.SETRANGE("Source No.",DocNo);
      IF WarehouseActivityLine.ISEMPTY THEN
        EXIT(FALSE);
      SalesLine.SETRANGE("Document Type",DocType);
      SalesLine.SETRANGE("Document No.",DocNo);
      SalesLine.SETRANGE(Type,SalesLine.Type::Item);
      IF SalesLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE WhseShpmntConflict@52(DocType@1002 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';DocNo@1001 : Code[20];ShippingAdvice@1000 : 'Partial,Complete') : Boolean;
    VAR
      WarehouseShipmentLine@1003 : Record 7321;
    BEGIN
      IF ShippingAdvice <> ShippingAdvice::Complete THEN
        EXIT(FALSE);
      WarehouseShipmentLine.SETCURRENTKEY("Source Type","Source Subtype","Source No.","Source Line No.");
      WarehouseShipmentLine.SETRANGE("Source Type",DATABASE::"Sales Line");
      WarehouseShipmentLine.SETRANGE("Source Subtype",DocType);
      WarehouseShipmentLine.SETRANGE("Source No.",DocNo);
      IF WarehouseShipmentLine.ISEMPTY THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckCrLimit@47();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader := Rec;
      IF GUIALLOWED AND
         (CurrFieldNo <> 0) AND
         ("Document Type" <= "Document Type"::Invoice) AND
         SalesHeader.FIND
      THEN BEGIN
        "Amount Including VAT" := 0;
        IF "Document Type" = "Document Type"::Order THEN
          IF BilltoCustomerNoChanged THEN BEGIN
            SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
            SalesLine.SETRANGE("Document No.","No.");
            SalesLine.CALCSUMS("Outstanding Amount","Shipped Not Invoiced");
            "Amount Including VAT" := SalesLine."Outstanding Amount" + SalesLine."Shipped Not Invoiced";
          END;
        CustCheckCreditLimit.SalesHeaderCheck(Rec);
        CALCFIELDS("Amount Including VAT");
      END;
    END;

    PROCEDURE QtyToShipIsZero@49() : Boolean;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Qty. to Ship",'<>0');
      EXIT(SalesLine.ISEMPTY);
    END;

    LOCAL PROCEDURE IsApprovedForPosting@53() : Boolean;
    VAR
      PrepaymentMgt@1001 : Codeunit 441;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN BEGIN
        IF PrepaymentMgt.TestSalesPrepayment(Rec) THEN
          ERROR(STRSUBSTNO(Text071,"Document Type","No."));
        IF PrepaymentMgt.TestSalesPayment(Rec) THEN
          ERROR(STRSUBSTNO(Text072,"Document Type","No."));
        EXIT(TRUE);
      END;
    END;

    PROCEDURE IsApprovedForPostingBatch@54() : Boolean;
    VAR
      PrepaymentMgt@1000 : Codeunit 441;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN BEGIN
        IF PrepaymentMgt.TestSalesPrepayment(Rec) THEN
          EXIT(FALSE);
        IF PrepaymentMgt.TestSalesPayment(Rec) THEN
          EXIT(FALSE);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE GetLegalStatement@60() : Text;
    BEGIN
      SalesSetup.GET;
      EXIT(SalesSetup.GetLegalStatement);
    END;

    PROCEDURE SendToPosting@57(PostingCodeunitID@1000 : Integer);
    BEGIN
      IF NOT IsApprovedForPosting THEN
        EXIT;
      CODEUNIT.RUN(PostingCodeunitID,Rec);
    END;

    PROCEDURE CancelBackgroundPosting@48();
    VAR
      SalesPostViaJobQueue@1000 : Codeunit 88;
    BEGIN
      SalesPostViaJobQueue.CancelQueueEntry(Rec);
    END;

    PROCEDURE LinkSalesDocWithOpportunity@79(OldOpportunityNo@1000 : Code[20]);
    VAR
      SalesHeader@1001 : Record 36;
      Opportunity@1002 : Record 5092;
    BEGIN
      IF "Opportunity No." <> OldOpportunityNo THEN BEGIN
        IF "Opportunity No." <> '' THEN
          IF Opportunity.GET("Opportunity No.") THEN BEGIN
            Opportunity.TESTFIELD(Status,Opportunity.Status::"In Progress");
            IF Opportunity."Sales Document No." <> '' THEN BEGIN
              IF CONFIRM(Text048,FALSE,Opportunity."Sales Document No.",Opportunity."No.") THEN BEGIN
                IF SalesHeader.GET("Document Type"::Quote,Opportunity."Sales Document No.") THEN BEGIN
                  SalesHeader."Opportunity No." := '';
                  SalesHeader.MODIFY;
                END;
                UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
              END ELSE
                "Opportunity No." := OldOpportunityNo;
            END ELSE
              UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::Quote,"No.");
          END;
        IF (OldOpportunityNo <> '') AND Opportunity.GET(OldOpportunityNo) THEN
          UpdateOpportunityLink(Opportunity,Opportunity."Sales Document Type"::" ",'');
      END;
    END;

    LOCAL PROCEDURE UpdateOpportunityLink@80(Opportunity@1000 : Record 5092;SalesDocumentType@1001 : Option;SalesHeaderNo@1002 : Code[20]);
    BEGIN
      Opportunity."Sales Document Type" := SalesDocumentType;
      Opportunity."Sales Document No." := SalesHeaderNo;
      Opportunity.MODIFY;
    END;

    LOCAL PROCEDURE IsPrepmtInvoicePosted@1020000() : Boolean;
    VAR
      SalesLine@1020000 : Record 37;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Prepmt. Amt. Inv.",'>0');
      EXIT(NOT SalesLine.ISEMPTY);
    END;

    LOCAL PROCEDURE SynchronizeAsmHeader@56();
    VAR
      AsmHeader@1003 : Record 900;
      ATOLink@1002 : Record 904;
      Window@1000 : Dialog;
    BEGIN
      ATOLink.SETCURRENTKEY(Type,"Document Type","Document No.");
      ATOLink.SETRANGE(Type,ATOLink.Type::Sale);
      ATOLink.SETRANGE("Document Type","Document Type");
      ATOLink.SETRANGE("Document No.","No.");
      IF ATOLink.FINDSET THEN
        REPEAT
          IF AsmHeader.GET(ATOLink."Assembly Document Type",ATOLink."Assembly Document No.") THEN
            IF "Posting Date" <> AsmHeader."Posting Date" THEN BEGIN
              Window.OPEN(STRSUBSTNO(SynchronizingMsg,"No.",AsmHeader."No."));
              AsmHeader.VALIDATE("Posting Date","Posting Date");
              AsmHeader.MODIFY;
              Window.CLOSE;
            END;
        UNTIL ATOLink.NEXT = 0;
    END;

    PROCEDURE CheckShippingAdvice@55();
    VAR
      SalesLine@1000 : Record 37;
      QtyToShipBaseTotal@1002 : Decimal;
      Result@1001 : Boolean;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETRANGE("Drop Shipment",FALSE);
      Result := TRUE;
      IF SalesLine.FINDSET THEN
        REPEAT
          IF SalesLine.IsShipment THEN BEGIN
            QtyToShipBaseTotal += SalesLine."Qty. to Ship (Base)";
            IF SalesLine."Quantity (Base)" <>
               SalesLine."Qty. to Ship (Base)" + SalesLine."Qty. Shipped (Base)"
            THEN
              Result := FALSE;
          END;
        UNTIL SalesLine.NEXT = 0;
      IF QtyToShipBaseTotal = 0 THEN
        Result := TRUE;
      IF NOT Result THEN
        ERROR(ShippingAdviceErr);
    END;

    LOCAL PROCEDURE GetFilterCustNo@64() : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Customer No.") <> '' THEN
        IF GETRANGEMIN("Sell-to Customer No.") = GETRANGEMAX("Sell-to Customer No.") THEN
          EXIT(GETRANGEMAX("Sell-to Customer No."));
    END;

    LOCAL PROCEDURE GetFilterContNo@65() : Code[20];
    BEGIN
      IF GETFILTER("Sell-to Contact No.") <> '' THEN
        IF GETRANGEMIN("Sell-to Contact No.") = GETRANGEMAX("Sell-to Contact No.") THEN
          EXIT(GETRANGEMAX("Sell-to Contact No."));
    END;

    LOCAL PROCEDURE CheckCreditLimitIfLineNotInsertedYet@66();
    BEGIN
      IF "No." = '' THEN BEGIN
        HideCreditCheckDialogue := FALSE;
        HideCreditCheckDialogue := HideValidationDialog; // DW0617
        CheckCreditMaxBeforeInsert;
        HideCreditCheckDialogue := TRUE;
        InitInsert;
      END;
    END;

    PROCEDURE InvoicedLineExists@156() : Boolean;
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER(Type,'<>%1',SalesLine.Type::" ");
      SalesLine.SETFILTER("Quantity Invoiced",'<>%1',0);
      EXIT(NOT SalesLine.ISEMPTY);
    END;

    PROCEDURE CreateDimSetForPrepmtAccDefaultDim@73();
    VAR
      SalesLine@1000 : Record 37;
      TempSalesLine@1003 : TEMPORARY Record 37;
    BEGIN
      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","No.");
      SalesLine.SETFILTER("Prepmt. Amt. Inv.",'<>%1',0);
      IF SalesLine.FINDSET THEN
        REPEAT
          CollectParamsInBufferForCreateDimSet(TempSalesLine,SalesLine);
        UNTIL SalesLine.NEXT = 0;
      TempSalesLine.RESET;
      TempSalesLine.MARKEDONLY(FALSE);
      IF TempSalesLine.FINDSET THEN
        REPEAT
          SalesLine.CreateDim(DATABASE::"G/L Account",TempSalesLine."No.",
            DATABASE::Job,TempSalesLine."Job No.",
            DATABASE::"Responsibility Center",TempSalesLine."Responsibility Center");
        UNTIL TempSalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CollectParamsInBufferForCreateDimSet@72(VAR TempSalesLine@1000 : TEMPORARY Record 37;SalesLine@1001 : Record 37);
    VAR
      GenPostingSetup@1003 : Record 252;
      DefaultDimension@1002 : Record 352;
    BEGIN
      TempSalesLine.SETRANGE("Gen. Bus. Posting Group",SalesLine."Gen. Bus. Posting Group");
      TempSalesLine.SETRANGE("Gen. Prod. Posting Group",SalesLine."Gen. Prod. Posting Group");
      IF NOT TempSalesLine.FINDFIRST THEN BEGIN
        GenPostingSetup.GET(SalesLine."Gen. Bus. Posting Group",SalesLine."Gen. Prod. Posting Group");
        GenPostingSetup.TESTFIELD("Sales Prepayments Account");
        DefaultDimension.SETRANGE("Table ID",DATABASE::"G/L Account");
        DefaultDimension.SETRANGE("No.",GenPostingSetup."Sales Prepayments Account");
        InsertTempSalesLineInBuffer(TempSalesLine,SalesLine,GenPostingSetup."Sales Prepayments Account",DefaultDimension.ISEMPTY);
      END ELSE
        IF NOT TempSalesLine.MARK THEN BEGIN
          TempSalesLine.SETRANGE("Job No.",SalesLine."Job No.");
          TempSalesLine.SETRANGE("Responsibility Center",SalesLine."Responsibility Center");
          IF TempSalesLine.ISEMPTY THEN
            InsertTempSalesLineInBuffer(TempSalesLine,SalesLine,TempSalesLine."No.",FALSE);
        END;
    END;

    LOCAL PROCEDURE InsertTempSalesLineInBuffer@71(VAR TempSalesLine@1001 : TEMPORARY Record 37;SalesLine@1000 : Record 37;AccountNo@1002 : Code[20];DefaultDimensionsNotExist@1003 : Boolean);
    BEGIN
      TempSalesLine.INIT;
      TempSalesLine."Line No." := SalesLine."Line No.";
      TempSalesLine."No." := AccountNo;
      TempSalesLine."Job No." := SalesLine."Job No.";
      TempSalesLine."Responsibility Center" := SalesLine."Responsibility Center";
      TempSalesLine."Gen. Bus. Posting Group" := SalesLine."Gen. Bus. Posting Group";
      TempSalesLine."Gen. Prod. Posting Group" := SalesLine."Gen. Prod. Posting Group";
      TempSalesLine.MARK := DefaultDimensionsNotExist;
      TempSalesLine.INSERT;
    END;

    PROCEDURE OpenSalesOrderStatistics@70();
    BEGIN
      CalcInvDiscForHeader;
      CreateDimSetForPrepmtAccDefaultDim;
      COMMIT;
      IF "Tax Area Code" = '' THEN
        PAGE.RUNMODAL(PAGE::"Sales Order Statistics",Rec)
      ELSE
        PAGE.RUNMODAL(PAGE::"Sales Order Stats.",Rec)
    END;

    PROCEDURE GetCardpageID@58() : Integer;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(PAGE::"Sales Quote");
        "Document Type"::Order:
          EXIT(PAGE::"Sales Order");
        "Document Type"::Invoice:
          EXIT(PAGE::"Sales Invoice");
        "Document Type"::"Credit Memo":
          EXIT(PAGE::"Sales Credit Memo");
        "Document Type"::"Blanket Order":
          EXIT(PAGE::"Blanket Sales Order");
        "Document Type"::"Return Order":
          EXIT(PAGE::"Sales Return Order");
      END;
    END;

    PROCEDURE CheckAvailableCreditLimit@67() : Decimal;
    VAR
      Customer@1000 : Record 18;
      AvailableCreditLimit@1002 : Decimal;
    BEGIN
      IF NOT Customer.GET("Bill-to Customer No.") THEN
        Customer.GET("Sell-to Customer No.");

      AvailableCreditLimit := Customer.CalcAvailableCredit;

      IF AvailableCreditLimit < 0 THEN
        OnCustomerCreditLimitExceeded
      ELSE
        OnCustomerCreditLimitNotExceeded;

      EXIT(AvailableCreditLimit);
    END;

    PROCEDURE SetStatus@99(NewStatus@1000 : Option);
    BEGIN
      Status := NewStatus;
      MODIFY;
    END;

    LOCAL PROCEDURE TestSalesLineFieldsBeforeRecreate@68();
    BEGIN
      SalesLine.TESTFIELD("Job No.",'');
      SalesLine.TESTFIELD("Job Contract Entry No.",0);
      SalesLine.TESTFIELD("Quantity Shipped",0);
      SalesLine.TESTFIELD("Quantity Invoiced",0);
      SalesLine.TESTFIELD("Return Qty. Received",0);
      SalesLine.TESTFIELD("Shipment No.",'');
      SalesLine.TESTFIELD("Return Receipt No.",'');
      SalesLine.TESTFIELD("Blanket Order No.",'');
      SalesLine.TESTFIELD("Prepmt. Amt. Inv.",0);
    END;

    LOCAL PROCEDURE RecreateReservEntryReqLine@75(VAR TempSalesLine@1000 : TEMPORARY Record 37;VAR TempATOLink@1003 : TEMPORARY Record 904;VAR ATOLink@1002 : Record 904);
    BEGIN
      REPEAT
        TestSalesLineFieldsBeforeRecreate;
        IF (SalesLine."Location Code" <> "Location Code") AND NOT SalesLine.IsServiceItem THEN
          SalesLine.VALIDATE("Location Code","Location Code");
        TempSalesLine := SalesLine;
        IF SalesLine.Nonstock THEN BEGIN
          SalesLine.Nonstock := FALSE;
          SalesLine.MODIFY;
        END;

        IF ATOLink.AsmExistsForSalesLine(TempSalesLine) THEN BEGIN
          TempATOLink := ATOLink;
          TempATOLink.INSERT;
          ATOLink.DELETE;
        END;

        TempSalesLine.INSERT;
        RecreateReservEntry(SalesLine,0,TRUE);
        RecreateReqLine(SalesLine,0,TRUE);
      UNTIL SalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE TransferItemChargeAssgntSalesToTemp@69(VAR ItemChargeAssgntSales@1001 : Record 5809;VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809);
    BEGIN
      IF ItemChargeAssgntSales.FINDSET THEN BEGIN
        REPEAT
          TempItemChargeAssgntSales.INIT;
          TempItemChargeAssgntSales := ItemChargeAssgntSales;
          TempItemChargeAssgntSales.INSERT;
        UNTIL ItemChargeAssgntSales.NEXT = 0;
        ItemChargeAssgntSales.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE CreateSalesLine@78(VAR TempSalesLine@1000 : TEMPORARY Record 37);
    BEGIN
      SalesLine.INIT;
      SalesLine."Line No." := SalesLine."Line No." + 10000;
      SalesLine.VALIDATE(Type,TempSalesLine.Type);
      IF TempSalesLine."No." = '' THEN BEGIN
        SalesLine.VALIDATE(Description,TempSalesLine.Description);
        SalesLine.VALIDATE("Description 2",TempSalesLine."Description 2");
      END ELSE BEGIN
        SalesLine.VALIDATE("No.",TempSalesLine."No.");
        IF SalesLine.Type <> SalesLine.Type::" " THEN BEGIN
          SalesLine.VALIDATE("Unit of Measure Code",TempSalesLine."Unit of Measure Code");
          SalesLine.VALIDATE("Variant Code",TempSalesLine."Variant Code");
          IF TempSalesLine.Quantity <> 0 THEN BEGIN
            SalesLine.VALIDATE(Quantity,TempSalesLine.Quantity);
            SalesLine.VALIDATE("Qty. to Assemble to Order",TempSalesLine."Qty. to Assemble to Order");
          END;
          SalesLine."Purchase Order No." := TempSalesLine."Purchase Order No.";
          SalesLine."Purch. Order Line No." := TempSalesLine."Purch. Order Line No.";
          SalesLine."Drop Shipment" := SalesLine."Purch. Order Line No." <> 0;

          // >> EDI
          SalesLine."EDI Ship Confirmed" := TempSalesLine."EDI Ship Confirmed";
          SalesLine."EDI Item Cross Ref." := TempSalesLine."EDI Item Cross Ref.";
          SalesLine."EDI Unit of Measure" := TempSalesLine."EDI Unit of Measure";
          SalesLine."EDI Unit Price" := TempSalesLine."EDI Unit Price";
          SalesLine."EDI Price Discrepancy" := TempSalesLine."EDI Price Discrepancy";
          SalesLine."EDI Segment Group" := TempSalesLine."EDI Segment Group";
          SalesLine."EDI Original Qty." := TempSalesLine."EDI Original Qty.";
          SalesLine."EDI Status Pending" := TempSalesLine."EDI Status Pending";
          SalesLine."EDI Release No." := TempSalesLine."EDI Release No.";
          SalesLine."EDI Ship Req. Date" := TempSalesLine."EDI Ship Req. Date";
          SalesLine."EDI Kanban No." := TempSalesLine."EDI Kanban No.";
          SalesLine."EDI Line Type" := TempSalesLine."EDI Line Type"::Recreate;
          SalesLine."EDI Line Status" := TempSalesLine."EDI Line Status";
          SalesLine."EDI Cumulative Quantity" := TempSalesLine."EDI Cumulative Quantity";
          SalesLine."EDI Forecast Begin Date" := TempSalesLine."EDI Forecast Begin Date";
          SalesLine."EDI Forecast End Date" := TempSalesLine."EDI Forecast End Date";
          SalesLine."EDI Code" := TempSalesLine."EDI Code";
          // << EDI

        END;
      END;
      SalesLine.INSERT;
    END;

    LOCAL PROCEDURE CreateItemChargeAssgntSales@83(VAR ItemChargeAssgntSales@1001 : Record 5809;VAR TempItemChargeAssgntSales@1000 : TEMPORARY Record 5809;VAR TempSalesLine@1002 : TEMPORARY Record 37;VAR TempInteger@1003 : TEMPORARY Record 2000000026);
    BEGIN
      IF TempSalesLine.FINDSET THEN
        REPEAT
          TempItemChargeAssgntSales.SETRANGE("Document Line No.",TempSalesLine."Line No.");
          IF TempItemChargeAssgntSales.FINDSET THEN BEGIN
            REPEAT
              TempInteger.FINDFIRST;
              ItemChargeAssgntSales.INIT;
              ItemChargeAssgntSales := TempItemChargeAssgntSales;
              ItemChargeAssgntSales."Document Line No." := TempInteger.Number;
              ItemChargeAssgntSales.VALIDATE("Unit Cost",0);
              ItemChargeAssgntSales.INSERT;
            UNTIL TempItemChargeAssgntSales.NEXT = 0;
            TempInteger.DELETE;
          END;
        UNTIL TempSalesLine.NEXT = 0;
    END;

    LOCAL PROCEDURE UpdateOutboundWhseHandlingTime@84();
    BEGIN
      IF "Location Code" <> '' THEN BEGIN
        IF Location.GET("Location Code") THEN
          "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
      END ELSE
        IF InvtSetup.GET THEN
          "Outbound Whse. Handling Time" := InvtSetup."Outbound Whse. Handling Time";
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckSalesPostRestrictions@115();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCustomerCreditLimitExceeded@74();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCustomerCreditLimitNotExceeded@76();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckSalesReleaseRestrictions@81();
    BEGIN
    END;

    PROCEDURE DeferralHeadersExist@82() : Boolean;
    VAR
      DeferralHeader@1000 : Record 1701;
      DeferralUtilities@1001 : Codeunit 1720;
    BEGIN
      DeferralHeader.SETRANGE("Deferral Doc. Type",DeferralUtilities.GetSalesDeferralDocType);
      DeferralHeader.SETRANGE("Gen. Jnl. Template Name",'');
      DeferralHeader.SETRANGE("Gen. Jnl. Batch Name",'');
      DeferralHeader.SETRANGE("Document Type","Document Type");
      DeferralHeader.SETRANGE("Document No.","No.");
      EXIT(NOT DeferralHeader.ISEMPTY);
    END;

    LOCAL PROCEDURE ConfirmUpdateDeferralDate@85();
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(DeferralLineQst,FALSE);
      IF Confirmed THEN
        UpdateSalesLines(SalesLine.FIELDCAPTION("Deferral Code"),FALSE);
    END;

    PROCEDURE ReceiveStatus@14000601() : Text[30];
    VAR
      TotalQtyToReceiveBase@14000700 : Decimal;
    BEGIN
      // Additional code required in Attain
      IF "Document Type" = "Document Type"::"Return Order" THEN BEGIN
        CALCFIELDS("Total Return Qty to Rec (base)","Total Qty. Received (base)");
        TotalQtyToReceiveBase := "Total Return Qty to Rec (base)";
      END ELSE BEGIN
        CALCFIELDS("Total Qty. To Ship (base)","Total Qty. Received (base)");
        TotalQtyToReceiveBase := "Total Qty. To Ship (base)";
      END;

      CASE TRUE OF
        TotalQtyToReceiveBase = 0:
          EXIT(Text14000702);
        "Total Qty. Received (base)" = 0:
          EXIT(Text14000703);
        TotalQtyToReceiveBase = "Total Qty. Received (base)":
          EXIT(Text14000704);
        TotalQtyToReceiveBase < "Total Qty. Received (base)":
          EXIT(Text14000705);
        ELSE
          EXIT(Text14000706);
      END;
    END;

    PROCEDURE PackingStatus@14000701() : Text[30];
    VAR
      SalesLine2@1240030000 : Record 37;
      TotalQtyToShipBase@14000701 : Decimal;
    BEGIN
      // Additional code required in Attain
      CALCFIELDS("Total Qty. To Ship (base)","Total Qty. Packed (base)");
      TotalQtyToShipBase := "Total Qty. To Ship (base)";
      IF TotalQtyToShipBase = 0 THEN BEGIN
        CALCFIELDS(
          "E-Ship Whse. Outst. Qty (Base)","E-Ship Whse. Ship. Qty (Base)",
          "E-Ship Invt. Outst. Qty (Base)");
        TotalQtyToShipBase :=
        "E-Ship Whse. Outst. Qty (Base)" + "E-Ship Whse. Ship. Qty (Base)" +
        "E-Ship Invt. Outst. Qty (Base)";
      END;

      CASE TRUE OF
        TotalQtyToShipBase = 0:
          EXIT(Text14000707);
        "Total Qty. Packed (base)" = 0:
          EXIT(Text14000708);
        TotalQtyToShipBase = "Total Qty. Packed (base)":
          EXIT(Text14000709);
        TotalQtyToShipBase < "Total Qty. Packed (base)":
          EXIT(Text14000710);
        ELSE
          EXIT(Text14000711);
      END;
    END;

    PROCEDURE SetRunFromEDI@14000351(EDI@14000351 : Boolean);
    BEGIN
      // >> EDI
      IF EDI THEN
        RunFromEDI := TRUE
      ELSE
        RunFromEDI := FALSE;
      // << EDI
    END;

    PROCEDURE DeleteEDIDiscounts@14000352();
    VAR
      EDIDiscount@14000351 : Record 14002382;
      EDILineDiscount@14000352 : Record 14002383;
      SalesHdr@14000353 : Record 36;
      SalesInvoiceHeader@14000354 : Record 112;
    BEGIN
      // >> EDI
      EDILineDiscount.RESET;
      EDILineDiscount.SETRANGE("Internal Doc. No.","EDI Internal Doc. No.");
      EDILineDiscount.SETRANGE("Document Type","Document Type");
      EDILineDiscount.SETRANGE("Document No.","No.");
      EDILineDiscount.DELETEALL;

      EDIDiscount.RESET;
      EDIDiscount.SETRANGE("Internal Doc. No.","EDI Internal Doc. No.");
      IF EDIDiscount.FIND('-') THEN BEGIN
        SalesHdr.RESET;
        SalesHdr.SETCURRENTKEY("EDI Order","EDI Trade Partner","EDI Internal Doc. No.");
        SalesHdr.SETRANGE("EDI Internal Doc. No.","EDI Internal Doc. No.");
        SalesHdr.SETFILTER("No.",'<>%1',"No.");
        IF NOT SalesHdr.FIND('-') THEN BEGIN
          SalesInvoiceHeader.RESET;
          SalesInvoiceHeader.SETCURRENTKEY("EDI Internal Doc. No.");
          SalesInvoiceHeader.SETRANGE("EDI Internal Doc. No.","EDI Internal Doc. No.");
          IF NOT SalesInvoiceHeader.FIND('-') THEN BEGIN
            EDIDiscount.RESET;
            EDIDiscount.SETRANGE("Internal Doc. No.","EDI Internal Doc. No.");
            EDIDiscount.DELETEALL;
          END;
        END;
      END;
      // << EDI
    END;

    PROCEDURE SetEDITemp@14000353(EDI@14000352 : Boolean);
    BEGIN
      // >> EDI
      IF EDI THEN
        EDITemp := TRUE
      ELSE
        EDITemp := FALSE;
      // << EDI
    END;

    PROCEDURE DeleteShippingAgentOptionPage@14000702();
    VAR
      Shipping@14000700 : Codeunit 14000701;
    BEGIN
      SalesSetup.GET;
      IF SalesSetup."Enable Shipping" THEN
        Shipping.DeleteDocumentOptionPages("No.",DATABASE::"Sales Header","Document Type");
    END;

    PROCEDURE CheckDuplicateDocNo@1000000000();
    VAR
      SlsHdr@1000000001 : Record 36;
      SlsInvHdr@1000000000 : Record 112;
      SlsCrMemoHdr@1000000002 : Record 114;
    BEGIN
      // DW006 8/2010
      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice] THEN BEGIN
        SlsInvHdr.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
        SlsInvHdr.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
        SlsInvHdr.SETRANGE("External Document No.","External Document No.");
        IF SlsInvHdr.FINDLAST THEN
          MESSAGE('%1 %2 found on Posted Sales Invoice %3',
                FIELDCAPTION("External Document No."),
                "External Document No.",
                SlsInvHdr."No.");
      END;

      // DW006 2/2013
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        SlsCrMemoHdr.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
        SlsCrMemoHdr.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
        SlsCrMemoHdr.SETRANGE("External Document No.","External Document No.");
        IF SlsCrMemoHdr.FINDLAST THEN
          MESSAGE('%1 %2 found on Posted Sales Credit Memo %3',
                FIELDCAPTION("External Document No."),
                "External Document No.",
                SlsCrMemoHdr."No.");
      END;

      SlsHdr.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
      SlsHdr.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
      SlsHdr.SETRANGE("External Document No.","External Document No.");
      SlsHdr.SETRANGE("Document Type","Document Type");
      SlsHdr.SETFILTER("No.",'<>%1',"No.");
      IF SlsHdr.FINDLAST THEN
        MESSAGE('%1 %2 found on Sales %3 %4',
              FIELDCAPTION("External Document No."),
              "External Document No.",
              FORMAT(SlsHdr."Document Type"),
              SlsHdr."No.");
    END;

    PROCEDURE CheckDuplicateDocNo2@1000000005(DocNo@1000000003 : Text[30]) : Boolean;
    VAR
      SlsHdr@1000000001 : Record 36;
      SlsInvHdr@1000000000 : Record 112;
      SlsCrMemoHdr@1000000002 : Record 114;
    BEGIN
      //T344
      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice] THEN BEGIN
        SlsInvHdr.SETCURRENTKEY("Sell-to Customer No.","Your Reference");
        SlsInvHdr.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
        SlsInvHdr.SETRANGE("Your Reference",COPYSTR(DocNo,1,MAXSTRLEN(SlsInvHdr."Your Reference")));
        IF SlsInvHdr.FINDLAST THEN
          EXIT(TRUE);
      END;

      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        SlsCrMemoHdr.SETCURRENTKEY("Sell-to Customer No.","Your Reference");
        SlsCrMemoHdr.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
        SlsCrMemoHdr.SETRANGE("Your Reference",COPYSTR(DocNo,1,MAXSTRLEN(SlsCrMemoHdr."Your Reference")));
        IF SlsCrMemoHdr.FINDLAST THEN
          EXIT(TRUE);
      END;

      SlsHdr.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
      SlsHdr.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
      SlsHdr.SETRANGE("Your Reference",COPYSTR(DocNo,1,MAXSTRLEN(SlsHdr."Your Reference")));
      SlsHdr.SETRANGE("Document Type","Document Type");
      SlsHdr.SETFILTER("No.",'<>%1',"No.");
      IF SlsHdr.FINDLAST THEN
        EXIT(TRUE);
    END;

    PROCEDURE LocationPackingStatus@1000000001(LocationFilter@1000000000 : Code[80]) : Text[30];
    VAR
      SalesLine2@1240030000 : Record 37;
      TotalQtyToShipBase@14000701 : Decimal;
    BEGIN
      // DW 10/2010 Copy of Packing Status but by Location
      // Additional code required in Attain
      SETFILTER("Location Filter",LocationFilter); // DW
      CALCFIELDS("Total Qty. To Ship (base)","Total Qty. Packed (base)");
      TotalQtyToShipBase := "Total Qty. To Ship (base)";
      IF TotalQtyToShipBase = 0 THEN BEGIN
        SalesLine2.RESET;
        SalesLine2.SETRANGE("Document Type","Document Type");
        SalesLine2.SETRANGE("Document No.","No.");
        SalesLine2.SETRANGE(Type,SalesLine2.Type::Item);
        SalesLine2.SETFILTER("Outstanding Qty. (Base)",'<>0');
        SalesLine2.SETFILTER("Qty. to Assemble to Order",'<>0'); // 
        SalesLine2.SETRANGE(Pack,TRUE);
        SalesLine2.SETRANGE("Location Code",LocationFilter); // DW
        IF SalesLine2.FIND('-') THEN BEGIN
          SalesLine2.SETRANGE(Type);
          SalesLine2.SETRANGE("Qty. to Assemble to Order");
          TotalQtyToShipBase :=
            TotalQtyToShipBase + SalesLine2.CalcEShipWhseOutstQtyBase(FALSE,LocationFilter); // DW
        END ELSE BEGIN
          CALCFIELDS(
            "E-Ship Whse. Outst. Qty (Base)","E-Ship Whse. Ship. Qty (Base)",
            "E-Ship Invt. Outst. Qty (Base)");
          TotalQtyToShipBase :=
          "E-Ship Whse. Outst. Qty (Base)" + "E-Ship Whse. Ship. Qty (Base)" +
          "E-Ship Invt. Outst. Qty (Base)";
        END;
      END;

      CASE TRUE OF
        TotalQtyToShipBase = 0:
          EXIT(Text14000707);
        "Total Qty. Packed (base)" = 0:
          EXIT(Text14000708);
        TotalQtyToShipBase = "Total Qty. Packed (base)":
          EXIT(Text14000709);
        TotalQtyToShipBase < "Total Qty. Packed (base)":
          EXIT(Text14000710);
        ELSE
          EXIT(Text14000711);
      END;
    END;

    PROCEDURE GetEDIShipXref@1000000004();
    VAR
      EDIShipXref@1000000000 : Record 50030;
    BEGIN
      //RT016 -BEGIN
      //DW Modify to Setrange
      EDIShipXref.RESET;
      EDIShipXref.SETRANGE("EDI Trade Partner","EDI Trade Partner");
      EDIShipXref.SETRANGE("EDI Trade Partner Ship Code","EDI Shipping Code");
      IF "EDI Ship Speed Code" <> '' THEN
        EDIShipXref.SETRANGE("EDI Trade Partner Speed Code","EDI Ship Speed Code");
      IF EDIShipXref.FIND('-') THEN BEGIN
        IF EDIShipXref."Deliver-to Carrier" THEN BEGIN
          "Deliver-to Shipping Agent" := EDIShipXref."NAV Shipping Agent";
          EXIT; // DW Final Mile "Deliver-to Carrier"
        END;
        VALIDATE("Shipping Agent Code",EDIShipXref."NAV Shipping Agent");
        VALIDATE("E-Ship Agent Service",EDIShipXref."E-Ship Agent Service");
        IF EDIShipXref."NAV Shipment Method Code" <> '' THEN // DW 4/11
           VALIDATE("Shipment Method Code",EDIShipXref."NAV Shipment Method Code");
        // DW 9/11
        IF EDIShipXref."Shipping Account" <> '' THEN
          VALIDATE("Third Party Ship. Account No.",EDIShipXref."Shipping Account");
        IF EDIShipXref."Delivery Type" = EDIShipXref."Delivery Type"::Residential THEN
          "Residential Delivery" := TRUE;
        // DW 9/11
        // DW 5/17
        IF EDIShipXref.Liftgate THEN
          Liftgate := TRUE;
        IF EDIShipXref."Limited Access" THEN
          "Limited Access" := TRUE;
        IF EDIShipXref."Inside Delivery" THEN
          "Inside Delivery" := TRUE;
        IF EDIShipXref."Call Ahead" THEN
          "Call Ahead" := TRUE;
        IF EDIShipXref."Signature Required" THEN
          "Signature Required" := TRUE;
        // DW
        IF EDIShipXref."Disable Validation" THEN
          "EDI Shipping Code" := '';
      END ELSE
        IF "EDI Ship Speed Code" <> '' THEN
          ERROR('Trade Partner %1 Shipping Code %2 Ship Speed Code %3 not Found',
            "EDI Trade Partner","EDI Shipping Code","EDI Ship Speed Code")
        ELSE
          ERROR('Trade Partner %1 Shipping Code %2 not Found',
            "EDI Trade Partner","EDI Shipping Code");
      //RT016 -END
    END;

    PROCEDURE GetSlsHdrExt@1000000003(VAR SlsHdrExt@1000000000 : Record 50004);
    BEGIN
      // DW 12/11
      IF NOT SlsHdrExt.GET("Document Type","No.") THEN BEGIN
        CLEAR(SlsHdrExt);
        SetSlsHdrExt(SlsHdrExt);
      END;
    END;

    PROCEDURE SetSlsHdrExt@1000000002(VAR SlsHdrExt@1000000000 : Record 50004);
    VAR
      SlsHdrExt2@1000000001 : Record 50004;
    BEGIN
      // DW 12/11
      IF SlsHdrExt2.GET("Document Type","No.") THEN
        IF SlsHdrExt.MODIFY THEN
          EXIT;

      IF "No." <> '' THEN BEGIN
        SlsHdrExt.INIT;
        SlsHdrExt."Document Type" := "Document Type";
        SlsHdrExt."No." := "No.";
        IF SlsHdrExt.INSERT THEN
          EXIT;
      END;
    END;

    PROCEDURE "//PS01-begin"@1000000007();
    BEGIN
    END;

    PROCEDURE SplitOrder@1000000017();
    VAR
      ECRSalesOrderFun@1000000000 : Codeunit 50016;
    BEGIN
      ECRSalesOrderFun.SplitOrder(Rec); // DW0318 Move function to Codeunit
    END;

    PROCEDURE LocationPickStatus@1000000009(OrderNo@1000000006 : Code[20];LocationCode@1000000000 : Code[10];ThroughDate@1000000001 : Date) : Text[80];
    VAR
      Header@1000000007 : Record 36;
      locSalesLine@1240030000 : Record 37;
      locPickLine@1000000005 : Record 37;
      TotalQtyToShipBase@14000701 : Decimal;
      locConst001@1000000002 : TextConst 'ENU=No unplanned shipments';
      locConst002@1000000003 : TextConst 'ENU=Picks Due see Line %1 order %2';
      MessageText@1000000004 : Text[30];
    BEGIN
      IF NOT Header.GET("Document Type"::Order,OrderNo) THEN
        EXIT('');
      Header.SETFILTER("Location Filter",LocationCode);
      Header.SETFILTER("Date Filter",'..%1',ThroughDate);
      Header.CALCFIELDS("Outstanding Quantity","Qty. To Ship");
      IF Header."Qty. To Ship" <> 0 THEN
        EXIT(STRSUBSTNO('Picks Due for Location %1',LocationCode))
      ELSE
        EXIT(STRSUBSTNO('No unplanned Shipments for [%1] through [%2]',LocationCode,FORMAT(ThroughDate)));
    END;

    PROCEDURE "//B2C02"@1000000010();
    BEGIN
    END;

    PROCEDURE CalculatePriorityEscalation@1000000012(SalesHdr@1000000000 : Record 36) : Date;
    VAR
      SlsLine@1000000001 : Record 37;
      CRISLF@1000000007 : Codeunit 50006;
      EarliestEscDate@1000000008 : Date;
      EscalationDate@1000000004 : Date;
    BEGIN
      // DW1017 For ASN EDI Out field
      // DW0318 Changed to use Codeunit 50006
      EarliestEscDate := 0D;
      SlsLine.SETRANGE("Document Type",SalesHdr."Document Type");
      SlsLine.SETRANGE("Document No.",SalesHdr."No.");
      SlsLine.SETRANGE(Type,SlsLine.Type::Item);
      SlsLine.SETFILTER("Outstanding Quantity",'<>%1',0);
      IF SlsLine.FINDSET THEN REPEAT
        EscalationDate := CRISLF.CalcPriEscDate(SlsLine,SlsLine."Priority Escalation Date");
        IF EscalationDate <> 0D THEN
          IF EarliestEscDate = 0D THEN
            EarliestEscDate := EscalationDate
          ELSE
            IF EscalationDate < EarliestEscDate THEN
              EarliestEscDate := EscalationDate;
      UNTIL SlsLine.NEXT = 0;

      EXIT(EarliestEscDate);
    END;

    PROCEDURE CheckFreightQuote@1000000011();
    VAR
      locLine@1000000000 : Record 37;
    BEGIN
      IF ("Ship-to City" <> xRec."Ship-to City") OR
         ("Ship-to Post Code" <> xRec."Ship-to Post Code") OR
         ("Ship-to County" <> xRec."Ship-to County") OR
         ("Ship-to Country/Region Code" <> xRec."Ship-to Country/Region Code") OR
         ("Residential Delivery" <> xRec."Residential Delivery") OR
         ("Signature Required"<> xRec."Signature Required") OR
         (Liftgate <> xRec.Liftgate) OR
         ("Limited Access" <> xRec."Limited Access") THEN BEGIN
           locLine.SETCURRENTKEY("Document Type","Document No.","Shipping Charge");
       locLine.SETRANGE("Document Type","Document Type");
       locLine.SETRANGE("Document No.","No.");
       locLine.SETRANGE("Shipping Charge",TRUE);
       locLine.SETFILTER("Quantity Shipped",'%1',0);
       IF locLine.FINDFIRST THEN BEGIN
         IF GUIALLOWED THEN
           IF CONFIRM('Making this Delivery Instruction Change will impact the Freight Quote.\The quote will be deleted.\' +
                      'And will need to be reapplied\ Continue?',TRUE) THEN
                 locLine.DELETE(TRUE);
       END;
      END;
    END;

    LOCAL PROCEDURE SetPackRuleShipping@1000000015(CurrFieldNo@1000000002 : Integer);
    VAR
      PackingRule@1000000001 : Record 14000715;
      PackRuleShipAcct@1000000000 : Record 50088;
    BEGIN
      // DWPR1117
      IF "Packing Rule Code" = '' THEN
        EXIT;

      PackingRule.GET("Packing Rule Code");
      IF CurrFieldNo = FIELDNO("Packing Rule Code") THEN BEGIN
        "Shipping Payment Type" := PackingRule."Shipping Payment Type";
        IF PackingRule."Shipping Payment Type" = PackingRule."Shipping Payment Type"::Default THEN BEGIN
          GetCust("Sell-to Customer No.");
          "Shipping Payment Type" := Cust."Shipping Payment Type";
        END;
        IF "Shipping Payment Type" = "Shipping Payment Type"::"Third Party" THEN
          IF PackRuleShipAcct.GET(PackingRule.Code,"Shipping Agent Code") THEN
             "Third Party Ship. Account No." := PackRuleShipAcct."Account No.";
      END;

      IF CurrFieldNo IN [FIELDNO("Shipping Agent Code"),FIELDNO("Shipping Payment Type")] THEN
        IF "Shipping Payment Type" = "Shipping Payment Type"::"Third Party" THEN
          IF PackRuleShipAcct.GET(PackingRule.Code,"Shipping Agent Code") THEN
             "Third Party Ship. Account No." := PackRuleShipAcct."Account No.";
    END;

    PROCEDURE HistoryFunction@14001001(FunctionNo@1000000000 : Integer;Comment@1000000001 : Text[30]);
    VAR
      HistoryRec@1000000002 : Record 14003158;
      ApplicationMgt@1000000003 : Codeunit 1;
    BEGIN
      IF NOT ApplicationMgt.HistoryEnabled THEN
        EXIT;

      HistoryRec.HistoryFunction(Rec,FunctionNo,Comment);
    END;

    PROCEDURE HistoryFunction_110@14001002(FromRec@1000000000 : Record 110);
    VAR
      HistoryRec@1000000001 : Record 36;
      ApplicationMgt@1000000002 : Codeunit 1;
    BEGIN
      IF NOT ApplicationMgt.HistoryEnabled THEN
        EXIT;

      FromRec.TESTFIELD("Order No.");
      HistoryRec."Document Type" := HistoryRec."Document Type"::Order;
      HistoryRec."No." := FromRec."Order No.";
      HistoryRec.HistoryFunction(1,'');
    END;

    PROCEDURE HistoryFunction_112@14001003(FromRec@1000000000 : Record 112);
    VAR
      HistoryRec@1000000001 : Record 36;
      ApplicationMgt@1000000002 : Codeunit 1;
    BEGIN
      IF NOT ApplicationMgt.HistoryEnabled THEN
        EXIT;

      IF FromRec."Order No." <> '' THEN BEGIN
        HistoryRec."Document Type" := HistoryRec."Document Type"::Order;
        HistoryRec."No." := FromRec."Order No.";
      END ELSE BEGIN
        HistoryRec."Document Type" := HistoryRec."Document Type"::Invoice;
        HistoryRec."No." := FromRec."Pre-Assigned No.";
      END;
      HistoryRec.HistoryFunction(1,'');
    END;

    PROCEDURE HistoryFunction_114@14001004(FromRec@1000000000 : Record 114);
    VAR
      HistoryRec@1000000001 : Record 36;
      ApplicationMgt@1000000002 : Codeunit 1;
    BEGIN
      IF NOT ApplicationMgt.HistoryEnabled THEN
        EXIT;

      IF FromRec."Return Order No." <> '' THEN BEGIN
        HistoryRec."Document Type" := HistoryRec."Document Type"::"Return Order";
        HistoryRec."No." := FromRec."Return Order No.";
      END ELSE BEGIN
        HistoryRec."Document Type" := HistoryRec."Document Type"::"Credit Memo";
        HistoryRec."No." := FromRec."Pre-Assigned No.";
      END;
      HistoryRec.HistoryFunction(1,'');
    END;

    PROCEDURE HistoryFunction_6660@14001005(FromRec@1000000000 : Record 6660);
    VAR
      HistoryRec@1000000001 : Record 36;
      ApplicationMgt@1000000002 : Codeunit 1;
    BEGIN
      IF NOT ApplicationMgt.HistoryEnabled THEN
        EXIT;

      HistoryRec."Document Type" := HistoryRec."Document Type"::"Return Order";
      HistoryRec."No." := FromRec."Return Order No.";
      HistoryRec.HistoryFunction(1,'');
    END;

    PROCEDURE HistoryFunction_5107@14001006(FromRec@1000000000 : Record 5107);
    VAR
      HistoryRec@1000000001 : Record 36;
      ApplicationMgt@1000000002 : Codeunit 1;
    BEGIN
      IF NOT ApplicationMgt.HistoryEnabled THEN
        EXIT;

      HistoryRec."Document Type" := FromRec."Document Type";
      HistoryRec."No." := FromRec."No.";
      HistoryRec.HistoryFunction(1,'');
    END;

    BEGIN
    {
      TCFRT01  2007/12/29  Radiant Technologies, Titus Faber
        Added field:
          50000    Cancel After Date      Date
      TCFRT02  2008/07/31  Radiant Technologies, Titus Faber
        Added code for EShip (this code is EShip native code not included in the last EShip patch)

      RAD 101008 Removed Validation on Sell to and Ship to Post Code Fields for EDI - Added fields 50001,2,3,4 for
       Costco.com Packing list.

      TJB Added Sell-to Customer No.,External Document No.,No. key for duplicate search functions
      RT006 RCB 06/19/09 Return Authorization Fields
      --------------------------------------------------------------------------------
      RT005  SLW Auto Best Location
      --------------------------------------------------------------------------------
      --------------------------------------------------------------------------------
      RT011 RCB Push Inventory Availability to CSN
      --------------------------------------------------------------------------------
      RT012 RCB Facilitate TRU DropShip Ship-from Label Requirements
         Added Field "Trade Partner Sales Division"
         Modified OnVAlidate code on field "Double Blind Ship-from Cust No"
         Modified OnValidate code on field "EDI Trade Partner"
      --------------------------------------------------------------------------------
      RT015  SLW 10/14/09 EDI Ship From Cross Reference - Add Field
      RT015.01  New Option to Auto-best ship EDI - Do not change
      RT015.02  Add logic for Calculating Location
      --------------------------------------------------------------------------------
      VLQF501  -  SLW  -  09/15/2009  -  VLQF501
        Key Added - Document Type,External Document No.
       ----------------

      //RT026 - SLW 12/26/09  Added "New Order" boolean - default TRUE
                              Insert Key "Document Type","New Order","Sell-to Customer No."

      //RT016 RCB 01/10/2010 - Added Field "EDI Shipping Code"

      //RT038 RCB 01-28-20 - Removed User Prompt to update Lines for "Shipment Date","Requested Delivery Date" & "Promised Delivery Date"
      //DW 10/2010 Modify RT038 to follow standards (HideValidationDialog)

      RT016.01 RCB 05/02/10
        - Set "EDI Ship Code" blank when "EDI Ship Code"."Disable Validation" = TRUE
        - This allows users to modify Ship Parameters after the order is Created.
        - Used when the "EDI Ship Code" sent by the Trade Partner is not the actual
          "EDI Ship Code" that will be used for the actual shipment.

      DW001 8/2010 Add Ship Date default computation
      DW002 8/2010 Ext. Doc. No. Caption > Purchase Order No.
                   Ship-to Phone caption > Phone No.
      DW005 8/2010 Replace Auto-Best with New SimpleAutoBest
      DW006 8/2010 Add Duplicate PO No. Check

      DW101 RDA 09/01/10 - Added flowfields "Total Weight" and "Total Cube".
      DW DAC 10/2010 Change Shipment Date Caption to Expected Ship Date
      DW DAC 10/2010 Add LocationPackingStatus paragraph
      DW DAC 2/11 Add key Shipping Agent,Shipment Date
      DW DAC 2/11 Field 59999 table relation changed to 50009
      DW DAC 3/11 Currency Factor Editable, Blank zero and validate
      DW 6/11 Add Liftgate, limited access, inside delivery booleans
      DW 12/11 Move fields to SlsHdrExt table
      DW 7/12 Add EDI Ship Speed Code and move Validate code to GetEDIShipXRef
      DW 9/14 Set Shipping Payment Type by Shipment Method Code
      DW 11/14 Add DWEFT Delete CC After Invoice
      //SLW20150113  Added FlowField - Package Qty to Ship
      //SLW20150312 'EDI Shipping Code' expanded for Amazon DS
      //T225 SLW20150318 OnInsert Record Date and Time Received
      T335 SLW20150324 Added fields : Hold ASN, Hold Invoice for Shipping
      //T344 SLW20150408 Added Key "Customer Order No."
                         Added Function CheckforDuplicateDocNo2
      //T384 SLW20150421 Set 'Days to Ship' to not editable.  Showing on Form now.

      T335.2 Correct Flow Field on Shipping Hold
      T388 SLW20150615 Renamed EDI Earliest Ship Date to 'Do not Ship Before'
                       OnInsert - Fulfillment Set RSD
                       Ship-to County onValidate, Sell-to Customer No. - onValidate
                       Changed Best Location Status to Fulfillment Planning Status

      //SP01 'Shipping Pick Orders'
      'Pick Status':: '',Pending Pick,In Pick,Packed,Shipped,Error in Posting
           ..
      //T512 SLW20150622 Manifesting Added 'packages pending shipment'
      //PC01 Post Code control changes.
      //SLW20160324 Change in country ship-to should look at Shipping Agent/Service Level
      //2016 Remove Starter DB code,
      //2016 Add Date Received, Time Received as custom to match 110, 112 (BizTalk obsoleted)
      ----------------------------------------------------------------------------------
      //<< DES1.00
         37103000 to 37103027 Fields added.
         Added code in ship-to county field Validate trigger
          Added Functions
           ApplyCoupon
           WebCCAuthorization
           SetDataCC
           GetDataCC
           Added (EshopMethods.SetEshopSalesHeader) Code in OnInsert Trigger
      //>> DES1.00
      // DW0218 Add Priority Escalation Date field and key
      // DW0418 Allow entry of Sales Order for blocked Customer
      //DWJJT 06/05/2018 - Added new fields EDI Location Code & Quick Ship
      //DWSBC 06/14/2018 - Added new Field 3PL Warehouse
      //DWSBC 06/19/2018 - Changed Quick Ship flag to Normal Field, Added Validate Code in EDI Location Code to Update Quick Ship Flag
      DW SBC 2018-07-20 MN - Added Field ID - 50070
    }
    END.
  }
}

OBJECT Table 50094 3PL Orders
{
  OBJECT-PROPERTIES
  {
    Date=07/20/18;
    Time=[ 3:53:29 AM];
    Modified=Yes;
    Version List=,SBC;
  }
  PROPERTIES
  {
    CaptionML=ENU=3PL Orders;
    LookupPageID=Page50189;
    DrillDownPageID=Page50189;
  }
  FIELDS
  {
    { 1   ;   ;3PL Code            ;Code10        ;TableRelation="3PL Warehouses" }
    { 2   ;   ;Order No.           ;Code20         }
    { 3   ;   ;Order Date          ;Date           }
    { 4   ;   ;Expected Shipment Date;Date         }
    { 5   ;   ;Status              ;Option        ;OptionCaptionML=ENU=" ,Packing Required,Ready to Send,Sent to 3PL,Acknowledged,Shipped,Posted,Cancelled,Open";
                                                   OptionString=[ ,Packing Required,Ready to Send,Sent to 3PL,Acknowledged,Shipped,Posted,Cancelled,Open];
                                                   Description=SBC }
    { 6   ;   ;3PL Status          ;Text30         }
    { 7   ;   ;3PL Response Code   ;Text30         }
    { 8   ;   ;3PL Message         ;Text250        }
    { 9   ;   ;3PL Oder No.        ;Text30         }
    { 10  ;   ;3PL Acknowledgment  ;BLOB           }
    { 11  ;   ;Date/Time Added     ;DateTime       }
    { 12  ;   ;Date/Time Sent      ;DateTime       }
    { 13  ;   ;Date/Time Acknowledged;DateTime     }
    { 14  ;   ;Date/Time Shipped   ;DateTime       }
    { 15  ;   ;Date/Time Posted    ;DateTime       }
    { 16  ;   ;3PL Request         ;BLOB          ;Description=SBC }
    { 17  ;   ;File Extension      ;Text10        ;Description=SBC }
  }
  KEYS
  {
    {    ;3PL Code,Order No.                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      TierMgt@1000000000 : Codeunit 419;

    PROCEDURE ViewResponse@1000000000();
    VAR
      FileName@1000000000 : Text[1024];
      NVInStream@1000000002 : InStream;
    BEGIN
      //>> WS SBC 2018-07-14
      CALCFIELDS("3PL Acknowledgment");
      IF NOT "3PL Acknowledgment".HASVALUE THEN
        EXIT;

      FileName := TierMgt.ServerTempFileName("File Extension");
      IF EXISTS(FileName) THEN
        ERASE(FileName);

      "3PL Acknowledgment".CREATEINSTREAM(NVInStream);
      //>> DW SBC 2018-07-20
      DOWNLOADFROMSTREAM(NVInStream, '','',"File Extension", FileName);
      //DOWNLOADFROMSTREAM(NVInStream, '','','XML files (*.XML)|*.XML|All files (*.*)|*.*', FileName);
      //<< DW SBC 2018-07-20

      //<< WS SBC 2018-07-14
    END;

    PROCEDURE ViewRequest@1000000004();
    VAR
      FileName@1000000002 : Text[1024];
      NVInStream@1000000000 : InStream;
    BEGIN
      //>> WS SBC 2018-07-14
      CALCFIELDS("3PL Request");
      IF NOT "3PL Request".HASVALUE THEN
        EXIT;

      FileName := TierMgt.ServerTempFileName("File Extension");
      IF EXISTS(FileName) THEN
        ERASE(FileName);

      "3PL Request".CREATEINSTREAM(NVInStream);
      //>> DW SBC 2018-07-20
      DOWNLOADFROMSTREAM(NVInStream, '','',"File Extension", FileName);
      //DOWNLOADFROMSTREAM(NVInStream, '','','XML files (*.XML)|*.XML|All files (*.*)|*.*', FileName);
      //<< DW SBC 2018-07-20
      //<< WS SBC 2018-07-14
    END;

    BEGIN
    {
      DWSBC 06/14/2018 - WO60 Created New table for 3PL Warehouse Shipping
      WS SBC 2018-07-13 MN Added optionstring in the field Status
      WS SBC 2018-07-14 MN Added BLOB Field 3PL Request
                           and Functions - ViewResponse,ViewRequest
      DW SBC 2018-07-20 MN Code amended for XML File opening
    }
    END.
  }
}

OBJECT Table 50097 3PL Order Transaction History
{
  OBJECT-PROPERTIES
  {
    Date=07/19/18;
    Time=11:48:32 PM;
    Modified=Yes;
    Version List=SBC;
  }
  PROPERTIES
  {
    CaptionML=ENU=3PL Order Transaction History;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 2   ;   ;User ID             ;Code20        ;CaptionML=ENU=User ID }
    { 3   ;   ;Order No.           ;Code10        ;CaptionML=ENU=Order No. }
    { 4   ;   ;WS Status           ;Code5         ;CaptionML=ENU=WS Status }
    { 5   ;   ;WS Message          ;Text100       ;CaptionML=ENU=WS Message }
    { 6   ;   ;Order Date          ;Date          ;CaptionML=ENU=Order Date }
    { 7   ;   ;Process Date        ;Date          ;CaptionML=ENU=Process Date }
    { 8   ;   ;ShipDate            ;Date          ;CaptionML=ENU=ShipDate }
    { 9   ;   ;CarrierCode         ;Text4         ;CaptionML=ENU=CarrierCode }
    { 10  ;   ;ServiceCode         ;Text2         ;CaptionML=ENU=ServiceCode }
    { 11  ;   ;TrackingNo          ;Code20        ;CaptionML=ENU=TrackingNo }
    { 12  ;   ;Balance             ;Decimal       ;CaptionML=ENU=Balance }
    { 13  ;   ;PayType             ;Text2         ;CaptionML=ENU=PayType;
                                                   Description=[  ,C = credit card,K = e-Check,P = Pre-Paid,R =Reship] }
    { 14  ;   ;OrderType           ;Text30        ;CaptionML=ENU=OrderType }
    { 15  ;   ;ShipBatch           ;Text30        ;CaptionML=ENU=ShipBatch }
    { 16  ;   ;NextPaymentDate     ;Date          ;CaptionML=ENU=NextPaymentDate }
    { 17  ;   ;NextPaymentAmount   ;Decimal       ;CaptionML=ENU=NextPaymentAmount }
    { 18  ;   ;DeclineCounterValue ;Integer       ;CaptionML=ENU=DeclineCounterValue }
    { 19  ;   ;BalanceDue          ;Decimal       ;CaptionML=ENU=BalanceDue }
    { 20  ;   ;LastDeclineCode     ;Code10        ;CaptionML=ENU=LastDeclineCode }
    { 21  ;   ;LastPaymentDate     ;Date          ;CaptionML=ENU=LastPaymentDate }
    { 22  ;   ;LastPaymentNumber   ;Integer       ;CaptionML=ENU=LastPaymentNumber }
    { 23  ;   ;SOAP Request        ;BLOB          ;CaptionML=ENU=SOAP Request }
    { 24  ;   ;SOAP Response       ;BLOB          ;CaptionML=ENU=SOAP Response }
    { 25  ;   ;DB Code             ;Code10        ;TableRelation="FOB Transit Time";
                                                   CaptionML=ENU=DB Code }
    { 26  ;   ;File Extension      ;Text30        ;CaptionML=ENU=File Extension }
    { 27  ;   ;Group code          ;Code10        ;CaptionML=ENU=Group code }
    { 28  ;   ;SOAP Request DateTime;DateTime     ;CaptionML=ENU=SOAP Request DateTime }
    { 29  ;   ;Order Status        ;Option        ;CaptionML=ENU=Order Status;
                                                   OptionCaptionML=ENU=" ,Open,Shipped,Cancelled";
                                                   OptionString=[ ,Open,Shipped,Cancelled] }
    { 30  ;   ;Cancellation Date   ;Date          ;CaptionML=ENU=Cancellation Date }
    { 31  ;   ;3PL Code            ;Code10        ;TableRelation="3PL Warehouses" }
    { 32  ;   ;3PL Response Code   ;Text30        ;Description=DW SBC }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      TierMgt@1170000000 : Codeunit 419;

    PROCEDURE ViewResponse@1000000000();
    VAR
      FileName@1000000000 : Text[1024];
      NVInStream@1000000002 : InStream;
    BEGIN
      CALCFIELDS("SOAP Response");
      IF NOT "SOAP Response".HASVALUE THEN
        EXIT;

      FileName := TierMgt.ServerTempFileName("File Extension");
      IF EXISTS(FileName) THEN
        ERASE(FileName);

      "SOAP Response".CREATEINSTREAM(NVInStream);
      //>> DW SBC 2018-07-16
      //DOWNLOADFROMSTREAM(NVInStream, '','',"File Extension", FileName);
      DOWNLOADFROMSTREAM(NVInStream, '','','XML files (*.XML)|*.XML|All files (*.*)|*.*', FileName);
      //<< DW SBC 2018-07-16
    END;

    PROCEDURE ViewRequest@1000000004();
    VAR
      FileName@1000000002 : Text[1024];
      NVInStream@1000000000 : InStream;
    BEGIN
      CALCFIELDS("SOAP Request");
      IF NOT "SOAP Request".HASVALUE THEN
        EXIT;

      FileName := TierMgt.ServerTempFileName("File Extension");
      IF EXISTS(FileName) THEN
        ERASE(FileName);

      "SOAP Request".CREATEINSTREAM(NVInStream);
      //>> DW SBC 2018-07-16
      //DOWNLOADFROMSTREAM(NVInStream, '','',"File Extension" , FileName);
      DOWNLOADFROMSTREAM(NVInStream, '','','XML files (*.XML)|*.XML|All files (*.*)|*.*' , FileName);
      //<< DW SBC 2018-07-16
    END;

    BEGIN
    {
      DW SBC 2018-07-10 MN Created Table for Sales Order Web Service Hisory
      DW SBC 2018-07-16 MN Amended Function ViewRequest and ViewResponse
    }
    END.
  }
}

OBJECT Report 50077 Send New 3PL Orders
{
  OBJECT-PROPERTIES
  {
    Date=07/20/18;
    Time=[ 4:37:07 AM];
    Modified=Yes;
    Version List=SBC;
  }
  PROPERTIES
  {
    CaptionML=ENU=OrderNewAPI;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1170000000;;DataItem;                  ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(Document Type,No.)
                                 WHERE(Document Type=FILTER(Order));
               OnAfterGetRecord=BEGIN
                                  // >> DW SBC 2018-07-20
                                  //MoultonWebService.WebSrvOrderNEWAPI("3PL Orders");
                                  MoultonWebService.RunWebSrvOrderNEWAPIViaReport("Sales Header");
                                  // << DW SBC 2018-07-20
                                END;

               ReqFilterFields=No. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      MoultonWebService@1170000000 : Codeunit 50051;

    BEGIN
    {
      DW SBC 2018-07-16 MN Created Report for Web service call
      DW SBC 2018-07-20 MN commented code and called new function
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Codeunit 50051 Moulton Web Service
{
  OBJECT-PROPERTIES
  {
    Date=07/20/18;
    Time=[ 5:13:24 AM];
    Modified=Yes;
    Version List=SBC;
  }
  PROPERTIES
  {
    OnRun=VAR
            XmlRequest@1170000006 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
            XmlResponse@1170000005 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
            ResponseText@1170000004 : Text[100];
            ResponseNode@1170000003 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
            Itms@1170000002 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
            title@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
            XMLDoc@1170000000 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
          BEGIN
          END;

  }
  CODE
  {
    VAR
      XMLDomMgt@1170000001 : Codeunit 6224;
      i@1170000000 : Integer;
      SOAPNamespace@1170000003 : TextConst 'ENU=http://schemas.xmlsoap.org/soap/envelope/';
      XSDNamespace@1170000002 : TextConst 'ENU=https://moultonordervision.com/Ws/OrderStatusWebService.asmx';
      StrxmlValue@1170000004 : TextConst 'ENU=<![CDATA[<dataQuery><username>ECRK_TST1</username>]<password>KJ67mtrx6gEC45t9</password><group_code>TEST</group_code><order_no>03002952</order_no></dataQuery>]]>';
      StrxmlNodeValue@1170000005 : Text;
      WebSrvCredentials@1170000006 : Record 14000707;
      httpvalue@1170000007 : TextConst 'ENU="https://moultonordervision.com/ws/OrderStatusWebService.asmx/OrderStatus?strxml=<?xml version=''1.0'' encoding=''UTF-8'' standalone=''yes'' ?><dataQuery><username>ECRK_TST1</username><password>KJ67mtrx6gEC45t9</password><group_code>TEST</group_code><order_no>03002952</order_no></dataQuery>"';
      "3PLOrders"@1000000000 : Record 50094;
      ContentTypeTxt@1000000001 : TextConst '@@@={Locked};ENU="multipart/form-data; charset=utf-8";ESM="multipart/form-data; charset=utf-8";FRC="multipart/form-data; charset=utf-8";ENC="multipart/form-data; charset=utf-8"';
      SalesOrder@1170000086 : Record 36;
      "-----Variables-----"@1170000102 : Integer;
      OrderDetailsLineItem@1170000101 : Record 50100;
      MoultonWebService@1170000099 : Codeunit 50051;
      ReferenceNo@1170000098 : Code[20];
      ShipToCompany@1170000096 : Code[35];
      ShipToCompanyConst@1170000095 : Text;
      CdataText1@1170000094 : Text;
      CMEDIAConst@1170000093 : Text;
      CREDCDConst@1170000092 : Text;
      UniqueIDConst@1170000089 : Text;
      ProjectConst@1170000087 : Text;
      DATE_ORD@1170000085 : Date;
      DATE_ORDTxt@1170000084 : Text[10];
      DATE_TRY@1170000083 : Date;
      DATE_TRYTxt@1170000082 : Text[10];
      CMEDIA@1170000081 : Code[8];
      CREDCD@1170000080 : Code[16];
      EXPDTMM@1170000079 : Integer;
      EXPDTYYYY@1170000078 : Integer;
      EXPDTConst@1170000077 : Text;
      AMTPAY@1170000076 : Decimal;
      AMTPAYConst@1170000075 : Text;
      MICRCODE@1170000074 : Code[40];
      MICRCODEConst@1170000073 : Text;
      PAY_TYPEConst@1170000071 : Text;
      NUM_PYMNTS@1170000070 : Integer;
      NUM_PYMNTSConst@1170000069 : Text;
      EMAIL@1170000068 : Text[50];
      EMAILConst@1170000067 : Text;
      F_NAME@1170000066 : Text[16];
      F_NAMEConst@1170000065 : Text;
      L_NAME@1170000064 : Text[24];
      L_NAMEConst@1170000063 : Text;
      ADDR_1@1170000062 : Text[35];
      ADDR_1Const@1170000061 : Text;
      ADDR_2@1170000060 : Text[35];
      ADDR_2Const@1170000059 : Text;
      CITY@1170000058 : Text[28];
      CITYConst@1170000057 : Text;
      ST@1170000056 : Code[2];
      STConst@1170000055 : Text;
      ZIP@1170000054 : Code[10];
      ZIPConst@1170000053 : Text;
      PHONE@1170000052 : Text[10];
      PHONEConst@1170000051 : Text;
      COUNTRY_CODE@1170000050 : Code[3];
      COUNTRY_CODEConst@1170000049 : Text;
      OPT_IN@1170000048 : Code[1];
      OPT_INConst@1170000047 : Text;
      OPT_OUT@1170000046 : Code[1];
      OPT_OUTConst@1170000045 : Text;
      ADJ_CODE@1170000044 : Code[1];
      ADJ_CODEConst@1170000043 : Text;
      AMT_DISC@1170000042 : Code[6];
      AMT_DISCConst@1170000041 : Text;
      BILL_TO_COMPANY@1170000040 : Text[35];
      BILL_TO_COMPANYConst@1170000039 : Text;
      BILL_TO_L_NAME@1170000038 : Text[24];
      BILL_TO_L_NAMEConst@1170000037 : Text;
      BILL_TO_F_NAME@1170000036 : Text[16];
      BILL_TO_F_NAMEConst@1170000035 : Text;
      BILL_TO_ADDR_1@1170000034 : Text[35];
      BILL_TO_ADDR_1Const@1170000033 : Text;
      BILL_TO_ADDR_2@1170000032 : Text[35];
      BILL_TO_ADDR_2Const@1170000031 : Text;
      BILL_TO_CITY@1170000030 : Text[28];
      BILL_TO_CITYConst@1170000029 : Text;
      BILL_TO_ST@1170000028 : Text[2];
      BILL_TO_STConst@1170000027 : Text;
      BILL_TO_ZIP@1170000026 : Text[10];
      BILL_TO_ZIPConst@1170000025 : Text;
      BILL_TO_COUNTRY_CODE@1170000024 : Code[2];
      BILL_TO_COUNTRY_CODEConst@1170000023 : Text;
      HAS_CSTM@1170000022 : Code[1];
      HAS_CSTMConst@1170000021 : Text;
      HAS_FINANCIAL@1170000020 : Code[1];
      HAS_FINANCIALConst@1170000019 : Text;
      HAS_GIFT_REC@1170000018 : Code[1];
      GIFTMessage1@1170000017 : Text[252];
      GIFTMessage2@1170000016 : Text[252];
      GIFTMessage3@1170000015 : Text[252];
      HAS_GIFT_RECConst@1170000014 : Text;
      "--Separate Table --"@1170000013 : Integer;
      QUANTITY_ORDERED@1170000012 : Integer;
      "PART_ NUMBER_OFFER_CODE"@1170000011 : Code[12];
      GIFTMSGConst@1170000010 : Text;
      OrderDetailConst@1170000009 : Text;
      LineItemConst@1170000008 : Text;
      XSDNamespace2@1170000090 : TextConst 'ENU=https://www.moultonordervision.com/Ws/ORDAPI.asmx';
      OrderClosingTag@1170000072 : TextConst 'ENU=</OrderHeader></Order>';

    LOCAL PROCEDURE "------- Order Status ------------"@1000000000();
    BEGIN
    END;

    LOCAL PROCEDURE CreateXMLReq@1170000000(VAR XmlRequestParam@1170000004 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR OrderNo@1170000008 : Code[8]);
    VAR
      RootNode@1170000003 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      Headernode@1170000005 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      BodyNode@1170000002 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      OrdStatusNode@1170000000 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      strXMLNode@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      DataQueryNode@1170000006 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      DataNode@1170000007 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
    BEGIN
      //XmlRequest := XmlRequest.XmlDocument();
      WebSrvCredentials.TESTFIELD("OrderStatus Web Service Link");
      RootNode := XmlRequestParam.CreateNode('element','soapenv:Envelope',SOAPNamespace);
        XMLDomMgt.AddAttribute(RootNode,'xmlns:ord',XSDNamespace);
        XMLDomMgt.AddElement(RootNode,'soapenv:Header','',SOAPNamespace,Headernode);
        XMLDomMgt.AddElement(RootNode,'soapenv:Body','',SOAPNamespace,BodyNode);
        XMLDomMgt.AddElement(BodyNode,'ord:OrderStatus','',XSDNamespace,OrdStatusNode);
        //XMLDomMgt.AddElement(OrdStatusNode,'ord:strXml',StrxmlValue,XSDNamespace,strXMLNode);

        StrxmlNodeValue := '<dataQuery><username>' + WebSrvCredentials."API User" + '</username><password>' +
                            WebSrvCredentials."API Password" + '</password><group_code>' + WebSrvCredentials."Group Code" +
                           '</group_code><order_no>' + OrderNo + '</order_no></dataQuery>';

        XMLDomMgt.AddElement(OrdStatusNode,'ord:strXml','',XSDNamespace,strXMLNode);
        strXMLNode.AppendChild(XmlRequestParam.CreateCDataSection(StrxmlNodeValue));

      XmlRequestParam.AppendChild(RootNode);
      XmlRequestParam.Save(WebSrvCredentials."SOAP Request Path" + OrderNo + '.xml');
    END;

    PROCEDURE RemoveNamespace@1000000001(XMLDocIn@1000000000 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR XMLDocOut@1000000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument");
    VAR
      TempTable@1000000002 : TEMPORARY Record 99008535;
      XMLStyleSheet@1000000003 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
      StyleOutStr@1000000004 : OutStream;
      StyleInStr@1000000005 : InStream;
      Source2@1000000006 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A05-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.DOMDocument60";
      XslTransform@1000000007 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.Xsl.XslTransform";
      nullXsltArgumentList@1000000009 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.Xsl.XsltArgumentList";
      writer@1000000010 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.StringWriter";
    BEGIN
      XslTransform:=XslTransform.XslTransform;
      XMLStyleSheet:=XMLStyleSheet.XmlDocument;
      XMLStyleSheet.InnerXml('<?xml version="1.0" encoding="UTF-8"?>'+
      '<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">'+
      '<xsl:output method="xml" encoding="UTF-8" />' +
      '<xsl:template match="/">'+
      '<xsl:copy>'+
      '<xsl:apply-templates />'+
      '</xsl:copy>'+
      '</xsl:template>'+
      '<xsl:template match="*">'+
      '<xsl:element name="{local-name()}">'+
      '<xsl:apply-templates select="@* | node()" />'+
      '</xsl:element>'+
      '</xsl:template>'+
      '<xsl:template match="@*">'+
      '<xsl:attribute name="{local-name()}"><xsl:value-of select="."/></xsl:attribute>'+
      '</xsl:template>'+
      '<xsl:template match="text() | processing-instruction() | comment()">'+
      '<xsl:copy />'+
      '</xsl:template>'+
      '</xsl:stylesheet>'
      );
      XslTransform.Load(XMLStyleSheet);
      writer:=writer.StringWriter();
      XslTransform.Transform(XMLDocIn,nullXsltArgumentList,writer);
      XMLDocOut:=XMLDocOut.XmlDocument;
      XMLDocOut.InnerXml(writer.ToString());
    END;

    LOCAL PROCEDURE CallWebServices@1000000005(VAR XMLRequest@1000000004 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR XMLResponse@1000000005 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR DBCode@1170000003 : Code[4];VAR WSOrderNo@1170000002 : Code[8]) : Boolean;
    VAR
      HttpWebRequest@1000000001 : DotNet "'System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.HttpWebRequest";
      HttpWebResponse@1000000000 : DotNet "'System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.HttpWebResponse";
      TypeValue@1000000006 : TextConst 'ENU=text/xml';
      Method@1000000003 : TextConst 'ENU=POST';
      SOAPAction@1000000002 : TextConst 'ENU=SOAPAction';
      ContentType@1000000007 : TextConst 'ENU=Content-type';
      TypeValue2@1170000000 : TextConst 'ENU="text/xml;charset=\utf-8\"';
      Itms@1000 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
      title@1001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      ResponseText@1002 : Text[100];
      GetEntryNo@1170000001 : Integer;
    BEGIN
      //HttpWebRequest := HttpWebRequest.Create('https://moultonordervision.com/ws/OrderStatusWebService.asmx');
      HttpWebRequest := HttpWebRequest.Create(WebSrvCredentials."OrderStatus Web Service Link");
      HttpWebRequest.UseDefaultCredentials := TRUE;
      HttpWebRequest.Method := Method;
      HttpWebRequest.ContentType := TypeValue2;
      HttpWebRequest.PreAuthenticate := TRUE;
      //HttpWebRequest.Headers.Add(SOAPAction,'default');
      XMLRequest.Save(HttpWebRequest.GetRequestStream);
      HttpWebResponse := HttpWebRequest.GetResponse;

      IF HttpWebResponse.StatusCode = 200 THEN BEGIN
        XMLResponse.Load(HttpWebResponse.GetResponseStream);
        InsertXMLTransaction(XMLRequest,XMLResponse,DBCode,GetEntryNo);
        RemoveNamespace(XMLResponse,XMLResponse);
        XMLResponse.Save(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml');
        XMLResponse.Load(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml');
        ReadResponse(XMLResponse,GetEntryNo);

        IF EXISTS(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml');

        IF EXISTS(WebSrvCredentials."SOAP Request Path" + WSOrderNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Request Path" + WSOrderNo + '.xml');

        "3PLOrders"."3PL Response Code" := '200';
        "3PLOrders".MODIFY;
        EXIT(TRUE);

      END ELSE BEGIN
        XMLResponse.Load(HttpWebResponse.GetResponseStream);
        InsertXMLTransaction(XMLRequest,XMLResponse,DBCode,GetEntryNo);
        RemoveNamespace(XMLResponse,XMLResponse);
        XMLResponse.Save(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml');
        XMLResponse.Load(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml');
        ReadResponse(XMLResponse,GetEntryNo);

        IF EXISTS(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Response Path" + WSOrderNo + '.xml');

        IF EXISTS(WebSrvCredentials."SOAP Request Path" + WSOrderNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Request Path" + WSOrderNo + '.xml');
        "3PLOrders"."3PL Response Code" := FORMAT(HttpWebResponse.StatusCode);
        "3PLOrders".MODIFY;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE InsertXMLTransaction@1170000003(VAR XMLRequestParam@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR XMLResponseParam@1170000000 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR DBCode@1170000010 : Code[10];VAR TrackEntry@1170000009 : Integer);
    VAR
      SOWebServiceHistory@1170000002 : Record 50097;
      Entry@1170000003 : Integer;
      OStream@1170000004 : OutStream;
      OStream2@1170000008 : OutStream;
      Itms@1170000006 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
      ElementDataValue@1170000005 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      i@1170000007 : Integer;
    BEGIN
      IF SOWebServiceHistory.FINDLAST THEN
        Entry := SOWebServiceHistory."Entry No.";

      SOWebServiceHistory.RESET;

      SOWebServiceHistory.INIT;
      SOWebServiceHistory."Entry No." := Entry + 1;
      SOWebServiceHistory."User ID" := USERID;
      SOWebServiceHistory."File Extension" := 'xml';
      SOWebServiceHistory."DB Code" := WebSrvCredentials."DB Code";
      SOWebServiceHistory."SOAP Request DateTime" := CURRENTDATETIME;
      SOWebServiceHistory."SOAP Request".CREATEOUTSTREAM(OStream);
      XMLRequestParam.Save(OStream);

      SOWebServiceHistory."SOAP Response".CREATEOUTSTREAM(OStream2);
      XMLResponseParam.Save(OStream2);

      CLEAR(OStream2);
      "3PLOrders"."3PL Acknowledgment".CREATEOUTSTREAM(OStream2);
      XMLResponseParam.Save(OStream2);
      "3PLOrders".MODIFY;

      IF SOWebServiceHistory.INSERT THEN
        TrackEntry := SOWebServiceHistory."Entry No.";
    END;

    LOCAL PROCEDURE ReadResponse@1170000005(VAR XMLResponseParam@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR TrackEntry@1170000000 : Integer);
    VAR
      Itms@1170000004 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
      title@1170000003 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      ResponseText@1170000002 : Text[100];
      SOWebServiceHistory@1170000005 : Record 50097;
      InvalidDateCheck@1170000006 : Integer;
      BalanceValue@1170000007 : Decimal;
      CounterValue@1170000008 : Integer;
      DeclineCode@1170000009 : Code[10];
    BEGIN
      IF SOWebServiceHistory.GET(TrackEntry) THEN;

      Itms := XMLResponseParam.SelectNodes('Envelope/Body/OrderStatusResponse/OrderStatusResult/dataResponse');
      FOR i := 0 TO Itms.Count - 1 DO BEGIN
          title := Itms.Item(i).SelectSingleNode('status/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN BEGIN
              SOWebServiceHistory."WS Status" := ResponseText;
              //>> WS SBC 2018-07-14
              "3PLOrders"."3PL Status" := ResponseText;
              "3PLOrders".MODIFY;
              //<< WS SBC 2018-07-14
            END;
          END;
          title := Itms.Item(i).SelectSingleNode('message/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN BEGIN
              SOWebServiceHistory."WS Message" := ResponseText;
              //>> WS SBC 2018-07-14
              "3PLOrders"."3PL Message":= COPYSTR(ResponseText,1,250);
              "3PLOrders".MODIFY;
              //<< WS SBC 2018-07-14
            END;
          END;

          title := Itms.Item(i).SelectSingleNode('group_code/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN
              SOWebServiceHistory."Group code" := ResponseText;
          END;

          title := Itms.Item(i).SelectSingleNode('order_no/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN BEGIN
              SOWebServiceHistory."Order No." := ResponseText;
              SOWebServiceHistory."3PL Code" := "3PLOrders"."3PL Code";
            END;
          END;
      END;

      Itms := XMLResponseParam.SelectNodes('Envelope/Body/OrderStatusResponse/OrderStatusResult/dataResponse/OrderStatus');
      FOR i := 0 TO Itms.Count - 1 DO BEGIN
          title := Itms.Item(i).SelectSingleNode('OrderDate/text()');
          IF NOT ISNULL(title) THEN BEGIN
            CLEAR(InvalidDateCheck);
            IF EVALUATE(InvalidDateCheck,title.Value) THEN
              IF InvalidDateCheck <> 0 THEN BEGIN
                SOWebServiceHistory."Order Date":= ConverttoDate(FORMAT(InvalidDateCheck));
                SOWebServiceHistory."Order Status" := SOWebServiceHistory."Order Status"::Open;
                "3PLOrders".Status := "3PLOrders".Status::Open;
                "3PLOrders".MODIFY;
              END;
          END;

          CLEAR(InvalidDateCheck);
          title := Itms.Item(i).SelectSingleNode('ProcessDate/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(InvalidDateCheck,title.Value) THEN
              IF InvalidDateCheck <> 0 THEN
                SOWebServiceHistory."Process Date" := ConverttoDate(FORMAT(InvalidDateCheck));
          END;

          CLEAR(InvalidDateCheck);
          title := Itms.Item(i).SelectSingleNode('ShipDate/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(InvalidDateCheck,title.Value) THEN
              IF InvalidDateCheck <> 0 THEN BEGIN
                SOWebServiceHistory.ShipDate := ConverttoDate(FORMAT(InvalidDateCheck));
                SOWebServiceHistory."Order Status" := SOWebServiceHistory."Order Status"::Shipped;
                "3PLOrders".Status := "3PLOrders".Status::Shipped;
                "3PLOrders".MODIFY;
              END;
          END;

          CLEAR(InvalidDateCheck);
          title := Itms.Item(i).SelectSingleNode('CancelationDate/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(InvalidDateCheck,title.Value) THEN
              IF InvalidDateCheck <> 0 THEN BEGIN
                SOWebServiceHistory."Cancellation Date" := ConverttoDate(FORMAT(InvalidDateCheck));
                SOWebServiceHistory."Order Status" := SOWebServiceHistory."Order Status"::Cancelled;
                "3PLOrders".Status := "3PLOrders".Status::Cancelled;
                "3PLOrders".MODIFY;
              END;
          END;

          title := Itms.Item(i).SelectSingleNode('CarrierCode/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN
              SOWebServiceHistory.CarrierCode := COPYSTR(ResponseText,1,4);
          END;

          title := Itms.Item(i).SelectSingleNode('ServiceCode/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN
              SOWebServiceHistory.ServiceCode := COPYSTR(ResponseText,1,2);
          END;

          title := Itms.Item(i).SelectSingleNode('TrackingNo/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN
              SOWebServiceHistory.TrackingNo := title.Value;
          END;

          CLEAR(BalanceValue);
          title := Itms.Item(i).SelectSingleNode('Balance/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(BalanceValue,title.Value) THEN
              IF BalanceValue <> 0 THEN
                SOWebServiceHistory.Balance := BalanceValue;
          END;

          title := Itms.Item(i).SelectSingleNode('PayType/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN BEGIN
              {
              CASE ResponseText OF
                'P':SOWebServiceHistory.PayType :=SOWebServiceHistory.PayType::"3";
                'C':SOWebServiceHistory.PayType :=SOWebServiceHistory.PayType::"1";
                'K':SOWebServiceHistory.PayType :=SOWebServiceHistory.PayType::"2";
                'R':SOWebServiceHistory.PayType :=SOWebServiceHistory.PayType::"4";
              END;
              }
              SOWebServiceHistory.PayType := ResponseText;
            END;
          END;

          title := Itms.Item(i).SelectSingleNode('OrderType/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF title.Value <> '' THEN
              IF EVALUATE(ResponseText,title.Value) THEN
                SOWebServiceHistory.OrderType := ResponseText;
          END;

          title := Itms.Item(i).SelectSingleNode('ShipBatch/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN
              SOWebServiceHistory.ShipBatch := ResponseText;
          END;

          CLEAR(InvalidDateCheck);
          title := Itms.Item(i).SelectSingleNode('NextPaymentDate/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(InvalidDateCheck,title.Value) THEN
              IF InvalidDateCheck <> 0 THEN
                SOWebServiceHistory.NextPaymentDate := ConverttoDate(FORMAT(InvalidDateCheck));
          END;

          CLEAR(BalanceValue);
          title := Itms.Item(i).SelectSingleNode('NextPaymentAmount/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(BalanceValue,title.Value) THEN
              IF BalanceValue <> 0 THEN
                SOWebServiceHistory.NextPaymentAmount := BalanceValue;
          END;

          CLEAR(CounterValue);
          title := Itms.Item(i).SelectSingleNode('DeclineCounterValue/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(CounterValue,title.Value) THEN
              IF CounterValue <> 0 THEN
                SOWebServiceHistory.DeclineCounterValue:= CounterValue;
          END;

          CLEAR(BalanceValue);
          title := Itms.Item(i).SelectSingleNode('BalanceDue/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(BalanceValue,title.Value) THEN
              IF BalanceValue <> 0 THEN
                SOWebServiceHistory.BalanceDue := BalanceValue;
          END;

          CLEAR(DeclineCode);
          title := Itms.Item(i).SelectSingleNode('LastDeclineCode/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(DeclineCode,title.Value) THEN
              IF DeclineCode <> '' THEN
                SOWebServiceHistory.LastDeclineCode := DeclineCode;
          END;

          CLEAR(InvalidDateCheck);
          title := Itms.Item(i).SelectSingleNode('LastPaymentDate/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(InvalidDateCheck,title.Value) THEN
              IF InvalidDateCheck <> 0 THEN
                SOWebServiceHistory.LastPaymentDate := ConverttoDate(FORMAT(InvalidDateCheck));
          END;

          CLEAR(CounterValue);
          title := Itms.Item(i).SelectSingleNode('LastPaymentNumber/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(CounterValue,title.Value) THEN
              IF CounterValue <> 0 THEN
                SOWebServiceHistory.LastPaymentNumber:= CounterValue;
          END;

      END;
      SOWebServiceHistory.MODIFY;
    END;

    LOCAL PROCEDURE ConverttoDate@1170000004(DateCode@1170000000 : Code[8]) : Date;
    VAR
      YYYY@1170000001 : Integer;
      MM@1170000002 : Integer;
      DD@1170000003 : Integer;
    BEGIN
      // EVALUATE(YYYY,COPYSTR(DateCode,1,4));
      // EVALUATE(MM,COPYSTR(DateCode,5,2));
      // EVALUATE(DD,COPYSTR(DateCode,7,2));
      // EXIT(DMY2DATE(DD,MM,YYYY));

      IF DateCode = '' THEN
        EXIT(0D);

      IF NOT EVALUATE(YYYY,COPYSTR(DateCode,1,4)) THEN
        EXIT(0D);

      IF (YYYY < 1) OR (YYYY > 9999) THEN
        EXIT(0D);

      IF NOT EVALUATE(MM,COPYSTR(DateCode,5,2)) THEN
        EXIT(0D);

      IF (MM < 1) OR (MM > 12) THEN
        EXIT(0D);

      IF NOT EVALUATE(DD,COPYSTR(DateCode,7,2)) THEN
        EXIT(0D);

      IF (DD < 1) OR (DD > DATE2DMY(CALCDATE('<+1M-1D>',DMY2DATE(1,MM,YYYY)),1)) THEN
        EXIT(0D);

      EXIT(DMY2DATE(DD,MM,YYYY));
    END;

    PROCEDURE RunWSOrderNo@1170000006(DBCode@1170000003 : Code[4];WSPLCode@1000000000 : Code[10];WSOrderNo@1170000000 : Code[8]);
    VAR
      XmlRequest@1170000002 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
      XmlResponse@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
    BEGIN
      CheckCredentials(DBCode);
      IF "3PLOrders".GET(WSPLCode,WSOrderNo) THEN BEGIN
        XmlRequest := XmlRequest.XmlDocument();
        XmlResponse := XmlResponse.XmlDocument();
        CreateXMLReq(XmlRequest,WSOrderNo);
        IF CallWebServices(XmlRequest,XmlResponse,DBCode,WSOrderNo) THEN
          MESSAGE('Request Processed Successfully')
        ELSE
          MESSAGE('Error processing Request');
      END;
    END;

    LOCAL PROCEDURE CheckCredentials@1170000001(DBCode@1170000000 : Code[4]);
    BEGIN
      WebSrvCredentials.GET;
      WebSrvCredentials.TESTFIELD("DB Code");
      WebSrvCredentials.TESTFIELD("API User");
      WebSrvCredentials.TESTFIELD("API Password");
      WebSrvCredentials.TESTFIELD("Group Code");
      WebSrvCredentials.TESTFIELD("SOAP Request Path");
      WebSrvCredentials.TESTFIELD("SOAP Response Path");
    END;

    PROCEDURE RunWSOrderNoViaReport@1000000002(DBCode@1170000003 : Code[4];WSPLCode@1000000000 : Code[10];WSOrderNo@1170000000 : Code[8]);
    VAR
      XmlRequest@1170000002 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
      XmlResponse@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
    BEGIN
      CheckCredentials(DBCode);
      IF "3PLOrders".GET(WSPLCode,WSOrderNo) THEN BEGIN
        XmlRequest := XmlRequest.XmlDocument();
        XmlResponse := XmlResponse.XmlDocument();
        CreateXMLReq(XmlRequest,WSOrderNo);
        IF CallWebServices(XmlRequest,XmlResponse,DBCode,WSOrderNo) THEN
        BEGIN END ELSE // DW SBC 201-07-16
          ErrorLogWebHistory(DBCode,WSPLCode,WSOrderNo,'','No Response generated for Order No. '+ WSOrderNo); //DW SBC 201-07-16
      END;
    END;

    PROCEDURE WebSrvOrderStatus@1170000009(DBCode@1000000002 : Code[4];WSPLCode@1000000001 : Code[10];WSOrderNo@1000000000 : Code[10]);
    BEGIN
      //>> DW SBC 2018-07-16
      IF STRLEN(WSOrderNo) <= 8 THEN
        RunWSOrderNoViaReport(DBCode,WSPLCode,COPYSTR(WSOrderNo,1,8))
      ELSE
        ErrorLogWebHistory(DBCode,WSPLCode,WSOrderNo,'Order No. ' + WSOrderNo +'is more than 8 characters',''); //DW SBC 201-07-16
      //<< DW SBC 201-07-16
    END;

    LOCAL PROCEDURE ErrorLogWebHistory@1170000008(DBCode@1000000004 : Code[4];WSPLCode@1000000003 : Code[10];WSOrderNo@1000000002 : Code[10];OrderNoExceed@1000000001 : Text[250];NoResponse@1000000000 : Text[250]);
    BEGIN
      //>> DW SBC 2018-07-16
      IF "3PLOrders".GET(WSPLCode,WSOrderNo) THEN BEGIN
        IF OrderNoExceed <> '' THEN
          "3PLOrders"."3PL Message" := OrderNoExceed;
        IF NoResponse <> '' THEN
          "3PLOrders"."3PL Message" := NoResponse;
        "3PLOrders".MODIFY;
      END;
      //<< DW SBC 2018-07-16
    END;

    LOCAL PROCEDURE "----- OrderNew API -------"@1000000003();
    BEGIN
    END;

    PROCEDURE CallOrderAPIWS@1000000006(VAR XMLRequest@1000000002 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR XMLResponse@1000000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR DBCode@1000000000 : Code[4];ReferenceNo@1000000014 : Code[20]) : Boolean;
    VAR
      HttpWebRequest@1000000008 : DotNet "'System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.HttpWebRequest";
      HttpWebResponse@1000000007 : DotNet "'System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.HttpWebResponse";
      Itms@1000000006 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
      title@1000000005 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      ResponseText@1000000004 : Text[100];
      GetEntryNo@1000000003 : Integer;
      TypeValue@1000000013 : TextConst 'ENU=text/xml';
      Method@1000000012 : TextConst 'ENU=POST';
      SOAPAction@1000000011 : TextConst 'ENU=SOAPAction';
      ContentType@1000000010 : TextConst 'ENU=Content-type';
      TypeValue2@1000000009 : TextConst 'ENU="text/xml;charset=\utf-8\"';
      Method2@1000000015 : TextConst 'ENU=GET';
      SOAPTextConst@1000000016 : TextConst 'ENU=https://www.moultonordervision.com/Ws/ORDAPI.asmx/OrderNewAPI\';
      DecompressionMethods@1000000017 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.DecompressionMethods";
      NetCredential@1170000000 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.NetworkCredential";
    BEGIN
      //>> DW SBC 2018-07-16
      CheckCredentials(DBCode);
      WebSrvCredentials.TESTFIELD("OrderNewAPITrackable URL");
      HttpWebRequest := HttpWebRequest.Create(WebSrvCredentials."OrderNewAPITrackable URL");
      HttpWebRequest.Method := Method;
      HttpWebRequest.KeepAlive := TRUE;
      HttpWebRequest.AllowAutoRedirect := TRUE;
      // NetCredential := NetCredential.NetworkCredential('ECRK_TST1','KJ67mtrx6gEC45t9');
      // HttpWebRequest.Credentials := NetCredential;
      HttpWebRequest.UseDefaultCredentials := TRUE;
      HttpWebRequest.ContentType := TypeValue2;
      //HttpWebRequest.Headers.Add(SOAPAction,'\' + SOAPTextConst );
      HttpWebRequest.Timeout :=   600000;;
      HttpWebRequest.AutomaticDecompression := DecompressionMethods.GZip;

      XMLRequest.Save(HttpWebRequest.GetRequestStream);
      HttpWebResponse := HttpWebRequest.GetResponse;

      IF HttpWebResponse.StatusCode = 200 THEN BEGIN
        XMLResponse.Load(HttpWebResponse.GetResponseStream);
        InsertNewOrderAPITransaction(XMLRequest,XMLResponse,DBCode,GetEntryNo,ReferenceNo);
        RemoveNamespace(XMLResponse,XMLResponse);
        XMLResponse.Save(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml');
        XMLResponse.Load(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml');
        ReadResponseOrderAPI(XMLResponse,GetEntryNo);

        IF EXISTS(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml');

        IF EXISTS(WebSrvCredentials."SOAP Request Path" + ReferenceNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Request Path" + ReferenceNo + '.xml');

        EXIT(TRUE);

      END ELSE BEGIN
        XMLResponse.Load(HttpWebResponse.GetResponseStream);
        InsertNewOrderAPITransaction(XMLRequest,XMLResponse,DBCode,GetEntryNo,ReferenceNo);
        RemoveNamespace(XMLResponse,XMLResponse);
        XMLResponse.Save(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml');
        XMLResponse.Load(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml');
        ReadResponseOrderAPI(XMLResponse,GetEntryNo);

        IF EXISTS(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Response Path" + ReferenceNo + '.xml');

        IF EXISTS(WebSrvCredentials."SOAP Request Path" + ReferenceNo + '.xml') THEN
          ERASE(WebSrvCredentials."SOAP Request Path" + ReferenceNo + '.xml');
        EXIT(FALSE);
      END;
      //<< DW SBC 2018-07-16
    END;

    LOCAL PROCEDURE InsertNewOrderAPITransaction@1000000008(VAR XMLRequestParam@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR XMLResponseParam@1170000000 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR DBCode@1170000010 : Code[10];VAR TrackEntry@1000000001 : Integer;VAR RefNo@1000000000 : Code[20]);
    VAR
      SOWebServiceHistory@1170000002 : Record 50097;
      Entry@1170000003 : Integer;
      OStream@1170000004 : OutStream;
      OStream2@1170000008 : OutStream;
      Itms@1170000006 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
      ElementDataValue@1170000005 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      i@1170000007 : Integer;
    BEGIN
      //>> DW SBC 2018-07-16
      IF SOWebServiceHistory.FINDLAST THEN
        Entry := SOWebServiceHistory."Entry No.";
      SOWebServiceHistory.RESET;
      SOWebServiceHistory.INIT;
      SOWebServiceHistory."Entry No." := Entry + 1;
      SOWebServiceHistory."User ID" := USERID;
      SOWebServiceHistory.ShipBatch := 'OrderNEWAPI';
      //SOWebServiceHistory."3PL Code" := 'WEB';
      //SOWebServiceHistory."Order No." := "3PLOrders"."Order No.";
      SOWebServiceHistory."File Extension" := 'xml';
      SOWebServiceHistory."DB Code" := DBCode;
      SOWebServiceHistory."SOAP Request DateTime" := CURRENTDATETIME;
      SOWebServiceHistory."SOAP Request".CREATEOUTSTREAM(OStream);
      XMLRequestParam.Save(OStream);
      XMLRequestParam.Save(WebSrvCredentials."SOAP Request Path" + FORMAT(Entry + 1) + 'Request.xml');

      SOWebServiceHistory."SOAP Response".CREATEOUTSTREAM(OStream2);
      XMLResponseParam.Save(OStream2);
      XMLResponseParam.Save(WebSrvCredentials."SOAP Response Path" + FORMAT(Entry + 1) + 'Response.xml');

      //IF "3PL" THEN BEGIN
      //  CLEAR(OStream2);;
      //  "3PLOrders"."3PL Acknowledgment".CREATEOUTSTREAM(OStream2);
      //  XMLResponseParam.Save(OStream2);
      //  "3PLOrders".MODIFY;
      //END;

      SOWebServiceHistory.TrackingNo := SalesOrder."No.";

      IF SOWebServiceHistory.INSERT THEN
        TrackEntry := SOWebServiceHistory."Entry No.";
      //<< DW SBC 2018-07-16
    END;

    LOCAL PROCEDURE ReadResponseOrderAPI@1000000021(VAR XMLResponseParam@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR TrackEntry@1170000000 : Integer);
    VAR
      Itms@1170000004 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
      title@1170000003 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      ResponseText@1170000002 : Text[100];
      SOWebServiceHistory@1170000005 : Record 50097;
      InvalidDateCheck@1170000006 : Integer;
      BalanceValue@1170000007 : Decimal;
      CounterValue@1170000008 : Integer;
      DeclineCode@1170000009 : Code[10];
      ordno@1000000000 : Integer;
    BEGIN
      //>> DW SBC 2018-07-16
      IF SOWebServiceHistory.GET(TrackEntry) THEN;

      Itms := XMLResponseParam.SelectNodes('Envelope/Body/OrderNewAPIResponse/OrderNewAPIResult/Value');
      FOR i := 0 TO Itms.Count - 1 DO BEGIN
          title := Itms.Item(i).SelectSingleNode('Status/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN BEGIN
              SOWebServiceHistory."WS Status" := ResponseText;
      //        "3PLOrders"."3PL Status" := ResponseText;
      //        "3PLOrders".MODIFY;
            END;
          END;
          title := Itms.Item(i).SelectSingleNode('ErrorMsg/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN BEGIN
              SOWebServiceHistory."WS Message" := ResponseText;
      //        "3PLOrders"."3PL Message" := ResponseText;
      //        "3PLOrders".MODIFY;
            END;
          END;
          title := Itms.Item(i).SelectSingleNode('message/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN BEGIN
              SOWebServiceHistory."WS Message" := ResponseText;
      //        "3PLOrders"."3PL Message" := ResponseText;
      //        "3PLOrders".MODIFY;
            END;
          END;

          title := Itms.Item(i).SelectSingleNode('Order/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN
              //SOWebServiceHistory.TrackingNo := ResponseText;
              SOWebServiceHistory."3PL Code" := COPYSTR(ResponseText,5,12);
          END;

          title := Itms.Item(i).SelectSingleNode('ErrorCode/text()');
          IF NOT ISNULL(title) THEN BEGIN
            IF EVALUATE(ResponseText,title.Value) THEN
              SOWebServiceHistory."3PL Response Code":= ResponseText;
          END;

      END;

      SOWebServiceHistory.MODIFY;
      IF EVALUATE(ordno,SOWebServiceHistory."3PL Code") THEN
        IF ordno > 0 THEN
          Insert3PL(SOWebServiceHistory."Entry No."); // DW SBC 2018-07-20
      //<< DW SBC 2018-07-16
    END;

    LOCAL PROCEDURE CreateXMLRequestOrderNew@1170000002(VAR XmlRequest@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";VAR XmlResponse@1170000000 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument") : Boolean;
    VAR
      RootNode@1000000005 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      Headernode@1000000004 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      BodyNode@1000000003 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      OrdXMLNode@1000000002 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      OrderNewAPITrackable@1000000006 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      Crendential@1000000007 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
    BEGIN
      //>> DW SBC 2018-07-16
      WebSrvCredentials.GET;
      CheckCredentials(WebSrvCredentials."DB Code");
      WebSrvCredentials.TESTFIELD(WebSrvCredentials.CLNo);
      WebSrvCredentials.TESTFIELD(WebSrvCredentials.PROJECT);
      WebSrvCredentials.TESTFIELD(WebSrvCredentials.CSOURCE);
      WebSrvCredentials.TESTFIELD(WebSrvCredentials.XMLFormatCode);
      WebSrvCredentials.TESTFIELD(WebSrvCredentials."OrderNewAPITrackable URL");
      WebSrvCredentials.TESTFIELD(WebSrvCredentials.Company);
      WebSrvCredentials.TESTFIELD(WebSrvCredentials.PAY_TYPE);
      XmlRequest := XmlRequest.XmlDocument();
      XmlResponse := XmlResponse.XmlDocument();
      RootNode := XmlRequest.CreateNode('element','soapenv:Envelope',SOAPNamespace);
        XMLDomMgt.AddAttribute(RootNode,'xmlns:ord',XSDNamespace2);
        XMLDomMgt.AddElement(RootNode,'soapenv:Header','',SOAPNamespace,Headernode);
        XMLDomMgt.AddElement(RootNode,'soapenv:Body','',SOAPNamespace,BodyNode);
        XMLDomMgt.AddElement(BodyNode,'ord:OrderNewAPI','',XSDNamespace2,OrderNewAPITrackable);
        XMLDomMgt.AddElement(OrderNewAPITrackable,'ord:UserName',WebSrvCredentials."API User",XSDNamespace2,Crendential);
        XMLDomMgt.AddElement(OrderNewAPITrackable,'ord:Password',WebSrvCredentials."API Password",XSDNamespace2,Crendential);
        XMLDomMgt.AddElement(OrderNewAPITrackable,'ord:GroupCode',WebSrvCredentials."Group Code",XSDNamespace2,Crendential);
        XMLDomMgt.AddElement(OrderNewAPITrackable,'ord:ClNo',WebSrvCredentials.CLNo,XSDNamespace2,Crendential);
        XMLDomMgt.AddElement(OrderNewAPITrackable,'ord:Project',WebSrvCredentials.PROJECT,XSDNamespace2,Crendential);
        XMLDomMgt.AddElement(OrderNewAPITrackable,'ord:XMLFormatCode',WebSrvCredentials.XMLFormatCode,XSDNamespace2,Crendential);
        XMLDomMgt.AddElement(OrderNewAPITrackable,'ord:OrdXML','',XSDNamespace2,OrdXMLNode);

        UpdateNodes;
        CdataText1 := '<Order><OrderHeader><GROUP_CODE>' + WebSrvCredentials."Group Code" + '</GROUP_CODE><DATE_ORD>'+DATE_ORDTxt+ '</DATE_ORD>'
        + '<CL_NO>' + WebSrvCredentials.CLNo + '</CL_NO><CSOURCE>' + WebSrvCredentials.CSOURCE +'</CSOURCE>';

        OrdXMLNode.AppendChild(XmlRequest.CreateCDataSection(CdataText1 + CMEDIAConst+ CREDCDConst + EXPDTConst + ProjectConst +
        AMTPAYConst + MICRCODEConst + PAY_TYPEConst + NUM_PYMNTSConst + EMAILConst + ShipToCompanyConst + F_NAMEConst + L_NAMEConst +
        ADDR_1Const + ADDR_2Const + CITYConst + STConst + ZIPConst + PHONEConst + COUNTRY_CODEConst + OPT_INConst + OPT_OUTConst +
        ADJ_CODEConst + AMT_DISCConst + BILL_TO_COMPANYConst + BILL_TO_L_NAMEConst + BILL_TO_F_NAMEConst + BILL_TO_ADDR_1Const +
        BILL_TO_ADDR_2Const + BILL_TO_CITYConst + BILL_TO_STConst + BILL_TO_ZIPConst + BILL_TO_COUNTRY_CODEConst + UniqueIDConst + HAS_FINANCIALConst+
        HAS_CSTMConst + HAS_GIFT_RECConst + '</OrderHeader>' + OrderDetailConst + '<CSTM></CSTM><FINANCIAL></FINANCIAL>' + GIFTMSGConst + '</Order>'));

      XmlRequest.AppendChild(RootNode);

      IF CallOrderAPIWS(XmlRequest,XmlResponse,WebSrvCredentials."DB Code",ReferenceNo) THEN
        EXIT(TRUE);
      EXIT(FALSE);
      //<< DW SBC 2018-07-16
    END;

    LOCAL PROCEDURE UpdateNodes@1170000007();
    VAR
      MMText@1000000000 : Text[2];
      DDText@1170000000 : Text[2];
      Customer@1170000001 : Record 18;
      SalesLine@1170000002 : Record 37;
    BEGIN
      //>> DW SBC 2018-07-16
      DATE_ORD := SalesOrder."Order Date";
      IF (DATE2DMY(DATE_ORD,2) IN [1..9]) THEN
        MMText := '0' +  FORMAT(DATE2DMY(DATE_ORD,2))
      ELSE
        MMText := FORMAT(DATE2DMY(DATE_ORD,2));

      IF (DATE2DMY(DATE_ORD,1) IN [1..9]) THEN
        DDText := '0' + FORMAT(DATE2DMY(DATE_ORD,1))
      ELSE
        DDText := FORMAT(DATE2DMY(DATE_ORD,1));

      DATE_ORDTxt := FORMAT(DATE2DMY(DATE_ORD,3)) + MMText + DDText;

      CMEDIAConst := '<CMEDIA>' + CMEDIA + '</CMEDIA>';
      //CREDCDConst := '<CREDCD>' + CREDCD +'</CREDCD>';
      CREDCDConst := '<CREDCD></CREDCD>';
      //EXPDTConst := '<EXPDT>' + FORMAT(EXPDTMM) +  COPYSTR(FORMAT(EXPDTYYYY),3,2) + '</EXPDT>';
      EXPDTConst := '<EXPDT></EXPDT>';
      ProjectConst := '<PROJECT>' + WebSrvCredentials.PROJECT + '</PROJECT>';
      AMTPAYConst := '<AMTPAY>' + FORMAT(AMTPAY) +'</AMTPAY>';
      MICRCODEConst := '<MICRCODE>' + MICRCODE + '</MICRCODE>';
      PAY_TYPEConst := '<PAY_TYPE>' + WebSrvCredentials.PAY_TYPE + '</PAY_TYPE>';
      NUM_PYMNTSConst := '<NUM_PYMNTS>' + FORMAT(1) + '</NUM_PYMNTS>';

      Customer.GET(SalesOrder."Sell-to Customer No.");
      EMAILConst := '<EMAIL>' + COPYSTR(Customer."E-Mail",1,50) + '</EMAIL>';

      ShipToCompanyConst := '<COMPANY>' + WebSrvCredentials.Company + '</COMPANY>';

      F_NAMEConst := '<F_NAME>' + COPYSTR(SalesOrder."Sell-to Customer Name",1,16) + '</F_NAME>';
      L_NAMEConst := '<L_NAME>' + COPYSTR(SalesOrder."Sell-to Customer Name",17,24) + '</L_NAME>';
      ADDR_1Const := '<ADDR_1>' + COPYSTR(SalesOrder."Sell-to Address",1,35) + '</ADDR_1>';
      ADDR_2Const := '<ADDR_2>' + COPYSTR(SalesOrder."Sell-to Address 2",1,35) + '</ADDR_2>';
      CITYConst := '<CITY>' + COPYSTR(SalesOrder."Sell-to City",1,28) + '</CITY>';
      STConst := '<ST>' + COPYSTR(SalesOrder."Sell-to County",1,2)+ '</ST>';
      ZIPConst := '<ZIP>' + COPYSTR(SalesOrder."Sell-to Post Code",1,10) + '</ZIP>';
      PHONEConst := '<PHONE>' + COPYSTR(SalesOrder."Sell-to Contact",1,10) + '</PHONE>';
      COUNTRY_CODEConst := '<COUNTRY_CODE>' + COPYSTR(SalesOrder."Sell-to Country/Region Code",1,3) + '</COUNTRY_CODE>';
      OPT_INConst := '<OPT_IN>' + OPT_IN + '</OPT_IN>';
      OPT_OUTConst := '<OPT_OUT>' + OPT_OUT + '</OPT_OUT>';
      ADJ_CODEConst := '<ADJ_CODE>' + ADJ_CODE + '</ADJ_CODE>';
      AMT_DISCConst := '<AMT_DISC>' + AMT_DISC + '</AMT_DISC>';
      BILL_TO_COMPANYConst := '<BILL_TO_COMPANY>' + WebSrvCredentials."BILL TO Company" + '</BILL_TO_COMPANY>';
      BILL_TO_L_NAMEConst := '<BILL_TO_L_NAME>' + COPYSTR(SalesOrder."Sell-to Customer Name",16,24) + '</BILL_TO_L_NAME>';
      BILL_TO_F_NAMEConst := '<BILL_TO_F_NAME>' + COPYSTR(SalesOrder."Bill-to Name",17,24) + '</BILL_TO_F_NAME>';
      BILL_TO_ADDR_1Const := '<BILL_TO_ADDR_1>' + COPYSTR(SalesOrder."Bill-to Address",1,35) + '</BILL_TO_ADDR_1>';
      BILL_TO_ADDR_2Const := '<BILL_TO_ADDR_2>' + COPYSTR(SalesOrder."Bill-to Address 2",1,35)  + '</BILL_TO_ADDR_2>';
      BILL_TO_CITYConst := '<BILL_TO_CITY>' + COPYSTR(SalesOrder."Bill-to City",1,35) + '</BILL_TO_CITY>';
      BILL_TO_STConst := '<BILL_TO_ST>' + COPYSTR(SalesOrder."Bill-to County",1,2) + '</BILL_TO_ST>';
      BILL_TO_ZIPConst := '<BILL_TO_ZIP>' + COPYSTR(SalesOrder."Bill-to Post Code",1,10) + '</BILL_TO_ZIP>';
      BILL_TO_COUNTRY_CODEConst := '<BILL_TO_COUNTRY_CODE>' + COPYSTR(SalesOrder."Bill-to Country/Region Code",1,3) + '</BILL_TO_COUNTRY_CODE>';
      UniqueIDConst := '<UNIQUE-ID>' + COPYSTR(SalesOrder."No.",1,18) + '</UNIQUE-ID>';
      HAS_CSTMConst := '<HAS_CSTM>' + 'N' + '</HAS_CSTM>';
      HAS_FINANCIALConst := '<HAS_FINANCIAL>' + 'N' + '</HAS_FINANCIAL>';
      HAS_GIFT_RECConst := '<HAS_GIFT_REC>' + 'N' + '</HAS_GIFT_REC>';

      // IF HAS_GIFT_REC = 'N' THEN
      //  GIFTMSGConst := '<GIFTMESSAGE></GIFTMESSAGE>'
      // ELSE
      //  GIFTMSGConst := '<GIFTMESSAGE><MESSAGE1>' + GIFTMessage1 +'</MESSAGE1>' + '<MESSAGE2>' + GIFTMessage2 +'</MESSAGE2>'
      //                  + '<MESSAGE3>' + GIFTMessage3 +'</MESSAGE3>'+'</GIFTMESSAGE>';

      SalesLine.RESET;
      SalesLine.SETRANGE("Document Type",SalesOrder."Document Type");
      SalesLine.SETRANGE("Document No.",SalesOrder."No.");
      IF SalesLine.FINDSET THEN
        REPEAT
          IF LineItemConst <> '' THEN
              LineItemConst := LineItemConst + '<QUANTITY_ORDERED>' + FORMAT(SalesLine.Quantity) + '</QUANTITY_ORDERED><OFFER_CODE>'
              + WebSrvCredentials."Offer Code" + '</OFFER_CODE>'
          ELSE
              LineItemConst := '<QUANTITY_ORDERED>' + FORMAT(SalesLine.Quantity) + '</QUANTITY_ORDERED><OFFER_CODE>'
              + WebSrvCredentials."Offer Code" + '</OFFER_CODE>';
        UNTIL SalesLine.NEXT = 0;

      IF LineItemConst <> '' THEN
        OrderDetailConst := '<OrderDetail><LineItem>' + LineItemConst + '</LineItem></OrderDetail>';
      //<< DW SBC 2018-07-16
    END;

    PROCEDURE WebSrvOrderNEWAPI@1170000011(VAR "3PLOrders"@1170000000 : Record 50094);
    BEGIN
      //>> DW SBC 2018-07-16
      WebSrvCredentials.GET;
      CheckCredentials(WebSrvCredentials."DB Code");

      // IF STRLEN("3PLOrders"."Order No.") <= 8 THEN
      //  RunWebSrvOrderNEWAPIViaReport(WebSrvCredentials."DB Code","3PLOrders"."3PL Code",COPYSTR("3PLOrders"."Order No.",1,8))
      // ELSE
      //  ErrorLogWebHistory(WebSrvCredentials."DB Code","3PLOrders"."3PL Code","3PLOrders"."Order No.",'Order No. ' + "3PLOrders"."Order No." +'is more than 8 characters',''); //DW SBC 201-07-16
      //<< DW SBC 201-07-16
    END;

    PROCEDURE RunWebSrvOrderNEWAPIViaReport@1170000012(VAR WSSalesOrder@1000000000 : Record 36);
    VAR
      XmlRequest@1170000002 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
      XmlResponse@1170000001 : DotNet "'System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
    BEGIN
      //>> DW SBC 2018-07-20
      IF NOT SalesOrder.GET(WSSalesOrder."Document Type"::Order,WSSalesOrder."No.") THEN
        BEGIN END;

      IF STRLEN(SalesOrder."No.") > 18 THEN
        ErrNoResponse(SalesOrder."No.",TRUE);

      IF NOT CreateXMLRequestOrderNew(XmlRequest,XmlResponse) THEN
        BEGIN END ELSE
          ErrNoResponse(WSSalesOrder."No.",FALSE);
      //<< DW SBC 2018-07-20
    END;

    LOCAL PROCEDURE Insert3PL@1000000007(TrackEntry@1000000000 : Integer);
    VAR
      "3PLOrderTrnHistory"@1000000001 : Record 50097;
      File1@1000000004 : File;
      File2@1000000011 : File;
      NVIStream@1000000003 : InStream;
      NVOStream@1000000002 : OutStream;
      IStream@1000000013 : InStream;
      OStream@1000000012 : OutStream;
      ReqFile@1000000005 : Text;
      ResFile@1000000006 : Text;
      FileManagement@1000000007 : Codeunit 419;
      TempBlob@1000000008 : TEMPORARY Record 99008535;
      ServerResponseFile@1000000009 : Text;
      ServerRequestFile@1000000010 : Text;
      DataLine@1000000014 : Text[1024];
    BEGIN
      //>> DW SBC 2018-07-20

      IF "3PLOrderTrnHistory".GET(TrackEntry) THEN BEGIN
        CLEAR(NVOStream);
        CLEAR(NVIStream);

        "3PLOrders".INIT;
        "3PLOrders"."3PL Code" := 'WEB';
        "3PLOrders"."Order No.":= "3PLOrderTrnHistory"."3PL Code";
        "3PLOrders"."3PL Status" := "3PLOrderTrnHistory"."WS Status";
        "3PLOrders"."3PL Message" := "3PLOrderTrnHistory"."WS Message";

         ReqFile := FileManagement.UploadFileSilent(WebSrvCredentials."SOAP Request Path" + FORMAT("3PLOrderTrnHistory"."Entry No.") + 'Request.xml');
         File1.OPEN(ReqFile);
         File1.CREATEINSTREAM(NVIStream);

         "3PLOrders"."3PL Request".CREATEOUTSTREAM(NVOStream);
         COPYSTREAM(NVOStream,NVIStream);
         File1.CLOSE;

        IF EXISTS(WebSrvCredentials."SOAP Request Path" + FORMAT("3PLOrderTrnHistory"."Entry No.") + 'Request.xml') THEN
          ERASE(WebSrvCredentials."SOAP Request Path" + FORMAT("3PLOrderTrnHistory"."Entry No.") + 'Request.xml');

          CLEAR(NVOStream);
          CLEAR(NVIStream);
         ResFile := FileManagement.UploadFileSilent(WebSrvCredentials."SOAP Request Path" + FORMAT("3PLOrderTrnHistory"."Entry No.") + 'Response.xml');
         File1.OPEN(ResFile);
         File1.CREATEINSTREAM(NVIStream);

         "3PLOrders"."3PL Acknowledgment".CREATEOUTSTREAM(NVOStream);
         COPYSTREAM(NVOStream,NVIStream);
         File1.CLOSE;


         IF EXISTS(WebSrvCredentials."SOAP Response Path" + FORMAT("3PLOrderTrnHistory"."Entry No.") + 'Response.xml') THEN
           ERASE(WebSrvCredentials."SOAP Response Path" + FORMAT("3PLOrderTrnHistory"."Entry No.") + 'Response.xml');


        "3PLOrders"."Order Date"  := SalesOrder."Order Date";
        "3PLOrders"."Date/Time Acknowledged" := CURRENTDATETIME;
        "3PLOrders"."File Extension" := 'XML';
        "3PLOrders"."3PL Response Code" := "3PLOrderTrnHistory"."3PL Response Code";
        "3PLOrders"."3PL Oder No." := SalesOrder."No.";
        "3PLOrders".INSERT;

        SalesOrder."Moulton Order No." := "3PLOrders"."Order No.";
        SalesOrder.MODIFY;
      END;
      //<< DW SBC 2018-07-20
    END;

    LOCAL PROCEDURE ErrNoResponse@1000000004(OrderNo@1000000001 : Code[20];ISLength@1000000003 : Boolean);
    VAR
      "3PLOrderTransactionHistory"@1000000000 : Record 50097;
      entry@1000000002 : Integer;
    BEGIN
      //>> DW SBC 2018-07-20
      IF "3PLOrderTransactionHistory".FINDLAST THEN
        entry := "3PLOrderTransactionHistory"."Entry No.";

      "3PLOrderTransactionHistory".INIT;
      "3PLOrderTransactionHistory"."Entry No." := entry + 1;
      "3PLOrderTransactionHistory"."User ID" := USERID;
      "3PLOrderTransactionHistory"."WS Status" := 'FALSE';
      IF ISLength THEN
        "3PLOrderTransactionHistory"."WS Message" := 'Length ofSales Order No.' + OrderNo + ' is greater then 18'
      ELSE
        "3PLOrderTransactionHistory"."WS Message" := 'No Response generated for Sales Order No. ' + OrderNo;

      "3PLOrderTransactionHistory"."SOAP Request DateTime" := CURRENTDATETIME;
      "3PLOrderTransactionHistory".ShipBatch := 'OrderNEWAPI';
      "3PLOrderTransactionHistory".TrackingNo := SalesOrder."No.";
      "3PLOrderTransactionHistory".INSERT;
      //<< DW SBC 2018-07-20
    END;

    BEGIN
    {
      DW SBC 2018-07-12 MN Created Codeunit for Web service call
      DW SBC 2018-07-16 MN Defined Function - CallOrderAPIWS,InsertNewOrderAPITransaction,ReadResponseOrderAPI,CreateXMLRequestOrderNew,
                                              UpdateNodes,WebSrvOrderNEWAPI and RunWebSrvOrderNEWAPIViaReport
      DW SBC 2018-07-20 MN Defiend function Insert3PL,ErrNoResponse
    }
    END.
  }
}

OBJECT Page 42 Sales Order
{
  OBJECT-PROPERTIES
  {
    Date=07/20/18;
    Time=[ 4:23:23 AM];
    Modified=Yes;
    Version List=NAVW19.00,NAVNA9.00.00.43897;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Order;
               ESM=Pedido venta;
               FRC=Document de vente;
               ENC=Sales Order];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Release,Posting,Prepare,Invoice,Request Approval;
                                ESM=Nuevo,Proceso,Informe,Aprobar,Lanzar,Registrar,Preparar,Factura,Solicitar aprobaci¢n;
                                FRC=Nouveau,Traitement,Rapport,Approuver,Lib‚rer,Report,Pr‚parer,Facture,Approbation de demande;
                                ENC=New,Process,Report,Approve,Release,Posting,Prepare,Invoice,Request Approval];
    OnInit=BEGIN
             SetExtDocNoMandatoryCondition;
                                //ZD7.1
                                ZDWinAddinVisible := ZDAddin.IsWebClient OR ZDAddin.IsWinClientAddinPresent; ZDWebAddinVisible := ZDAddin.IsWebClient OR (NOT ZDWinAddinVisible); ZDSaveAndSendVisible := ZDAddin.IsWinClientAddinPresent;
                                //ZD7.1
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
               BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;

                 SETRANGE("Date Filter",0D,WORKDATE - 1);

                 SetDocNoVisible;

                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;

                 //EFT3.00 -
                 SETFILTER("Expiration Filter", '>%1', TODAY);
                 //EFT3.00 +

                 //20170823jw BEGIN
                 IF Cust.GET("Sell-to Customer No.") THEN
                   ShipAhead := Cust."Ship Ahead";
                 //20170823jw END
               END;

    OnAfterGetRecord=BEGIN
                       SetControlVisibility;
                     END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter;
                END;

    OnInsertRecord=BEGIN
                     CheckCreditMaxBeforeInsert;
                   END;

    OnModifyRecord=BEGIN
                     SetSlsHdrExt(SlsHdrExt); // DW 12/11
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1000 : Codeunit 5331;
                         BEGIN
                           DynamicEditable := CurrPage.EDITABLE;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CRMIsCoupledToRecord := CRMIntegrationEnabled AND CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           GetSlsHdrExt(SlsHdrExt); // 

                                //ZD7.1
                                ;IF GUIALLOWED THEN BEGIN ZdRecRef.GETTABLE(Rec); IF ZdRecRef.GET(ZdRecRef.RECORDID) AND (ZdRecRef.RECORDID <> ZdPrevRecID) THEN BEGIN ZdPrevRecID := ZdRecRef.RECORDID; IF ZDWinAddinVisible THEN BEGIN CurrPage.Zetadocs.PAGE.SetRecordID(
                           ZdRecRef.RECORDID); CurrPage.Zetadocs.PAGE.ACTIVATE(TRUE); END; IF ZDWebAddinVisible THEN BEGIN CurrPage.WebClient.PAGE.SetRecordID(ZdRecRef.RECORDID); CurrPage.WebClient.PAGE.UPDATE(FALSE); END; END; END;
                                //ZD7.1
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 ESM=&Pedido;
                                 FRC=C&ommande;
                                 ENC=O&rder];
                      Image=Order }
      { 61      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 ESM=Estad¡sticas;
                                 FRC=Statistiques;
                                 ENC=Statistics];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OpenSalesOrderStatistics;
                                 SalesCalcDiscountByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 ESM=Ficha;
                                 FRC=Fiche;
                                 ENC=Card];
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Sell-to Customer No.);
                      Image=EditLines }
      { 122     ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 ESM=Dimensiones;
                                 FRC=Dimensions;
                                 ENC=Dimensions];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 78      ;2   ;Action    ;
                      CaptionML=[ENU=A&pprovals;
                                 ESM=A&probaciones;
                                 FRC=A&pprobations;
                                 ENC=A&pprovals];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 ESM=C&omentarios;
                                 FRC=Co&mmentaires;
                                 ENC=Co&mments];
                      RunObject=Page 67;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 1000000064;2 ;Action    ;
                      CaptionML=ENU=Sales Order Extension;
                      RunObject=Page 50092;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.);
                      Image=OrderReminder }
      { 37028322;2   ;Action    ;
                      CaptionML=[ENU=EFT &Transactions;
                                 FRC=Transactions EFT;
                                 ENC=EFT &Transactions];
                      RunObject=Page 37028311;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=CreditCardLog;
                      OnAction=BEGIN
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 259     ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 ESM=Movimientos de re&gistro de transacci¢n de tarjetas de cr‚dito;
                                 FRC=critures du re&gistre des transactions des cartes de cr‚dit;
                                 ENC=Credit Cards Transaction Lo&g Entries];
                      RunObject=Page 829;
                      RunPageLink=Document No.=FIELD(No.),
                                  Customer No.=FIELD(Bill-to Customer No.);
                      Visible=FALSE;
                      Image=CreditCardLog }
      { 11      ;2   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assembly Orders;
                                 ESM=Pedidos de ensamblado;
                                 FRC=Ordres d'assemblage;
                                 ENC=Assembly Orders];
                      Image=AssemblyOrder;
                      OnAction=VAR
                                 AssembleToOrderLink@1000 : Record 904;
                               BEGIN
                                 AssembleToOrderLink.ShowAsmOrders(Rec);
                               END;
                                }
      { 14000727;2   ;Action    ;
                      Name=<Action14000727>;
                      CaptionML=ENU=E-&Mail List;
                      Promoted=Yes;
                      OnAction=VAR
                                 EMailListEntry@14000702 : Record 14000908;
                               BEGIN
                                 EMailListEntry.RESET;
                                 EMailListEntry.SETRANGE("Table ID",DATABASE::"Sales Header");
                                 EMailListEntry.SETRANGE(Type,"Document Type");
                                 EMailListEntry.SETRANGE(Code,"No.");
                                 PAGE.RUNMODAL(PAGE::"E-Mail List Entries",EMailListEntry);
                               END;
                                }
      { 1000000071;2 ;Action    ;
                      CaptionML=ENU=EDI Order Status;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Status;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 EDITradePartner@1000000000 : Record 14002360;
                                 OrderStatusHdr@1000000001 : Record 14002400;
                               BEGIN
                                 IF EDITradePartner.GET("EDI Trade Partner") THEN
                                   OrderStatusHdr.SalesOrderStatus(Rec); // DW0318
                               END;
                                }
      { 14000715;2   ;ActionGroup;
                      Name=<Action14000715>;
                      CaptionML=ENU=E-Ship }
      { 14000806;3   ;Action    ;
                      CaptionML=ENU=Bill of Ladings;
                      RunObject=Page 14000828;
                      RunPageLink=Source Type=CONST(36),
                                  Source Subtype=FIELD(Document Type),
                                  Source ID=FIELD(No.),
                                  Type=CONST(Order),
                                  No.=FIELD(No.);
                      Image=Document }
      { 14000731;3   ;Action    ;
                      CaptionML=ENU=P&ackages;
                      RunObject=Page 14000711;
                      RunPageView=SORTING(Source Type,Source Subtype,Source ID)
                                  ORDER(Ascending);
                      RunPageLink=Source Type=CONST(36),
                                  Source Subtype=FIELD(Document Type),
                                  Source ID=FIELD(No.) }
      { 14000732;3   ;Action    ;
                      Name=<Page E-Ship Agent Options>;
                      CaptionML=ENU=E-Ship Agent Options;
                      OnAction=VAR
                                 PackingControl@14000701 : Record 14000717;
                                 Shipping@14000702 : Codeunit 14000701;
                               BEGIN
                                 PackingControl.TransferFromSalesHeader(Rec);
                                 Shipping.ShowOptPageShipDocument(PackingControl);
                               END;
                                }
      { 14000752;3   ;Action    ;
                      CaptionML=ENU=Export Documents;
                      RunObject=Page 14000984;
                      RunPageLink=Source Type=CONST(36),
                                  Source Subtype=FIELD(Document Type),
                                  Source ID=FIELD(No.) }
      { 14000382;2   ;ActionGroup;
                      Name=<Action14000382>;
                      CaptionML=ENU=EDI }
      { 14000369;3   ;Action    ;
                      Name=<Action14000369>;
                      CaptionML=ENU=Associated Receive Documents;
                      OnAction=VAR
                                 EDIDocumentStatus@14000351 : Codeunit 14000379;
                               BEGIN
                                 CLEAR(EDIDocumentStatus);
                                 EDIDocumentStatus.AssocChangeDocument(Rec);
                               END;
                                }
      { 14000377;3   ;Action    ;
                      Name=<Action14000377>;
                      CaptionML=ENU=&EDI Receive Elements;
                      OnAction=BEGIN
                                 TESTFIELD("EDI Order");

                                 EDIIntegration.ViewRecElements("EDI Internal Doc. No.");
                               END;
                                }
      { 14000378;3   ;Action    ;
                      CaptionML=ENU=EDI Discount Summaries;
                      RunObject=Page 14000396;
                      RunPageLink=Internal Doc. No.=FIELD(EDI Internal Doc. No.) }
      { 14000384;3   ;Action    ;
                      CaptionML=ENU=Send &EDI Warehouse Shipping Order;
                      OnAction=VAR
                                 EDIIntegration@14000351 : Codeunit 14000363;
                               BEGIN

                                 TESTFIELD("EDI Order");
                                 TESTFIELD("EDI Released");
                                 TESTFIELD("Location Code");

                                 EDIIntegration.SendWarehouseShippingOrder(Rec);
                               END;
                                }
      { 1000000054;3 ;Action    ;
                      CaptionML=ENU=Set EDI Ack. Sent;
                      OnAction=BEGIN
                                 // 
                                 "EDI Ack. Generated" := TRUE;
                                 "EDI Ack. Gen. Date" := TODAY;
                                 MODIFY(FALSE);
                               END;
                                }
      { 1000000055;3 ;Action    ;
                      CaptionML=ENU=Clear EDI Ack. Sent;
                      OnAction=BEGIN
                                 // 
                                 "EDI Ack. Generated" := FALSE;
                                 "EDI Ack. Gen. Date" := 0D;
                                 MODIFY(FALSE);
                               END;
                                }
      { 14000385;3   ;Action    ;
                      CaptionML=ENU=Trace;
                      Image=Trace;
                      OnAction=VAR
                                 EDITrace@14000351 : Page 14002386;
                               BEGIN
                                 CLEAR(EDITrace);
                                 EDITrace.SetDoc("EDI Internal Doc. No.");
                                 EDITrace.RUNMODAL;
                               END;
                                }
      { 79      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 ESM=Dynamics CRM;
                                 FRC=Dynamics CRM;
                                 ENC=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 71      ;2   ;Action    ;
                      Name=CRMGoToSalesOrder;
                      CaptionML=[ENU=Sales Order;
                                 ESM=Pedido venta;
                                 FRC=Document de vente;
                                 ENC=Sales Order];
                      ToolTipML=[ENU=Open the coupled Microsoft Dynamics CRM sales order.;
                                 ESM=Abra el pedido de venta de Microsoft Dynamics CRM emparejado.;
                                 FRC=Ouvrez le document de vente Microsoft Dynamics CRM coupl‚.;
                                 ENC=Open the coupled Microsoft Dynamics CRM sales order.];
                      Enabled=CRMIntegrationEnabled AND CRMIsCoupledToRecord;
                      Image=CoupledOrder;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 ESM=Documentos;
                                 FRC=Documents;
                                 ENC=Documents];
                      Image=Documents }
      { 64      ;2   ;Action    ;
                      CaptionML=[ENU=S&hipments;
                                 ESM=&Env¡os;
                                 FRC=L&ivraisons;
                                 ENC=S&hipments];
                      RunObject=Page 142;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Shipment }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 ESM=Facturas;
                                 FRC=Factures;
                                 ENC=Invoices];
                      RunObject=Page 143;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Invoice }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 ESM=Almac‚n;
                                 FRC=Entrep“t;
                                 ENC=Warehouse];
                      Image=Warehouse }
      { 150     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 ESM=L¡neas ubicac./ pic&k exist.;
                                 FRC=Lignes d'articles en stoc&k … classer/pr‚lever;
                                 ENC=In&vt. Put-away/Pick Lines];
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Sales Order),
                                  Source No.=FIELD(No.);
                      Image=PickLines }
      { 168     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Shipment Lines;
                                 ESM=L¡neas de env¡o almac‚n;
                                 FRC=Lignes livraison entrep“t;
                                 ENC=Whse. Shipment Lines];
                      RunObject=Page 7341;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(37),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=ShipmentLines }
      { 17      ;1   ;ActionGroup;
                      CaptionML=[ENU=Prepayment;
                                 ESM=Anticipo;
                                 FRC=Paiement anticip‚;
                                 ENC=Prepayment];
                      Image=Prepayment }
      { 234     ;2   ;Action    ;
                      Name=PagePostedSalesPrepaymentInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 ESM=&Facturas anticipo;
                                 FRC=&Factures pour paiement anticip‚;
                                 ENC=Prepa&yment Invoices];
                      RunObject=Page 143;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentInvoice }
      { 235     ;2   ;Action    ;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 ESM=&Notas cr‚dito anticipo;
                                 FRC=Notes de cr‚di&t pour paiement anticip‚;
                                 ENC=Prepayment Credi&t Memos];
                      RunObject=Page 144;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentCreditMemo }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 9041209 ;1   ;Action    ;
                      CaptionML=[DAN=Gem og Send;
                                 DEU=Speichern und Senden;
                                 ENU=Save and Send;
                                 ESP=Guardar y Enviar;
                                 FIN=Tallenna ja l„het„;
                                 FRA=Enregistrer et Envoyer;
                                 ITA=Salva e Invia;
                                 NLD=Opslaan en Verzenden;
                                 NOR=Lagre og Send;
                                 SVE=Spara och Skicka;
                                 ESM=Guardar y Enviar;
                                 PTG=Guardar e Enviar;
                                 FRC=Enregistrer et Envoyer];
                      ToolTipML=[DAN=Gem dokument til arkivet og / eller sende den via Outlook;
                                 DEU=Sparen Dokument in das Archiv und / oder Senden Sie es via Outlook;
                                 ENU=Save document to the archive and/or Send it via Outlook;
                                 ESP=Guardar documento en el Archivo y/o Enviarlo v¡a Outlook;
                                 FIN=Tallenna asiakirja arkistoon ja / tai l„hett„„ sen Outlook;
                                 FRA=Enregistrer le document … l'archive et / ou de l'envoyer via Outlook;
                                 ITA=Salvare documento all'archivio e / o Invia tramite Outlook;
                                 NLD=Save document naar het archief en / of verzenden via Outlook;
                                 NOR=Lagre dokument til arkivet og / eller sende den via Outlook;
                                 SVE=Spara dokument till arkivet och / eller skicka den via Outlook;
                                 ESM=Guardar documento en el Archivo y/o Enviarlo v¡a Outlook;
                                 PTG=Guardar documento para o arquivo e / ou envi -lo via Outlook;
                                 FRC=Enregistrer le document … l'archive et / ou de l'envoyer via Outlook];
                      Promoted=Yes;
                      Visible=ZDSaveAndSendVisible;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                                      //ZD7.1
                                                      CurrPage.Zetadocs.PAGE.SaveAndSend(50212);
                                                                                      //ZD7.1
                               END;
                                }
      { 1000000060;1 ;ActionGroup;
                      CaptionML=ENU=Fulfillment }
      { 1000000059;2 ;Action    ;
                      CaptionML=ENU=Process Fulfillment;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=OrderPromising;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 RunFullfillment; // 
                               END;
                                }
      { 1000000058;2 ;Action    ;
                      CaptionML=ENU=Show Result;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ShowWarning;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // DWBLM
                                 MessageText.SETRANGE("Order No.","No.");
                                 PAGE.RUN(PAGE::"Message Text",MessageText);
                               END;
                                }
      { 1000000090;2 ;Action    ;
                      CaptionML=ENU=Update Availability;
                      OnAction=VAR
                                 ECRAvailability@1000000000 : Codeunit 50054;
                               BEGIN
                                 // DW0418
                                 TESTFIELD(Status,Status::Released);
                                 ECRAvailability.AdjustSalesOrder(Rec);
                               END;
                                }
      { 1000000078;2 ;Action    ;
                      CaptionML=ENU=Set Pick Status;
                      Image=Status;
                      OnAction=VAR
                                 SlsHdr@1000000000 : Record 36;
                                 RoutReq@1000000001 : Record 50070;
                               BEGIN
                                 RoutReq.EvalPickStatusOnly(Rec);
                                 MODIFY;
                                 MESSAGE('Pick Status set to "%1"',"Pick Status");
                               END;
                                }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 ESM=Aprobaci¢n;
                                 FRC=Approbation;
                                 ENC=Approval] }
      { 43      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 ESM=Aprobar;
                                 FRC=Approuver;
                                 ENC=Approve];
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 41      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 ESM=Rechazar;
                                 FRC=Rejeter;
                                 ENC=Reject];
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 39      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 ESM=Delegar;
                                 FRC=D‚l‚guer;
                                 ENC=Delegate];
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 ESM=Comentarios;
                                 FRC=Commentaires;
                                 ENC=Comments];
                      RunObject=Page 660;
                      RunPageLink=Table ID=CONST(36),
                                  Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 21      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 ESM=Lanzar;
                                 FRC=Lib‚rer;
                                 ENC=Release];
                      Image=ReleaseDoc }
      { 133     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 ESM=Lan&zar;
                                 FRC=&Lib‚rer;
                                 ENC=Re&lease];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 134     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 ESM=&Volver a abrir;
                                 FRC=R‚&ouvrir;
                                 ENC=Re&open];
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 ESM=Acci&ones;
                                 FRC=F&onctions;
                                 ENC=F&unctions];
                      Image=Action }
      { 1000000065;2 ;Action    ;
                      CaptionML=ENU=Add Freight Line;
                      Image=ShipmentLines;
                      OnAction=BEGIN
                                 CRIFunctions.AddFreightLine(Rec); // 
                               END;
                                }
      { 1000000082;2 ;Action    ;
                      CaptionML=ENU=Get Freight Quote;
                      Image=Calculate;
                      OnAction=BEGIN
                                 QuoteFreight(Rec);
                               END;
                                }
      { 1000000072;2 ;Action    ;
                      CaptionML=ENU=UPS Address Check;
                      Image=Addresses;
                      OnAction=VAR
                                 ShippingSetup@1000000000 : Record 14000707;
                                 UPSWebS@1000000001 : Codeunit 50030;
                               BEGIN
                                 // DW 8/11 UPS Address Verification
                                 ShippingSetup.GET;
                                 ShippingSetup.TESTFIELD("UPS Address Verification");
                                 UPSWebS.RUN(Rec);
                               END;
                                }
      { 1000000066;2 ;Action    ;
                      CaptionML=ENU=Set Standard Pack;
                      OnAction=BEGIN
                                 CRIFunctions.SetStandardPack(Rec); // 2016
                               END;
                                }
      { 1000000067;2 ;Action    ;
                      CaptionML=ENU=Split Order;
                      Image=Splitlines;
                      OnAction=VAR
                                 ECRSOFun@1000000000 : Codeunit 50016;
                               BEGIN
                                 ECRSOFun.SplitOrder(Rec); // 
                               END;
                                }
      { 67      ;2   ;Action    ;
                      AccessByPermission=TableData 19=R;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 ESM=Calcular dto. en la &factura;
                                 FRC=Calculer escompte &facture;
                                 ENC=Calculate &Invoice Discount];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 SalesCalcDiscountByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 167     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Cust. Sales Codes;
                                 ESM=Tomar c¢d. est nd. &vtas. clie.;
                                 FRC=Obtenir les codes de vente de client stan&dard;
                                 ENC=Get St&d. Cust. Sales Codes];
                      Image=CustomerCode;
                      OnAction=VAR
                                 StdCustSalesCode@1000 : Record 172;
                               BEGIN
                                 StdCustSalesCode.InsertSalesLines(Rec);
                               END;
                                }
      { 68      ;2   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 ESM=Copiar l¡neas;
                                 FRC=Copier document;
                                 ENC=Copy Document];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                               END;
                                }
      { 154     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 ESM=Mover l¡neas negativas;
                                 FRC=D‚placer lignes n‚gatives;
                                 ENC=Move Negative Lines];
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegSalesLines);
                                 MoveNegSalesLines.SetSalesHeader(Rec);
                                 MoveNegSalesLines.RUNMODAL;
                                 MoveNegSalesLines.ShowDocument;
                               END;
                                }
      { 196     ;2   ;Action    ;
                      Name=Archive Document;
                      CaptionML=[ENU=Archi&ve Document;
                                 ESM=&Archivar documento;
                                 FRC=Archi&ver document;
                                 ENC=Archi&ve Document];
                      Image=Archive;
                      OnAction=BEGIN
                                 ArchiveManagement.ArchiveSalesDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000088;2 ;Action    ;
                      CaptionML=ENU=Synchronize IC Order;
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICProc@1000000000 : Codeunit 50008;
                               BEGIN
                                 ICProc.SyncICOrder(Rec); // DW0318
                               END;
                                }
      { 204     ;2   ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send IC Sales Order Cnfmn.;
                                 ESM=Conf. env¡o ped. venta IC;
                                 FRC=Envoyer confirmation commande vente IC;
                                 ENC=Send IC Sales Order Cnfmn.];
                      Visible=FALSE;
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   ICInOutboxMgt.SendSalesDoc(Rec,FALSE);
                               END;
                                }
      { 1000000032;2 ;Action    ;
                      CaptionML=ENU=Recalculate Quantities;
                      Image=Recalculate;
                      OnAction=VAR
                                 CRISLF@1000000000 : Codeunit 50006;
                                 PickHdr@1000000001 : Record 36;
                               BEGIN
                                 // DW0218
                                 IF "Original Order No." IN ['',"No."] THEN BEGIN
                                   PickHdr.SETRANGE("Original Order No.","No.");
                                   PickHdr.SETFILTER("No.",'<>%1',"Original Order No.");
                                   IF NOT PickHdr.FIND('-') THEN BEGIN
                                     "Pick Status" := "Pick Status"::" ";
                                     MODIFY;
                                   END;
                                 END;
                                 CRISLF.UpdateSOQtys(Rec);
                               END;
                                }
      { 1000000061;2 ;ActionGroup;
                      CaptionML=ENU=Find Duplicates by Ext. Doc No. }
      { 1000000062;3 ;Action    ;
                      CaptionML=ENU=Open Orders;
                      RunObject=Page 45;
                      RunPageLink=Sell-to Customer No.=FIELD(Sell-to Customer No.),
                                  External Document No.=FIELD(External Document No.),
                                  Document Type=CONST(Order) }
      { 1000000063;3 ;Action    ;
                      CaptionML=ENU=Posted Transactions;
                      RunObject=Page 25;
                      RunPageLink=Customer No.=FIELD(Sell-to Customer No.),
                                  External Document No.=FIELD(External Document No.) }
      { 69      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 ESM=Documento entrante;
                                 FRC=Document entrant;
                                 ENC=Incoming Document];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 60      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 ESM=Ver documento entrante;
                                 FRC=Afficher le document entrant;
                                 ENC=View Incoming Document];
                      ToolTipML=;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 57      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 ESM=Seleccionar documento entrante;
                                 FRC=S‚lectionner le document entrant;
                                 ENC=Select Incoming Document];
                      ToolTipML=;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No."));
                               END;
                                }
      { 55      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 ESM=Crear documento entrante desde archivo;
                                 FRC=Cr‚er un document entrant … partir d'un fichier;
                                 ENC=Create Incoming Document from File];
                      ToolTipML=;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromSalesDocument(Rec);
                               END;
                                }
      { 53      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 ESM=Eliminar documento entrante;
                                 FRC=Supprimer le document entrant;
                                 ENC=Remove Incoming Document];
                      ToolTipML=;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 "Incoming Document Entry No." := 0;
                               END;
                                }
      { 14000744;2   ;Action    ;
                      CaptionML=ENU=E-&Mail Confirmation;
                      OnAction=VAR
                                 EMailMgt@14000701 : Codeunit 14000903;
                               BEGIN
                                 TESTFIELD("E-Mail Confirmation Handled",FALSE);

                                 EMailMgt.SendSalesConfirmation(Rec,TRUE,FALSE);
                               END;
                                }
      { 1000000008;1 ;ActionGroup;
                      Name=E-Ship & EDI;
                      ActionContainerType=NewDocumentItems }
      { 14000733;2   ;ActionGroup;
                      CaptionML=ENU=&E-Ship }
      { 14000734;3   ;Action    ;
                      CaptionML=ENU=Create Bill of Lading;
                      Promoted=Yes;
                      Image=NewDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 BillOfLading.CreateBillOfLadingSalesHeader(Rec,TRUE);

                                 MESSAGE(Text14000701,"No.",BillOfLading."No.");
                               END;
                                }
      { 14000736;3   ;Action    ;
                      ShortCutKey=Alt+F11;
                      CaptionML=ENU=Fast Pack;
                      OnAction=VAR
                                 FastPackLine@14000701 : Record 14000711;
                               BEGIN
                                 FastPackLine.RESET;
                                 FastPackLine.SETRANGE("Source Type",DATABASE::"Sales Header");
                                 FastPackLine.SETRANGE("Source Subtype","Document Type");
                                 FastPackLine.SETRANGE("Source ID","No.");
                                 PAGE.RUNMODAL(PAGE::"Fast Pack Order",FastPackLine);
                               END;
                                }
      { 14000737;3   ;Action    ;
                      CaptionML=ENU=Test E-Ship Requirement;
                      OnAction=VAR
                                 Package@14000701 : Record 14000701;
                               BEGIN
                                 Package.TestFromSalesHeader(Rec);

                                 MESSAGE(Text14000702);
                               END;
                                }
      { 14000738;3   ;Action    ;
                      CaptionML=ENU=Quote Rate;
                      OnAction=BEGIN
                                 Shipping.QuoteRateSalesHeader(Rec);

                                 CurrPage.UPDATE;
                               END;
                                }
      { 14000739;3   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=ENU=Rate Shop;
                      Promoted=Yes;
                      Image=Calculate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Shipping.RateShopSalesHeader(Rec);

                                 CurrPage.UPDATE;
                               END;
                                }
      { 1000000086;3 ;Action    ;
                      CaptionML=ENU=Import UPS Tracking;
                      Image=Import;
                      OnAction=VAR
                                 UPSShipping@1000000000 : Codeunit 50031;
                               BEGIN
                                 UPSShipping.XMLAutoTracking; // DW
                               END;
                                }
      { 14000751;3   ;Action    ;
                      CaptionML=ENU=Add to Export Document;
                      OnAction=BEGIN
                                 Shipping.ExpDocAddFromOrder(DATABASE::"Sales Header","Document Type","No.");
                               END;
                                }
      { 14000370;2   ;ActionGroup;
                      CaptionML=ENU=EDI }
      { 14000372;3   ;Action    ;
                      CaptionML=ENU=Send EDI Warehouse Shipping Order;
                      Image=SendElectronicDocument;
                      OnAction=VAR
                                 EDIIntegration@14000351 : Codeunit 14000363;
                               BEGIN
                                 TESTFIELD("EDI Order");
                                 TESTFIELD("EDI Released");
                                 TESTFIELD("Location Code");

                                 EDIIntegration.SendWarehouseShippingOrder(Rec);
                               END;
                                }
      { 14000390;3   ;Action    ;
                      CaptionML=ENU=Send EDI PO Acknowledgement;
                      Promoted=Yes;
                      Image=ElectronicDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ECREDIFunctions@1000000000 : Codeunit 50013;
                               BEGIN
                                 // DW Fix it up
                                 TESTFIELD("EDI Order");
                                 // TESTFIELD("EDI Released");
                                 IF Status <> Status::Released THEN
                                   IF NOT CONFIRM('Order is not released - send anyway?',FALSE) THEN
                                     ERROR('');
                                 ECREDIFunctions.SendEDIPOAck(Rec);
                               END;
                                }
      { 14000389;3   ;Action    ;
                      CaptionML=ENU=Send Cancellation Advice;
                      OnAction=BEGIN
                                 TESTFIELD("EDI Order");
                                 TESTFIELD("EDI Cancellation Advice");

                                 EDIIntegration.SendCancellationAdvice(Rec);
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=Plan;
                                 ESM=Planificar;
                                 FRC=Planifier;
                                 ENC=Plan];
                      Image=Planning }
      { 197     ;2   ;Action    ;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 ESM=Comprom&iso entrega;
                                 FRC=&Promesse de livraison;
                                 ENC=Order &Promising];
                      Image=OrderPromising;
                      OnAction=VAR
                                 OrderPromisingLine@1000 : TEMPORARY Record 99000880;
                               BEGIN
                                 OrderPromisingLine.SETRANGE("Source Type","Document Type");
                                 OrderPromisingLine.SETRANGE("Source ID","No.");
                                 PAGE.RUNMODAL(PAGE::"Order Promising Lines",OrderPromisingLine);
                               END;
                                }
      { 248     ;2   ;Action    ;
                      CaptionML=[ENU=Demand Overview;
                                 ESM=Panorama de demanda;
                                 FRC=Aper‡u demande;
                                 ENC=Demand Overview];
                      Image=Forecast;
                      OnAction=VAR
                                 DemandOverview@1000 : Page 5830;
                               BEGIN
                                 DemandOverview.SetCalculationParameter(TRUE);
                                 DemandOverview.Initialize(0D,1,"No.",'','');
                                 DemandOverview.RUNMODAL;
                               END;
                                }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Pla&nning;
                                 ESM=Plani&ficaci¢n;
                                 FRC=Pla&nification;
                                 ENC=Pla&nning];
                      Image=Planning;
                      OnAction=VAR
                                 SalesPlanForm@1001 : Page 99000883;
                               BEGIN
                                 SalesPlanForm.SetSalesOrder("No.");
                                 SalesPlanForm.RUNMODAL;
                               END;
                                }
      { 37028400;1   ;ActionGroup;
                      CaptionML=ENU=P&ayment;
                      Image=Sales }
      { 37028380;2   ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=&Submit EFT Payment;
                                 FRC=&Soumettre paiement par EFT;
                                 ENC=&Submit EFT Payment];
                      RunObject=Codeunit 37028506;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReceivablesPayables;
                      PromotedCategory=Process }
      { 37028401;2   ;ActionGroup;
                      CaptionML=ENU=&Credit Card;
                      Image=CreditCard }
      { 37028501;3   ;Action    ;
                      CaptionML=ENU=Authorize;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Authorize),
                                  Tender Type=CONST(Credit Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028502;3   ;Action    ;
                      CaptionML=ENU=Voice Authorize;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Voice Authorize),
                                  Tender Type=CONST(Credit Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028503;3   ;Action    ;
                      CaptionML=ENU=Charge;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Charge),
                                  Tender Type=CONST(Credit Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028504;3   ;Action    ;
                      CaptionML=ENU=Capture;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Capture),
                                  Tender Type=CONST(Credit Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028505;3   ;Action    ;
                      CaptionML=ENU=Refund;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Refund),
                                  Tender Type=CONST(Credit Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028506;3   ;Action    ;
                      CaptionML=ENU=Verify Address;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Address Verify),
                                  Tender Type=CONST(Credit Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028402;2   ;ActionGroup;
                      CaptionML=ENU=Gift Card;
                      Image=CreditCard }
      { 37028507;3   ;Action    ;
                      CaptionML=ENU=Authorize;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Authorize),
                                  Tender Type=CONST(Gift Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028508;3   ;Action    ;
                      CaptionML=ENU=Charge;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Charge),
                                  Tender Type=CONST(Gift Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028509;3   ;Action    ;
                      CaptionML=ENU=Refund;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Refund),
                                  Tender Type=CONST(Gift Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028510;3   ;Action    ;
                      CaptionML=ENU=Activate;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Activate),
                                  Tender Type=CONST(Gift Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028511;3   ;Action    ;
                      CaptionML=ENU=Increase Balance;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Balance Increase),
                                  Tender Type=CONST(Gift Card);
                      Promoted=No;
                      Image=AuthorizeCreditCard;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028404;2   ;ActionGroup;
                      CaptionML=ENU=Check;
                      Image=ElectronicPayment }
      { 37028512;3   ;Action    ;
                      CaptionML=ENU=Verify Paper Check;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Charge),
                                  Tender Type=CONST(Check);
                      Promoted=No;
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028513;3   ;Action    ;
                      CaptionML=ENU=Authorize Electronic Check;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Authorize),
                                  Tender Type=CONST(Check);
                      Promoted=No;
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028514;3   ;Action    ;
                      CaptionML=ENU=Charge Electronic Check;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Charge),
                                  Tender Type=CONST(Check);
                      Promoted=No;
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028515;3   ;Action    ;
                      CaptionML=ENU=Refund Electronic Check;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Refund),
                                  Tender Type=CONST(Check);
                      Promoted=No;
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028405;2   ;ActionGroup;
                      CaptionML=ENU=Cash;
                      Image=ElectronicPayment }
      { 37028516;3   ;Action    ;
                      CaptionML=ENU=Payment;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Capture),
                                  Tender Type=CONST(Cash);
                      Promoted=No;
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028517;3   ;Action    ;
                      CaptionML=ENU=Refund;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Refund),
                                  Tender Type=CONST(Cash);
                      Promoted=No;
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028406;2   ;ActionGroup;
                      CaptionML=ENU=Web Payment;
                      Image=ElectronicPayment }
      { 37028518;3   ;Action    ;
                      Name=<Action37028331>;
                      CaptionML=[ENU=&Register;
                                 FRC=Autoriser;
                                 ENC=&Authorize];
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Authorize),
                                  Tender Type=CONST(Web Payment);
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 37028519;3   ;Action    ;
                      Name=<Action37028332>;
                      CaptionML=ENU=&Refund;
                      RunObject=Page 37028570;
                      RunPageView=SORTING(Document Type,Document No.);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.),
                                  Method Type=CONST(Refund),
                                  Tender Type=CONST(Web Payment);
                      Image=CalculateCost;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 ESM=Aprobaci¢n solic.;
                                 FRC=Approbation de demande;
                                 ENC=Request Approval];
                      Image=SendApprovalRequest }
      { 250     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 ESM=Enviar solicitud a&probaci¢n;
                                 FRC=Envoyer demande d'a&pprobation;
                                 ENC=Send A&pproval Request];
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckSalesApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendSalesDocForApproval(Rec);
                               END;
                                }
      { 251     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 ESM=&Cancelar solicitud aprobaci¢n;
                                 FRC=Annuler demande d'appro&bation;
                                 ENC=Cancel Approval Re&quest];
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExist;
                      Image=Cancel;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelSalesApprovalRequest(Rec);
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=Credit Card;
                                 ESM=Tarjeta de cr‚dito;
                                 FRC=Carte de cr‚dit;
                                 ENC=Credit Card];
                      Visible=FALSE;
                      Image=AuthorizeCreditCard }
      { 256     ;2   ;Action    ;
                      CaptionML=[ENU=Authorize;
                                 ESM=Autorizar;
                                 FRC=Autoriser;
                                 ENC=Authorize];
                      Visible=FALSE;
                      Image=AuthorizeCreditCard;
                      OnAction=BEGIN
                                 Authorize;
                               END;
                                }
      { 257     ;2   ;Action    ;
                      CaptionML=[ENU=Void A&uthorize;
                                 ESM=Anular a&utorizaci¢n;
                                 FRC=Annuler l'a&utorisation;
                                 ENC=Void A&uthorize];
                      Visible=FALSE;
                      Image=VoidCreditCard;
                      OnAction=BEGIN
                                 Void;
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 ESM=Almac‚n;
                                 FRC=Entrep“t;
                                 ENC=Warehouse];
                      Image=Warehouse }
      { 148     ;2   ;Action    ;
                      AccessByPermission=TableData 7342=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 ESM=Crear &ubicac./ pick. inventario;
                                 FRC=Cr‚er une r‚servation/sortie de stoc&k;
                                 ENC=Create Inventor&y Put-away/Pick];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 149     ;2   ;Action    ;
                      AccessByPermission=TableData 7320=R;
                      CaptionML=[ENU=Create &Whse. Shipment;
                                 ESM=Crear &env¡o alm.;
                                 FRC=Cr‚er une livraison d'&entrep“t;
                                 ENC=Create &Whse. Shipment];
                      Visible=FALSE;
                      Image=NewShipment;
                      OnAction=VAR
                                 GetSourceDocOutbound@1001 : Codeunit 5752;
                               BEGIN
                                 GetSourceDocOutbound.CreateFromSalesOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 73      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 ESM=&Registro;
                                 FRC=Rep&ort;
                                 ENC=P&osting];
                      Image=Post }
      { 75      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 ESM=&Registrar;
                                 FRC=Rep&orter;
                                 ENC=P&ost];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post (Yes/No)");
                               END;
                                }
      { 76      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 ESM=Registrar e &imprimir;
                                 FRC=Reporter et im&primer;
                                 ENC=Post and &Print];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post + Print");
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Email;
                                 ESM=Registrar y enviar por correo electr¢nico;
                                 FRC=Valider et envoyer par e-mail;
                                 ENC=Post and Email];
                      Image=PostMail;
                      OnAction=VAR
                                 SalesPostPrint@1000 : Codeunit 82;
                               BEGIN
                                 SalesPostPrint.PostAndEmail(Rec);
                               END;
                                }
      { 74      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 ESM=Informe prueba;
                                 FRC=Tester le report;
                                 ENC=Test Report];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 77      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 ESM=Registrar por &lotes;
                                 FRC=Reporter &lot;
                                 ENC=Post &Batch];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000068;2 ;Action    ;
                      CaptionML=ENU=Post and Print Batch Invoices;
                      Image=PostBatch;
                      OnAction=VAR
                                 SalesHeader@1000000000 : Record 36;
                               BEGIN
                                 // DW 11/14
                                 SalesHeader.COPYFILTERS(Rec);
                                 REPORT.RUNMODAL(REPORT::"Post and Print Batch Invoices",TRUE,TRUE,SalesHeader);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 ESM=Quitar de cola de proyecto;
                                 FRC=Supprimer de la file d'attente des travaux;
                                 ENC=Remove From Job Queue];
                      Visible=JobQueueVisible;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=PreviewPosting;
                      CaptionML=[ENU=Preview Posting;
                                 ESM=Vista previa de registro;
                                 FRC=Aper‡u compta.;
                                 ENC=Preview Posting];
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 ShowPreview;
                               END;
                                }
      { 236     ;2   ;ActionGroup;
                      CaptionML=[ENU=Prepa&yment;
                                 ESM=&Anticipo;
                                 FRC=Paie&ment anticip‚;
                                 ENC=Prepa&yment];
                      Image=Prepayment }
      { 231     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Prepayment &Test Report;
                                 ESM=Informe prue&ba anticipo;
                                 FRC=Rapport de &test de paiement anticip‚;
                                 ENC=Prepayment &Test Report];
                      Image=PrepaymentSimulation;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeaderPrepmt(Rec);
                               END;
                                }
      { 232     ;3   ;Action    ;
                      Name=PostPrepaymentInvoice;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Invoice;
                                 ESM=&Registrar factura anticipo;
                                 FRC=Reporter facture pa&iement anticip‚;
                                 ENC=Post Prepayment &Invoice];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,FALSE);
                               END;
                                }
      { 237     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Invoic&e;
                                 ESM=&Registrar e imprimir factura anticipo;
                                 FRC=Reporter et imprimer factur&e paiem. ant.;
                                 ENC=Post and Print Prepmt. Invoic&e];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,TRUE);
                               END;
                                }
      { 233     ;3   ;Action    ;
                      Name=PostPrepaymentCreditMemo;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Credit Memo;
                                 ESM=&Registrar nota cr‚dito anticipo;
                                 FRC=Reporter note de &cr‚dit paiement anticip‚;
                                 ENC=Post Prepayment &Credit Memo];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,FALSE);
                               END;
                                }
      { 238     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Cr. Mem&o;
                                 ESM=Registrar e imprimir nota cr‚di&to anticipo;
                                 FRC=Reporter et imprimer n&ote cr. paiem. ant.;
                                 ENC=Post and Print Prepmt. Cr. Mem&o];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,TRUE);
                               END;
                                }
      { 223     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 ESM=&Imprimir;
                                 FRC=&Imprimer;
                                 ENC=&Print];
                      Image=Print }
      { 225     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Work Order;
                                 ESM=Solicitud trabajo;
                                 FRC=Bon de travail;
                                 ENC=Work Order];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Work Order");
                               END;
                                }
      { 5       ;2   ;Action    ;
                      CaptionML=[ENU=Pick Instruction;
                                 ESM=Instrucci¢n picking;
                                 FRC=Instruction pr‚lŠvement;
                                 ENC=Pick Instruction];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Pick Instruction");
                               END;
                                }
      { 1000000069;2 ;Action    ;
                      CaptionML=ENU=Bar Code Pick Ticket;
                      OnAction=VAR
                                 SlsHdr@1000000000 : Record 36;
                               BEGIN
                                 // DW 9/2010
                                 SlsHdr.SETRANGE("Document Type","Document Type");
                                 SlsHdr.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"CRI Picking List by Order Bar",TRUE,FALSE,SlsHdr);
                               END;
                                }
      { 1000000081;2 ;Action    ;
                      CaptionML=ENU=Packing Slip;
                      OnAction=VAR
                                 ECRPickShip@1000000000 : Codeunit 50048;
                               BEGIN
                                 ShippingSetup.GET;

                                 IF Cust.GET(SlsHdr."Sell-to Customer No.") THEN BEGIN

                                   IF SlsHdr."Packing Rule Code" <> '' THEN
                                     PackingRule.GET(SlsHdr."Packing Rule Code") // DWPR
                                   ELSE
                                     IF Cust."Packing Rule Code" <> '' THEN
                                       PackingRule.GET(Cust."Packing Rule Code");

                                   IF (PackingRule."Close Package Report ID" = 0) AND (PackingRule."Close Sales Report ID" = 0) THEN
                                     PackingRule.GET(ShippingSetup."Default Packing Rule Code");

                                   IF PackingRule."Close Package Report ID" <> 0 THEN BEGIN
                                     Package.SETRANGE("Source ID",SlsHdr."No.");
                                     REPORT.RUNMODAL(PackingRule."Close Package Report ID",FALSE,FALSE,Package);
                                     EXIT;
                                   END;
                                 END;

                                 IF PackingRule."Close Sales Report ID" <> 0 THEN
                                    REPORT.RUNMODAL(PackingRule."Close Sales Report ID",FALSE,FALSE,SlsHdr)
                                 ELSE
                                     MESSAGE('Packing Rule is not set up');
                               END;
                                }
      { 31      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Order Confirmation;
                                 ESM=&Confirmaci¢n pedido;
                                 FRC=&Confirmation de commande;
                                 ENC=&Order Confirmation];
                      Image=Email }
      { 33      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Email Confirmation;
                                 ESM=Enviar confirmaci¢n por correo elect.;
                                 FRC=Envoyer confirmation par courriel;
                                 ENC=Email Confirmation];
                      Image=Email;
                      OnAction=BEGIN
                                 DocPrint.EmailSalesHeader(Rec);
                               END;
                                }
      { 224     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Confirmation;
                                 ESM=Imprimir confirmaci¢n;
                                 FRC=Imprimer confirmation;
                                 ENC=Print Confirmation];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Order Confirmation");
                               END;
                                }
      { 14001001;1   ;Action    ;
                      Name=HM History;
                      CaptionML=[ENU=History;
                                 ESM=Historia;
                                 FRC=Histoire;
                                 ENC=History];
                      Promoted=Yes;
                      Image=History;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 HistoryFunction(-42,'');
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1905599606;1 ;Action    ;
                      CaptionML=[ENU=Drop Shipment Status;
                                 ESM=Estado env¡o directo;
                                 FRC=tat de livraison directe;
                                 ENC=Drop Shipment Status];
                      RunObject=Report 10051;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1901629406;1 ;Action    ;
                      CaptionML=[ENU=Picking List by Order;
                                 ESM=List. picking por ped.;
                                 FRC=Bon de cueillette par commande;
                                 ENC=Picking List by Order];
                      RunObject=Report 10153;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=G‚n‚ral;
                           ENC=General] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             //20107823jw BEGIN
                             IF Cust.GET("Sell-to Customer No.") THEN
                               ShipAhead := Cust."Ship Ahead";
                             //20170823jw END
                             ShowCustComments; // DW0518

                             SelltoCustomerNoOnAfterValidat;
                           END;

                ShowMandatory=TRUE }

    { 157 ;2   ;Field     ;
                SourceExpr="Sell-to Contact No.";
                Importance=Additional;
                OnValidate=BEGIN
                             IF GETFILTER("Sell-to Contact No.") = xRec."Sell-to Contact No." THEN
                               IF "Sell-to Contact No." <> xRec."Sell-to Contact No." THEN
                                 SETRANGE("Sell-to Contact No.");
                           END;
                            }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name";
                QuickEntry=FALSE }

    { 81  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Importance=Additional }

    { 83  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Importance=Additional }

    { 86  ;2   ;Field     ;
                SourceExpr="Sell-to City";
                QuickEntry=FALSE }

    { 1020005;2;Field     ;
                CaptionML=[ENU=Sell-to State / ZIP Code;
                           ESM=Venta a-Estado / C.P.;
                           FRC=tat-Province/code postal (d‚biteur);
                           ENC=Sell-to Province/State / Postal/ZIP Code];
                SourceExpr="Sell-to County";
                ShowCaption=Yes }

    { 72  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Importance=Standard }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Importance=Additional }

    { 1000000002;2;Field  ;
                SourceExpr="Assigned User ID" }

    { 1000000003;2;Field  ;
                SourceExpr="No. Printed" }

    { 1000000004;2;Field  ;
                SourceExpr="Posting Description" }

    { 1000000005;2;Field  ;
                SourceExpr="Your Reference" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                QuickEntry=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Order Date";
                Importance=Promoted;
                QuickEntry=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Shipment Date" }

    { 135 ;2   ;Field     ;
                SourceExpr="Requested Delivery Date" }

    { 1000000087;2;Field  ;
                Name=Ship Ahead;
                SourceExpr=ShipAhead;
                Editable=false }

    { 1000000077;2;Field  ;
                Name=Est. Direct Ship Deliv. Date;
                CaptionML=ENU=Est. Direct Ship Deliv.Date;
                SourceExpr=SlsHdrExt."Est. DIRSHIP Delivery Date";
                OnValidate=BEGIN
                             SetSlsHdrExt(SlsHdrExt); // DW 12/11
                           END;
                            }

    { 1000000007;2;Field  ;
                SourceExpr="Do not Ship Before" }

    { 1100000008;2;Field  ;
                Name=Web Order No.;
                SourceExpr="Web Order No.";
                OnValidate=BEGIN
                             SlsHdrExt."Web Order No." := "Web Order No.";
                           END;
                            }

    { 155 ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted;
                ShowMandatory=ExternalDocNoMandatory }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="Lines Shipped Not Invoiced" }

    { 1000000010;2;Field  ;
                SourceExpr="Reason Code" }

    { 1000000011;2;Field  ;
                SourceExpr="Fulfillment Planning Status" }

    { 1000000012;2;Field  ;
                SourceExpr="Message Texts" }

    { 129 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted;
                QuickEntry=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Document Date";
                QuickEntry=FALSE }

    { 137 ;2   ;Field     ;
                SourceExpr="Promised Delivery Date";
                Importance=Additional }

    { 243 ;2   ;Field     ;
                SourceExpr="Quote No.";
                Importance=Additional }

    { 1148;2   ;Field     ;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 245 ;2   ;Field     ;
                SourceExpr="Opportunity No.";
                Importance=Additional }

    { 124 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 9   ;2   ;Field     ;
                SourceExpr="Job Queue Status";
                Importance=Additional }

    { 198 ;2   ;Field     ;
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 1000000091;2;Field  ;
                SourceExpr="3PL Warehouse";
                Editable=FALSE }

    { 1000000001;2;Field  ;
                SourceExpr="Moulton Order No." }

    { 58  ;1   ;Part      ;
                Name=SalesLines;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page46;
                Editable=DynamicEditable;
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           ESM=Facturaci¢n;
                           FRC=Facturation;
                           ENC=Invoicing] }

    { 16  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BilltoCustomerNoOnAfterValidat;
                           END;
                            }

    { 159 ;2   ;Field     ;
                SourceExpr="Bill-to Contact No.";
                Importance=Additional }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Name" }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Importance=Additional }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to City" }

    { 1020008;2;Field     ;
                CaptionML=[ENU=State / ZIP Code;
                           ESM=Estado / C.P.;
                           FRC=tat-Province/code postal;
                           ENC=Province/State / Postal/ZIP Code];
                SourceExpr="Bill-to County" }

    { 89  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Importance=Additional }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Importance=Additional }

    { 1000000015;2;Field  ;
                SourceExpr="Outstanding Amount ($)" }

    { 226 ;2   ;Field     ;
                SourceExpr="Credit Card No.";
                Visible=FALSE }

    { 253 ;2   ;Field     ;
                CaptionML=[ENU=Cr. Card Number (Last 4 Digits);
                           ESM=N£mero tarjeta cr‚dito (cuatro £ltimos d¡gitos);
                           FRC=Num‚ro de carte de cr‚dit (4ÿderniers chiffres);
                           ENC=Cr. Card Number (Last 4 Digits)];
                SourceExpr=GetCreditcardNumber;
                Visible=FALSE }

    { 1000000016;2;Field  ;
                SourceExpr="Pricing Discrepancy" }

    { 1000000017;2;Field  ;
                SourceExpr="On Hold" }

    { 1000000018;2;Field  ;
                Name=Reason Code.;
                SourceExpr="Reason Code" }

    { 84  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 92  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 1000000019;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 28  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 1000000020;2;Field  ;
                Name=Authorization Code;
                SourceExpr=SlsHdrExt."Authorization Code";
                OnValidate=BEGIN
                             SetSlsHdrExt(SlsHdrExt); // DW 12/11
                           END;
                            }

    { 30  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 1000000083;2;Field  ;
                SourceExpr="Invoice Disc. Code";
                Importance=Additional }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 34  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date" }

    { 105 ;2   ;Field     ;
                SourceExpr="Payment Method Code" }

    { 1020002;2;Field     ;
                SourceExpr="Tax Liable";
                Importance=Promoted }

    { 1020000;2;Field     ;
                SourceExpr="Tax Area Code";
                Importance=Promoted }

    { 1000000021;2;Field  ;
                SourceExpr="Posting No." }

    { 1000000022;2;Field  ;
                Name=Campaign No;
                SourceExpr="Campaign No." }

    { 27  ;2   ;Field     ;
                SourceExpr="Direct Debit Mandate ID" }

    { 37028450;2;Field    ;
                SourceExpr="Electronic Invoice Type" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           ESM=Env¡o;
                           FRC=Livraison;
                           ENC=Shipping] }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Importance=Promoted }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 1000000025;2;Field  ;
                SourceExpr="Ship-to Name 2" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Importance=Additional }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Importance=Additional }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1020011;2;Field     ;
                CaptionML=[ENU=Ship-to State / ZIP Code;
                           ESM=Env¡o a-Estado / C.P.;
                           FRC=tat-Province/code postal de livraison;
                           ENC=Ship-to Province/State / Postal/ZIP Code];
                SourceExpr="Ship-to County" }

    { 97  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Promoted;
                OnLookup=VAR
                           PostCode@1000000000 : Record 225;
                         BEGIN
                           // DW
                           IF PAGE.RUNMODAL(PAGE::"Post Codes",PostCode) = ACTION::LookupOK THEN BEGIN
                             "Ship-to Post Code" := PostCode.Code;
                             "Ship-to County" := PostCode.County;
                             "Ship-to Country/Region Code" := PostCode."Country/Region Code";
                           END;
                         END;
                          }

    { 1000000070;2;Field  ;
                SourceExpr="Ship-to Country/Region Code";
                Importance=Additional }

    { 1480003;2;Field     ;
                SourceExpr="Ship-to UPS Zone" }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 1000000026;2;Field  ;
                SourceExpr="Ship-to Phone" }

    { 1000000027;2;Field  ;
                SourceExpr="Ship-to E-mail" }

    { 1000000028;2;Field  ;
                SourceExpr="Order Value" }

    { 1000000029;2;Field  ;
                CaptionML=ENU=Load ID;
                SourceExpr=SlsHdrExt."Load ID";
                Importance=Additional;
                Editable=FALSE }

    { 1000000034;2;Field  ;
                SourceExpr="Package Tracking No." }

    { 94  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 1000000079;2;Field  ;
                SourceExpr="Pick Status";
                Importance=Promoted }

    { 141 ;2   ;Field     ;
                SourceExpr="Outbound Whse. Handling Time";
                Importance=Additional }

    { 48  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 1000000030;2;Field  ;
                SourceExpr="Deliver-to Shipping Agent" }

    { 107 ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Importance=Additional }

    { 1000000031;2;Field  ;
                SourceExpr="E-Ship Agent Service";
                OnValidate=BEGIN
                             //20170619jw begin
                             IF SlsHdr."E-Ship Agent Service" = '' THEN
                               MESSAGE('You must enter an E-Ship Agent Service code to continue');
                             //20170619jw end
                           END;
                            }

    { 139 ;2   ;Field     ;
                SourceExpr="Shipping Agent Service Code";
                Importance=Additional }

    { 1000000033;2;Field  ;
                SourceExpr="Days to Ship" }

    { 50  ;2   ;Field     ;
                Name=Shpmnt Date;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 119 ;2   ;Field     ;
                SourceExpr="Shipping Advice";
                Importance=Promoted;
                OnValidate=BEGIN
                             IF "Shipping Advice" <> xRec."Shipping Advice" THEN
                               IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Shipping Advice")) THEN
                                 ERROR(Text002);
                           END;
                            }

    { 1000000089;2;Field  ;
                SourceExpr="Allocation Level" }

    { 143 ;2   ;Field     ;
                SourceExpr="Shipping Time" }

    { 145 ;2   ;Field     ;
                SourceExpr="Late Order Shipping";
                Importance=Additional }

    { 1000000035;2;Field  ;
                SourceExpr="Qty. To Ship";
                Importance=Additional }

    { 1000000036;2;Field  ;
                SourceExpr="Outstanding Quantity";
                Importance=Additional }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           ESM=Comercio exterior;
                           FRC=Commerce ‚tranger;
                           ENC=Foreign Trade] }

    { 111 ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1000000037;2;Field  ;
                SourceExpr="Currency Factor" }

    { 52  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 54  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 103 ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 56  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 99  ;2   ;Field     ;
                SourceExpr="Exit Point" }

    { 101 ;2   ;Field     ;
                SourceExpr=Area }

    { 1000000038;2;Field  ;
                Name=Days to Ship.;
                SourceExpr="Days to Ship" }

    { 1900201301;1;Group  ;
                CaptionML=[ENU=Prepayment;
                           ESM=Anticipo;
                           FRC=Paiement anticip‚;
                           ENC=Prepayment] }

    { 228 ;2   ;Field     ;
                SourceExpr="Prepayment %";
                Importance=Promoted;
                OnValidate=BEGIN
                             Prepayment37OnAfterValidate;
                           END;
                            }

    { 229 ;2   ;Field     ;
                SourceExpr="Compress Prepayment" }

    { 162 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Terms Code" }

    { 239 ;2   ;Field     ;
                SourceExpr="Prepayment Due Date";
                Importance=Promoted }

    { 164 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Discount %" }

    { 70  ;2   ;Field     ;
                SourceExpr="Prepmt. Pmt. Discount Date" }

    { 1020014;2;Field     ;
                SourceExpr="Prepmt. Include Tax" }

    { 1907762101;1;Group  ;
                CaptionML=ENU=E-Ship }

    { 14000707;2;Field    ;
                Name=<Shipping Agent Code2>;
                SourceExpr="Shipping Agent Code";
                Importance=Promoted }

    { 14000709;2;Field    ;
                Name=EShip Agent Service;
                SourceExpr="E-Ship Agent Service";
                Importance=Promoted }

    { 1000000050;2;Field  ;
                SourceExpr="Ship-Ahead Allowed" }

    { 14000711;2;Field    ;
                SourceExpr="Residential Delivery" }

    { 1000000039;2;Field  ;
                SourceExpr=Liftgate }

    { 1000000040;2;Field  ;
                SourceExpr="Limited Access" }

    { 1000000041;2;Field  ;
                SourceExpr="Inside Delivery" }

    { 1000000042;2;Field  ;
                SourceExpr="Call Ahead" }

    { 1000000043;2;Field  ;
                SourceExpr="Signature Required" }

    { 14000719;2;Field    ;
                SourceExpr="Blind Shipment" }

    { 14000721;2;Field    ;
                SourceExpr="Double Blind Shipment" }

    { 14000723;2;Field    ;
                SourceExpr="Double Blind Ship-from Cust No" }

    { 14000705;2;Field    ;
                SourceExpr="Ship-for Code" }

    { 1000000044;2;Field  ;
                Name=Shipto Code;
                SourceExpr="Ship-to Code" }

    { 1000000045;2;Field  ;
                SourceExpr="Order Time" }

    { 14000740;2;Field    ;
                SourceExpr="Shipping Payment Type";
                Importance=Promoted }

    { 14000746;2;Field    ;
                SourceExpr="Third Party Ship. Account No.";
                Importance=Promoted }

    { 14000748;2;Field    ;
                SourceExpr="Shipping Insurance" }

    { 14000713;2;Field    ;
                SourceExpr="Free Freight" }

    { 1000000046;2;Field  ;
                SourceExpr="No Free Freight Lines on Order" }

    { 14000742;2;Field    ;
                SourceExpr="E-Mail Confirmation Handled" }

    { 14000804;2;Field    ;
                SourceExpr="Invoice for Bill of Lading No." }

    { 14000802;2;Field    ;
                SourceExpr="Invoice for Shipment No." }

    { 14000800;2;Field    ;
                SourceExpr="Shipment Invoice Override" }

    { 1000000080;2;Field  ;
                SourceExpr="Packing Rule Code" }

    { 14000701;2;Field    ;
                CaptionML=ENU=Packing Status;
                SourceExpr=PackingStatus;
                Importance=Promoted;
                Editable=FALSE }

    { 1000000047;2;Field  ;
                SourceExpr="Total Qty. Packed (base)" }

    { 1905396001;1;Group  ;
                CaptionML=ENU=EDI }

    { 14000351;2;Field    ;
                SourceExpr="EDI Order" }

    { 14000353;2;Field    ;
                SourceExpr="EDI Internal Doc. No.";
                Importance=Promoted }

    { 14000355;2;Field    ;
                SourceExpr="EDI Ack. Generated" }

    { 14000357;2;Field    ;
                SourceExpr="EDI Ack. Gen. Date" }

    { 1000000048;2;Field  ;
                SourceExpr="Order Status Required" }

    { 1000000056;2;Field  ;
                SourceExpr="Date Received";
                Editable=FALSE }

    { 1000000057;2;Field  ;
                SourceExpr="Time Received";
                Editable=FALSE }

    { 14000359;2;Field    ;
                SourceExpr="EDI Released" }

    { 14000361;2;Field    ;
                SourceExpr="EDI WHSE Shp. Gen" }

    { 14000363;2;Field    ;
                SourceExpr="EDI WHSE Shp. Gen Date" }

    { 14001378;2;Field    ;
                SourceExpr="EDI Cancellation Request" }

    { 14000392;2;Field    ;
                SourceExpr="EDI Cancellation Date" }

    { 14000365;2;Field    ;
                SourceExpr="EDI Expected Delivery Date" }

    { 14000375;2;Field    ;
                SourceExpr="EDI Cancel After Date" }

    { 14000350;2;Field    ;
                SourceExpr="EDI Trade Partner";
                Importance=Promoted }

    { 14000368;2;Field    ;
                SourceExpr="EDI Sell-to Code";
                Importance=Promoted }

    { 14000373;2;Field    ;
                SourceExpr="EDI Ship-for Code";
                Importance=Promoted }

    { 14000371;2;Field    ;
                SourceExpr="EDI Ship-to Code";
                Importance=Promoted }

    { 1000000049;2;Field  ;
                Name=EDI Ship-from Code;
                SourceExpr=SlsHdrExt."EDI Ship From Code" }

    { 1000000051;2;Field  ;
                Name=Promised Delivery Date.;
                SourceExpr="Promised Delivery Date" }

    { 1000000052;2;Field  ;
                Name=Shipping Time.;
                SourceExpr="Shipping Time" }

    { 14000401;2;Field    ;
                SourceExpr="EDI Transaction Date" }

    { 14000403;2;Field    ;
                SourceExpr="EDI Transaction Time" }

    { 14000394;2;Field    ;
                SourceExpr="EDI Cancellation Advice" }

    { 14000396;2;Field    ;
                SourceExpr="EDI Cancellation Advice Date" }

    { 14000398;2;Field    ;
                SourceExpr="EDI Cancellation Generated" }

    { 1905601501;1;Group  ;
                CaptionML=ENU=Procurement }

    { 14000551;2;Field    ;
                SourceExpr="Exclude from Usage" }

    { 1000000053;2;Field  ;
                SourceExpr="Shipping No." }

    { 37028410;1;Part     ;
                Name=EFT Subform;
                CaptionML=ENU=EFT;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page37028670;
                PartType=Page;
                ShowFilter=No }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 9041211;1;Part      ;
                Name=WebClient;
                CaptionML=[DAN=Dokumenter;
                           DEU=Dokumenten;
                           ENU=Documents;
                           ESP=Documentos;
                           FIN=Asiakirjojen;
                           FRA=Documents;
                           ITA=Documenti;
                           NLD=Dokumenten;
                           NOR=Dokumenter;
                           SVE=Dokument;
                           ESM=Documentos;
                           PTG=Documentos;
                           FRC=Documents];
                PagePartID=Page9041211;
                Visible=ZDWebAddinVisible;
                PartType=Page }

    { 9041210;1;Part      ;
                Name=Zetadocs;
                CaptionML=[DAN=Dokumenter;
                           DEU=Dokumenten;
                           ENU=Documents;
                           ESP=Documentos;
                           FIN=Asiakirjojen;
                           FRA=Documents;
                           ITA=Documenti;
                           NLD=Dokumenten;
                           NOR=Dokumenter;
                           SVE=Dokument;
                           ESM=Documentos;
                           PTG=Documentos;
                           FRC=Documents];
                PagePartID=Page9041209;
                Visible=ZDWinAddinVisible;
                PartType=Page }

    { 35  ;1   ;Part      ;
                SubPageLink=Table ID=CONST(36),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1903720907;1;Part   ;
                SubPageLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=FALSE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubPageLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                Visible=FALSE;
                PartType=Page }

    { 378028381;1;Part    ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page37028580;
                Visible=FALSE;
                PartType=Page }

    { 1000000073;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page50010;
                ProviderID=58;
                PartType=Page }

    { 1000000000;1;Part   ;
                SubPageView=SORTING(Document Type,No.);
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page50056;
                PartType=Page }

    { 1906127307;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=58;
                Visible=TRUE;
                PartType=Page }

    { 1901314507;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9089;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubPageLink=Table ID=CONST(36),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 49  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1907012907;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1901796907;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9109;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 80  ;1   ;Part      ;
                Name=WorkflowStatus;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ZDAddin@1000001004 : Codeunit 9041215;
      ZDSaveAndSendVisible@1000001003 : Boolean;
      ZDWebAddinVisible@1000001002 : Boolean;
      ZDWinAddinVisible@1000001001 : Boolean;
      ZdPrevRecID@1000001005 : RecordID;
      ZdRecRef@9041221 : RecordRef;
      CopySalesDoc@1001 : Report 292;
      MoveNegSalesLines@1007 : Report 6699;
      ApprovalsMgmt@1012 : Codeunit 1535;
      ReportPrint@1002 : Codeunit 228;
      DocPrint@1003 : Codeunit 229;
      ArchiveManagement@1008 : Codeunit 5063;
      SalesCalcDiscountByType@1014 : Codeunit 56;
      ChangeExchangeRate@1005 : Page 511;
      UserMgt@1006 : Codeunit 5700;
      Usage@1010 : 'Order Confirmation,Work Order,Pick Instruction';
      JobQueueVisible@1004 : Boolean INDATASET;
      Text001@1015 : TextConst 'ENU=Do you want to change %1 in all related records in the warehouse?;ESM=¨Desea cambiar %1 en todos los registros relacionados del almac‚n?;FRC=Souhaitez-vous modifier %1 dans tous les enregistrements associ‚s de l''entrep“tÿ?;ENC=Do you want to change %1 in all related records in the warehouse?';
      Text002@1011 : TextConst 'ENU=The update has been interrupted to respect the warning.;ESM=Se ha interrumpido la actualizaci¢n para respetar la advertencia.;FRC=La mise … jour a ‚t‚ interrompue pour respecter l''avertissement.;ENC=The update has been interrupted to respect the warning.';
      DynamicEditable@1009 : Boolean;
      HasIncomingDocument@1020 : Boolean;
      DocNoVisible@1013 : Boolean;
      ExternalDocNoMandatory@1016 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1024 : Boolean;
      OpenApprovalEntriesExist@1023 : Boolean;
      CRMIntegrationEnabled@1000 : Boolean;
      CRMIsCoupledToRecord@1017 : Boolean;
      ShowWorkflowStatus@1018 : Boolean;
      EDIIntegration@14000351 : Codeunit 14000363;
      SalesLine@14000701 : Record 37;
      BillOfLading@14000702 : Record 14000822;
      Shipping@14000703 : Codeunit 14000701;
      Text14000701@14000704 : TextConst 'ENU=Sales Order %1 added to Bill of Lading %2.';
      Text14000702@14000705 : TextConst 'ENU=Information is OK';
      SlsHdrExt@1000000000 : Record 50004;
      "// DWVAR"@1000000002 : Integer;
      MessageText@1000000001 : Record 50040;
      CRIFunctions@1000000003 : Codeunit 50025;
      SlsHdr@1000000008 : Record 36;
      ShippingSetup@1000000009 : Record 14000707;
      Cust@1000000010 : Record 18;
      PackingRule@1000000011 : Record 14000715;
      Package@1000000012 : Record 14000701;
      ShipAhead@1000000013 : Boolean;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    BEGIN
      SendToPosting(PostingCodeunitID);
      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@3();
    BEGIN
      CurrPage.SalesLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SelltoCustomerNoOnAfterValidat@19034782();
    BEGIN
      IF GETFILTER("Sell-to Customer No.") = xRec."Sell-to Customer No." THEN
        IF "Sell-to Customer No." <> xRec."Sell-to Customer No." THEN
          SETRANGE("Sell-to Customer No.");
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE BilltoCustomerNoOnAfterValidat@19044114();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE Prepayment37OnAfterValidate@19040510();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.SalesDocumentNoIsVisible(DocType::Order,"No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@5();
    VAR
      SalesReceivablesSetup@1000 : Record 311;
    BEGIN
      SalesReceivablesSetup.GET;
      ExternalDocNoMandatory := SalesReceivablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE ShowPreview@6();
    VAR
      SalesPostYesNo@1000 : Codeunit 81;
    BEGIN
      SalesPostYesNo.Preview(Rec);
    END;

    LOCAL PROCEDURE SetControlVisibility@7();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      JobQueueVisible := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
    END;

    LOCAL PROCEDURE "//DWFUN"@1000000000();
    BEGIN
    END;

    PROCEDURE RunFullfillment@1000000002();
    VAR
      Fulfillment@1000000000 : Codeunit 50046;
      Header@1000000001 : Record 36;
    BEGIN
      SETRANGE("No.","No.");
      Fulfillment.RunFulfillment(Rec);
      GET("Document Type","No.");
    END;

    PROCEDURE QuoteFreight@1000000003(VAR Header@1000000001 : Record 36);
    VAR
      CRIFun@1000000000 : Codeunit 50025;
    BEGIN
      CRIFun.GetFreightQuote(Header);
    END;

    LOCAL PROCEDURE ShowCustComments@1000000001();
    VAR
      CommentLine@1000000000 : Record 97;
    BEGIN
      // DW0518
      CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Customer);
      CommentLine.SETRANGE("No.","Sell-to Customer No.");
      CommentLine.SETRANGE("Customer Rules",TRUE);
      IF CommentLine.FINDFIRST THEN
        PAGE.RUNMODAL(PAGE::"Customer Comments",CommentLine);
    END;

    BEGIN
    {
      CRI1.21 Added Duplicate External Check Code tjb 122808
      Added Gen business posting group to invoicing tab and ctrl f10 to reopen an order.

      // DW 12/11 Add Sales Header Extension table
      //<< DES1.00
        Added E-Shop Fields under e-commerce Tab
      //>> DES1.00
      // 2016 Add Fulfillment, other functions
      //20170518jw Add Get Freight Quote function
      //20107823jw Add Ship Ahead from Customer Card to Sales Header general tab
      DWSBC 06/14/2018 - Added new Field 3PL Warehouse
      DW SBC 2018-07-20 MN Added Field Moulton Order No.
    }
    END.
  }
}

OBJECT Page 50270 Web Service SO History
{
  OBJECT-PROPERTIES
  {
    Date=07/12/18;
    Time=10:49:51 PM;
    Modified=Yes;
    Version List=SBC;
  }
  PROPERTIES
  {
    CaptionML=ENU=SO Web Service History;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50097;
    SourceTableView=WHERE(WS Status=FILTER(TRUE));
    PageType=List;
    ActionList=ACTIONS
    {
      { 1170000030;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1170000029;1 ;ActionGroup;
                      CaptionML=ENU=Web Req/Res }
      { 1170000028;2 ;Action    ;
                      CaptionML=[DEU=XML Anfrage;
                                 ENU=XML Request;
                                 NLD=XML verzoek];
                      ToolTipML=ENU=View the content of the XML file which is sent to the website. This request has been processed by the WEBAPI of Magento.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=XMLFile;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ViewRequest();
                               END;
                                }
      { 1170000027;2 ;Action    ;
                      CaptionML=[DEU=XML Antwort;
                                 ENU=XML Response;
                                 NLD=XML antwoord];
                      ToolTipML=ENU=View the response of the request file from Magento. You can check if the request has been processed ok or check the error information in the response in case of 'Rejected' status.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=XMLFile;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ViewResponse();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1170000000;0;Container;
                ContainerType=ContentArea }

    { 1170000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1170000002;2;Field  ;
                SourceExpr="Entry No." }

    { 1170000003;2;Field  ;
                SourceExpr="User ID" }

    { 1170000031;2;Field  ;
                Name=SOAP Request DateTime;
                CaptionML=ENU=SOAP Request DateTime;
                SourceExpr="SOAP Request DateTime" }

    { 1170000005;2;Field  ;
                SourceExpr="WS Status" }

    { 1170000006;2;Field  ;
                SourceExpr="WS Message" }

    { 1170000004;2;Field  ;
                SourceExpr="Order No." }

    { 1170000025;2;Field  ;
                SourceExpr="Order Status" }

    { 1170000007;2;Field  ;
                SourceExpr="Order Date" }

    { 1170000008;2;Field  ;
                SourceExpr="Process Date" }

    { 1170000009;2;Field  ;
                SourceExpr=ShipDate }

    { 1170000024;2;Field  ;
                SourceExpr="Cancellation Date" }

    { 1170000010;2;Field  ;
                SourceExpr=CarrierCode }

    { 1170000011;2;Field  ;
                SourceExpr=ServiceCode }

    { 1170000012;2;Field  ;
                SourceExpr=TrackingNo }

    { 1170000013;2;Field  ;
                SourceExpr=Balance }

    { 1170000014;2;Field  ;
                SourceExpr=PayType }

    { 1170000015;2;Field  ;
                SourceExpr=OrderType }

    { 1170000016;2;Field  ;
                SourceExpr=ShipBatch }

    { 1170000017;2;Field  ;
                SourceExpr=NextPaymentDate }

    { 1170000018;2;Field  ;
                SourceExpr=NextPaymentAmount }

    { 1170000019;2;Field  ;
                SourceExpr=DeclineCounterValue }

    { 1170000020;2;Field  ;
                SourceExpr=BalanceDue }

    { 1170000021;2;Field  ;
                SourceExpr=LastDeclineCode }

    { 1170000022;2;Field  ;
                SourceExpr=LastPaymentDate }

    { 1170000023;2;Field  ;
                SourceExpr=LastPaymentNumber }

    { 1170000026;2;Field  ;
                SourceExpr="DB Code" }

  }
  CODE
  {

    BEGIN
    {
      WS SBC 2018-07-12 MN Created Page for Sales Order Web Service Hisory
    }
    END.
  }
}

OBJECT Page 50271 Web Service Error History
{
  OBJECT-PROPERTIES
  {
    Date=07/12/18;
    Time=10:49:40 PM;
    Modified=Yes;
    Version List=SBC;
  }
  PROPERTIES
  {
    CaptionML=ENU=Web Service Error History;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50097;
    SourceTableView=WHERE(WS Status=FILTER(FALSE));
    PageType=List;
    ActionList=ACTIONS
    {
      { 1170000031;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1170000030;1 ;ActionGroup;
                      CaptionML=ENU=Web Req/Res }
      { 1170000029;2 ;Action    ;
                      CaptionML=[DEU=XML Anfrage;
                                 ENU=XML Request;
                                 NLD=XML verzoek];
                      ToolTipML=ENU=View the content of the XML file which is sent to the website. This request has been processed by the WEBAPI of Magento.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=XMLFile;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ViewRequest();
                               END;
                                }
      { 1170000028;2 ;Action    ;
                      CaptionML=[DEU=XML Antwort;
                                 ENU=XML Response;
                                 NLD=XML antwoord];
                      ToolTipML=ENU=View the response of the request file from Magento. You can check if the request has been processed ok or check the error information in the response in case of 'Rejected' status.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=XMLFile;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ViewResponse();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1170000000;0;Container;
                ContainerType=ContentArea }

    { 1170000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1170000002;2;Field  ;
                SourceExpr="Entry No." }

    { 1170000003;2;Field  ;
                SourceExpr="User ID" }

    { 1170000027;2;Field  ;
                Name=SOAP Request DateTime;
                CaptionML=ENU=SOAP Request DateTime;
                SourceExpr="SOAP Request DateTime" }

    { 1170000004;2;Field  ;
                SourceExpr="Order No." }

    { 1170000005;2;Field  ;
                SourceExpr="WS Status" }

    { 1170000006;2;Field  ;
                SourceExpr="WS Message" }

    { 1170000007;2;Field  ;
                SourceExpr="Order Date" }

    { 1170000008;2;Field  ;
                SourceExpr="Process Date" }

    { 1170000009;2;Field  ;
                SourceExpr=ShipDate }

    { 1170000010;2;Field  ;
                SourceExpr=CarrierCode }

    { 1170000011;2;Field  ;
                SourceExpr=ServiceCode }

    { 1170000012;2;Field  ;
                SourceExpr=TrackingNo }

    { 1170000013;2;Field  ;
                SourceExpr=Balance }

    { 1170000014;2;Field  ;
                SourceExpr=PayType }

    { 1170000015;2;Field  ;
                SourceExpr=OrderType }

    { 1170000016;2;Field  ;
                SourceExpr=ShipBatch }

    { 1170000017;2;Field  ;
                SourceExpr=NextPaymentDate }

    { 1170000018;2;Field  ;
                SourceExpr=NextPaymentAmount }

    { 1170000019;2;Field  ;
                SourceExpr=DeclineCounterValue }

    { 1170000020;2;Field  ;
                SourceExpr=BalanceDue }

    { 1170000021;2;Field  ;
                SourceExpr=LastDeclineCode }

    { 1170000022;2;Field  ;
                SourceExpr=LastPaymentDate }

    { 1170000023;2;Field  ;
                SourceExpr=LastPaymentNumber }

    { 1170000026;2;Field  ;
                SourceExpr="DB Code" }

  }
  CODE
  {

    BEGIN
    {
      WS SBC 2018-07-12 MN Created page for Sales Order Web Service Hisory
    }
    END.
  }
}

